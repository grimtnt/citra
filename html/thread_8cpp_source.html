<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Citra: src/core/hle/kernel/thread.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="doc-icon.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Citra
   </div>
   <div id="projectbrief">Nintendo 3DS emulator</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('thread_8cpp_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">thread.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="thread_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// Copyright 2014 Citra Emulator Project / PPSSPP Project</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">// Licensed under GPLv2 or any later version</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// Refer to the license.txt file included.</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &lt;algorithm&gt;</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &lt;list&gt;</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &lt;vector&gt;</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="assert_8h.html">common/assert.h</a>&quot;</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="common__types_8h.html">common/common_types.h</a>&quot;</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="log_8h.html">common/logging/log.h</a>&quot;</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="math__util_8h.html">common/math_util.h</a>&quot;</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="thread__queue__list_8h.html">common/thread_queue_list.h</a>&quot;</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="core_8h.html">core/core.h</a>&quot;</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="core__timing_8h.html">core/core_timing.h</a>&quot;</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="cpu_8h.html">core/cpu/cpu.h</a>&quot;</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="hle_2kernel_2errors_8h.html">core/hle/kernel/errors.h</a>&quot;</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="handle__table_8h.html">core/hle/kernel/handle_table.h</a>&quot;</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="kernel_8h.html">core/hle/kernel/kernel.h</a>&quot;</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="hle_2kernel_2memory_8h.html">core/hle/kernel/memory.h</a>&quot;</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="mutex_8h.html">core/hle/kernel/mutex.h</a>&quot;</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="process_8h.html">core/hle/kernel/process.h</a>&quot;</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="thread_8h.html">core/hle/kernel/thread.h</a>&quot;</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="result_8h.html">core/hle/result.h</a>&quot;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="memory_8h.html">core/memory.h</a>&quot;</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="settings_8h.html">core/settings.h</a>&quot;</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespace_kernel.html">Kernel</a> {</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div><div class="line"><a name="l00030"></a><span class="lineno"><a class="line" href="namespace_kernel.html#ada81dec7407585e67527a2748902b829">   30</a></span>&#160;<span class="keyword">static</span> <a class="code" href="namespace_core_timing.html#struct_core_timing_1_1_event_type">CoreTiming::EventType</a>* <a class="code" href="namespace_kernel.html#ada81dec7407585e67527a2748902b829">ThreadWakeupEventType</a>{};</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div><div class="line"><a name="l00032"></a><span class="lineno"><a class="line" href="class_kernel_1_1_thread.html#ae460590ab237cf75e3927450f89be5e7">   32</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class_kernel_1_1_thread.html#ae460590ab237cf75e3927450f89be5e7">Thread::ShouldWait</a>(<a class="code" href="class_kernel_1_1_thread.html">Thread</a>* thread)<span class="keyword"> const </span>{</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="class_kernel_1_1_thread.html#aa36c37078e343a0681974bf0077fd3ab">status</a> != <a class="code" href="thread_8h.html#ae2739961013a00cede621d4d72f2173ca45bf95b1b887bdba9b3e24b98cc814ee">THREADSTATUS_DEAD</a>;</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;}</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div><div class="line"><a name="l00036"></a><span class="lineno"><a class="line" href="class_kernel_1_1_thread.html#a898ba548b1c136e5cd15f8e1060f59ca">   36</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_kernel_1_1_thread.html#a898ba548b1c136e5cd15f8e1060f59ca">Thread::Acquire</a>(<a class="code" href="class_kernel_1_1_thread.html">Thread</a>* thread) {</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <a class="code" href="assert_8h.html#a4b432fb3d47e2ca732caf965691a54d7">ASSERT_MSG</a>(!<a class="code" href="class_kernel_1_1_thread.html#ae460590ab237cf75e3927450f89be5e7">ShouldWait</a>(thread), <span class="stringliteral">&quot;object unavailable!&quot;</span>);</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;}</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">// TODO(yuriks): This can be removed if Thread objects are explicitly pooled in the future,</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">// allowing us to simply use a pool index or similar.</span></div><div class="line"><a name="l00042"></a><span class="lineno"><a class="line" href="namespace_kernel.html#a7acc8be3d256fc8599288360bd57342a">   42</a></span>&#160;<span class="keyword">static</span> <a class="code" href="class_kernel_1_1_handle_table.html">Kernel::HandleTable</a> <a class="code" href="namespace_kernel.html#a7acc8be3d256fc8599288360bd57342a">wakeup_callback_handle_table</a>;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">// Lists all thread ids that aren&#39;t deleted/etc.</span></div><div class="line"><a name="l00045"></a><span class="lineno"><a class="line" href="namespace_kernel.html#ad00267a61de98b3d9ea70e2edc015443">   45</a></span>&#160;<span class="keyword">static</span> std::vector&lt;SharedPtr&lt;Thread&gt;&gt; <a class="code" href="namespace_kernel.html#ad00267a61de98b3d9ea70e2edc015443">thread_list</a>;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">// Lists only ready thread ids.</span></div><div class="line"><a name="l00048"></a><span class="lineno"><a class="line" href="namespace_kernel.html#a872b8e406b9e61b70516126556653b39">   48</a></span>&#160;<span class="keyword">static</span> <a class="code" href="struct_common_1_1_thread_queue_list.html">Common::ThreadQueueList&lt;Thread*, THREADPRIO_LOWEST + 1&gt;</a> <a class="code" href="namespace_kernel.html#a872b8e406b9e61b70516126556653b39">ready_queue</a>;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div><div class="line"><a name="l00050"></a><span class="lineno"><a class="line" href="namespace_kernel.html#a3cbf9bdd4932714dc3f3f9627bb3338f">   50</a></span>&#160;<span class="keyword">static</span> <a class="code" href="namespace_kernel.html#afc9bde79933dd23864df0768adeb6cfe">SharedPtr&lt;Thread&gt;</a> <a class="code" href="namespace_kernel.html#a3cbf9bdd4932714dc3f3f9627bb3338f">current_thread</a>;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">// The first available thread id at startup</span></div><div class="line"><a name="l00053"></a><span class="lineno"><a class="line" href="namespace_kernel.html#a229a63fa51a0cb8a68e9d265b7afaf32">   53</a></span>&#160;<span class="keyword">static</span> <a class="code" href="common__types_8h.html#a65cf28726f89e62ccf2f1354bc2716df">u32</a> <a class="code" href="namespace_kernel.html#a229a63fa51a0cb8a68e9d265b7afaf32">next_thread_id</a>;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div><div class="line"><a name="l00059"></a><span class="lineno"><a class="line" href="namespace_kernel.html#a9acd1f517f5c78daa3d519fd31b48796">   59</a></span>&#160;<span class="keyword">inline</span> <span class="keyword">static</span> <a class="code" href="common__types_8h.html#a65cf28726f89e62ccf2f1354bc2716df">u32</a> <span class="keyword">const</span> <a class="code" href="namespace_kernel.html#a9acd1f517f5c78daa3d519fd31b48796">NewThreadId</a>() {</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="keywordflow">return</span> next_thread_id++;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;}</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div><div class="line"><a name="l00063"></a><span class="lineno"><a class="line" href="class_kernel_1_1_thread.html#a35c6a5d5f80bc6dff2526aacb35d6b53">   63</a></span>&#160;<a class="code" href="class_kernel_1_1_thread.html#a35c6a5d5f80bc6dff2526aacb35d6b53">Thread::Thread</a>() : <a class="code" href="class_kernel_1_1_thread.html#ad951569c330a60c2f62e465800ebcb47">context</a>(<a class="code" href="namespace_core.html">Core</a>::<a class="code" href="namespace_core.html#a451d67b62d548c4f3ee8363056ad97e7">GetCPU</a>().NewContext()) {}</div><div class="line"><a name="l00064"></a><span class="lineno"><a class="line" href="class_kernel_1_1_thread.html#a7c3764b8467d7a626f024b6f87abf2f0">   64</a></span>&#160;<a class="code" href="class_kernel_1_1_thread.html#a7c3764b8467d7a626f024b6f87abf2f0">Thread::~Thread</a>() {}</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;</div><div class="line"><a name="l00066"></a><span class="lineno"><a class="line" href="namespace_kernel.html#a468effefd7385726635010b18e69a625">   66</a></span>&#160;<a class="code" href="class_kernel_1_1_thread.html">Thread</a>* <a class="code" href="namespace_kernel.html#a468effefd7385726635010b18e69a625">GetCurrentThread</a>() {</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="keywordflow">return</span> current_thread.get();</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;}</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div><div class="line"><a name="l00070"></a><span class="lineno"><a class="line" href="class_kernel_1_1_thread.html#afc1eccdba24dd9c1405d0c79acafb76c">   70</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_kernel_1_1_thread.html#afc1eccdba24dd9c1405d0c79acafb76c">Thread::Stop</a>() {</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="comment">// Cancel any outstanding wakeup events for this thread</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <a class="code" href="namespace_core_timing.html#a1d0fc13b562a6c699cdcbfd4ccdfbc10">CoreTiming::UnscheduleEvent</a>(<a class="code" href="namespace_kernel.html#ada81dec7407585e67527a2748902b829">ThreadWakeupEventType</a>, <a class="code" href="class_kernel_1_1_thread.html#a45860435fb69f8d8d56eb4e4efdee67d">callback_handle</a>);</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    wakeup_callback_handle_table.<a class="code" href="class_kernel_1_1_handle_table.html#a1f8903aec8da59b47d359239430de93d">Close</a>(<a class="code" href="class_kernel_1_1_thread.html#a45860435fb69f8d8d56eb4e4efdee67d">callback_handle</a>);</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <a class="code" href="class_kernel_1_1_thread.html#a45860435fb69f8d8d56eb4e4efdee67d">callback_handle</a> = 0;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="comment">// Clean up thread from ready queue</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="comment">// This is only needed when the thread is termintated forcefully (SVC TerminateProcess)</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="class_kernel_1_1_thread.html#aa36c37078e343a0681974bf0077fd3ab">status</a> == <a class="code" href="thread_8h.html#ae2739961013a00cede621d4d72f2173cadf17bd50b28528532f3db84ba9eae228">THREADSTATUS_READY</a>) {</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        ready_queue.<a class="code" href="struct_common_1_1_thread_queue_list.html#ad85031b2be281c42ef537553a2fd4510">remove</a>(<a class="code" href="class_kernel_1_1_thread.html#af9c2edebfe0ad65f7de1375b9a075c20">current_priority</a>, <span class="keyword">this</span>);</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    }</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <a class="code" href="class_kernel_1_1_thread.html#aa36c37078e343a0681974bf0077fd3ab">status</a> = <a class="code" href="thread_8h.html#ae2739961013a00cede621d4d72f2173ca45bf95b1b887bdba9b3e24b98cc814ee">THREADSTATUS_DEAD</a>;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <a class="code" href="class_kernel_1_1_wait_object.html#ad510a76d2ef9ecfe8c83d4fb6590c5b4">WakeupAllWaitingThreads</a>();</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="comment">// Clean up any dangling references in objects that this thread was waiting for</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; wait_object : <a class="code" href="class_kernel_1_1_thread.html#a1b16fe65c9f07e069bb8bb97c1ad6689">wait_objects</a>) {</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        wait_object-&gt;RemoveWaitingThread(<span class="keyword">this</span>);</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    }</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    wait_objects.clear();</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="comment">// Release all the mutexes that this thread holds</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <a class="code" href="namespace_kernel.html#a846e3fb350cf464f33d53d965525e3b7">ReleaseThreadMutexes</a>(<span class="keyword">this</span>);</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="comment">// Mark the TLS slot in the thread&#39;s page as free.</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <a class="code" href="common__types_8h.html#a65cf28726f89e62ccf2f1354bc2716df">u32</a> tls_page{(<a class="code" href="class_kernel_1_1_thread.html#ad1f94dc234c3f94dcbd1df9d4c21510b">tls_address</a> - <a class="code" href="namespace_memory.html#a0abdbb4b878710f67db886fba7a802ffa1c713c87eb1364d04b3809eb5c997300">Memory::TLS_AREA_VADDR</a>) / <a class="code" href="namespace_memory.html#a41fd7618a06f2e2d24eebe866db68d7d">Memory::PAGE_SIZE</a>};</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <a class="code" href="common__types_8h.html#a65cf28726f89e62ccf2f1354bc2716df">u32</a> tls_slot{((<a class="code" href="class_kernel_1_1_thread.html#ad1f94dc234c3f94dcbd1df9d4c21510b">tls_address</a> - <a class="code" href="namespace_memory.html#a0abdbb4b878710f67db886fba7a802ffa1c713c87eb1364d04b3809eb5c997300">Memory::TLS_AREA_VADDR</a>) % <a class="code" href="namespace_memory.html#a41fd7618a06f2e2d24eebe866db68d7d">Memory::PAGE_SIZE</a>) /</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                 <a class="code" href="namespace_memory.html#a0abdbb4b878710f67db886fba7a802ffa820834c3a77024ad4188433682366051">Memory::TLS_ENTRY_SIZE</a>};</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <a class="code" href="namespace_kernel.html#ac7460d5f540b785aea634c73c5430acd">Kernel::g_current_process</a>-&gt;tls_slots[tls_page].reset(tls_slot);</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;}</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div><div class="line"><a name="l00103"></a><span class="lineno"><a class="line" href="namespace_kernel.html#a8ab884791d23ec8f12c464b21e1983f7">  103</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="namespace_kernel.html#a8ab884791d23ec8f12c464b21e1983f7">PriorityBoostStarvedThreads</a>() {</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <a class="code" href="common__types_8h.html#a66e1d499241ccae9a18a20a1f4f0590d">u64</a> current_ticks{<a class="code" href="namespace_core_timing.html#a3ed2b5dcdf393fa1f42be0b25c1a43ad">CoreTiming::GetTicks</a>()};</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; thread : thread_list) {</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <span class="keyword">const</span> <a class="code" href="common__types_8h.html#a66e1d499241ccae9a18a20a1f4f0590d">u64</a> boost_timeout{2000000}; <span class="comment">// Boost threads that have been ready for &gt; this long</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        <a class="code" href="common__types_8h.html#a66e1d499241ccae9a18a20a1f4f0590d">u64</a> delta{current_ticks - thread-&gt;last_running_ticks};</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <span class="keywordflow">if</span> (thread-&gt;status == <a class="code" href="thread_8h.html#ae2739961013a00cede621d4d72f2173cadf17bd50b28528532f3db84ba9eae228">THREADSTATUS_READY</a> &amp;&amp; delta &gt; boost_timeout) {</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;            <span class="keyword">const</span> <a class="code" href="common__types_8h.html#a65cf28726f89e62ccf2f1354bc2716df">u32</a> priority{std::max(ready_queue.<a class="code" href="struct_common_1_1_thread_queue_list.html#a636d4bce7833ef66b5d26f6e2765609e">get_first</a>()-&gt;current_priority - 1, 40u)};</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;            thread-&gt;BoostPriority(priority);</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        }</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    }</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;}</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;</div><div class="line"><a name="l00122"></a><span class="lineno"><a class="line" href="namespace_kernel.html#a98690d9f14327bf8026ca1de39216e87">  122</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="namespace_kernel.html#a98690d9f14327bf8026ca1de39216e87">SwitchContext</a>(<a class="code" href="class_kernel_1_1_thread.html">Thread</a>* new_thread) {</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <a class="code" href="class_kernel_1_1_thread.html">Thread</a>* previous_thread{<a class="code" href="namespace_kernel.html#a468effefd7385726635010b18e69a625">GetCurrentThread</a>()};</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="comment">// Save context for previous thread</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="keywordflow">if</span> (previous_thread) {</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        previous_thread-&gt;<a class="code" href="class_kernel_1_1_thread.html#a1e3c43a8deb41dc6153ea268bcc0d0ea">last_running_ticks</a> = <a class="code" href="namespace_core_timing.html#a3ed2b5dcdf393fa1f42be0b25c1a43ad">CoreTiming::GetTicks</a>();</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        <a class="code" href="namespace_core.html#a451d67b62d548c4f3ee8363056ad97e7">Core::GetCPU</a>().<a class="code" href="class_c_p_u.html#a730fc0cc09c3a47eb93cf8ec667ae70a">SaveContext</a>(previous_thread-&gt;context);</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        <span class="keywordflow">if</span> (previous_thread-&gt;status == <a class="code" href="thread_8h.html#ae2739961013a00cede621d4d72f2173ca77ebc88c857506e20c820efcd24903fb">THREADSTATUS_RUNNING</a>) {</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;            <span class="comment">// This is only the case when a reschedule is triggered without the current thread</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;            <span class="comment">// yielding execution (i.e. an event triggered, system core time-sliced, etc)</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;            ready_queue.<a class="code" href="struct_common_1_1_thread_queue_list.html#a01bf13601adfb673b79f8f6202652acb">push_front</a>(previous_thread-&gt;current_priority, previous_thread);</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;            previous_thread-&gt;status = <a class="code" href="thread_8h.html#ae2739961013a00cede621d4d72f2173cadf17bd50b28528532f3db84ba9eae228">THREADSTATUS_READY</a>;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        }</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    }</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="comment">// Load context of new thread</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="keywordflow">if</span> (new_thread) {</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        <a class="code" href="assert_8h.html#a4b432fb3d47e2ca732caf965691a54d7">ASSERT_MSG</a>(new_thread-&gt;<a class="code" href="class_kernel_1_1_thread.html#aa36c37078e343a0681974bf0077fd3ab">status</a> == <a class="code" href="thread_8h.html#ae2739961013a00cede621d4d72f2173cadf17bd50b28528532f3db84ba9eae228">THREADSTATUS_READY</a>,</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                   <span class="stringliteral">&quot;Thread must be ready to become running.&quot;</span>);</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <span class="comment">// Cancel any outstanding wakeup events for this thread</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        <a class="code" href="namespace_core_timing.html#a1d0fc13b562a6c699cdcbfd4ccdfbc10">CoreTiming::UnscheduleEvent</a>(<a class="code" href="namespace_kernel.html#ada81dec7407585e67527a2748902b829">ThreadWakeupEventType</a>, new_thread-&gt;<a class="code" href="class_kernel_1_1_thread.html#a45860435fb69f8d8d56eb4e4efdee67d">callback_handle</a>);</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        <span class="keyword">auto</span> previous_process{<a class="code" href="namespace_kernel.html#ac7460d5f540b785aea634c73c5430acd">Kernel::g_current_process</a>};</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        current_thread = new_thread;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        ready_queue.<a class="code" href="struct_common_1_1_thread_queue_list.html#ad85031b2be281c42ef537553a2fd4510">remove</a>(new_thread-&gt;<a class="code" href="class_kernel_1_1_thread.html#af9c2edebfe0ad65f7de1375b9a075c20">current_priority</a>, new_thread);</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        new_thread-&gt;<a class="code" href="class_kernel_1_1_thread.html#aa36c37078e343a0681974bf0077fd3ab">status</a> = <a class="code" href="thread_8h.html#ae2739961013a00cede621d4d72f2173ca77ebc88c857506e20c820efcd24903fb">THREADSTATUS_RUNNING</a>;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespace_settings.html#a89bad2e81a950120963b3f26c691810a">Settings::values</a>.priority_boost)</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;            new_thread-&gt;<a class="code" href="class_kernel_1_1_thread.html#af9c2edebfe0ad65f7de1375b9a075c20">current_priority</a> = new_thread-&gt;<a class="code" href="class_kernel_1_1_thread.html#a6e0f27efc7742878543134d50aa0e342">nominal_priority</a>;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        <span class="keywordflow">if</span> (previous_process != current_thread-&gt;owner_process) {</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;            <a class="code" href="namespace_kernel.html#ac7460d5f540b785aea634c73c5430acd">Kernel::g_current_process</a> = current_thread-&gt;owner_process;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;            <a class="code" href="namespace_memory.html#a9385b06235a83b908d97dedb0416ce7b">SetCurrentPageTable</a>(&amp;<a class="code" href="namespace_kernel.html#ac7460d5f540b785aea634c73c5430acd">Kernel::g_current_process</a>-&gt;vm_manager.page_table);</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        }</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        <a class="code" href="namespace_core.html#a451d67b62d548c4f3ee8363056ad97e7">Core::GetCPU</a>().<a class="code" href="class_c_p_u.html#aefb1b0cec418b7f41b2d88e0c24242de">LoadContext</a>(new_thread-&gt;<a class="code" href="class_kernel_1_1_thread.html#ad951569c330a60c2f62e465800ebcb47">context</a>);</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        <a class="code" href="namespace_core.html#a451d67b62d548c4f3ee8363056ad97e7">Core::GetCPU</a>().<a class="code" href="class_c_p_u.html#a5d448f8d0b9d55ab9cf05f9344de263b">SetCP15Register</a>(<a class="code" href="core_2cpu_2common_8h.html#ae8e14720547949c44161179b028b4f62a710e3130568ad2b5fc34d57dfa1d4efe">CP15_THREAD_URO</a>, new_thread-&gt;<a class="code" href="class_kernel_1_1_thread.html#aba14d687d899ff02d80be171232001ca">GetTLSAddress</a>());</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        current_thread = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        <span class="comment">// Note: We do not reset the current process and current page table when idling because</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        <span class="comment">// technically we haven&#39;t changed processes, our threads are just paused.</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    }</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;}</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div><div class="line"><a name="l00174"></a><span class="lineno"><a class="line" href="namespace_kernel.html#abb5661fdc2fa616b12a53b0b558d203f">  174</a></span>&#160;<span class="keyword">static</span> <a class="code" href="class_kernel_1_1_thread.html">Thread</a>* <a class="code" href="namespace_kernel.html#abb5661fdc2fa616b12a53b0b558d203f">PopNextReadyThread</a>() {</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <a class="code" href="class_kernel_1_1_thread.html">Thread</a>* next{};</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <a class="code" href="class_kernel_1_1_thread.html">Thread</a>* thread{<a class="code" href="namespace_kernel.html#a468effefd7385726635010b18e69a625">GetCurrentThread</a>()};</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="keywordflow">if</span> (thread &amp;&amp; thread-&gt;status == <a class="code" href="thread_8h.html#ae2739961013a00cede621d4d72f2173ca77ebc88c857506e20c820efcd24903fb">THREADSTATUS_RUNNING</a>) {</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        <span class="comment">// We have to do better than the current thread.</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        <span class="comment">// This call returns null when that&#39;s not possible.</span></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        next = ready_queue.<a class="code" href="struct_common_1_1_thread_queue_list.html#a35811fb17ea0f69d77a8213f0eedf1ae">pop_first_better</a>(thread-&gt;current_priority);</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        <span class="keywordflow">if</span> (!next) {</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;            <span class="comment">// Otherwise just keep going with the current thread</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;            next = thread;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        }</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        next = ready_queue.<a class="code" href="struct_common_1_1_thread_queue_list.html#ab2944a061ab6c46698c8be50d5579146">pop_first</a>();</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    }</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keywordflow">return</span> next;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;}</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;</div><div class="line"><a name="l00193"></a><span class="lineno"><a class="line" href="namespace_kernel.html#a799098b4a3ef3b8700965b981e08d160">  193</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespace_kernel.html#a799098b4a3ef3b8700965b981e08d160">WaitCurrentThread_Sleep</a>() {</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <a class="code" href="class_kernel_1_1_thread.html">Thread</a>* thread{<a class="code" href="namespace_kernel.html#a468effefd7385726635010b18e69a625">GetCurrentThread</a>()};</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    thread-&gt;<a class="code" href="class_kernel_1_1_thread.html#aa36c37078e343a0681974bf0077fd3ab">status</a> = <a class="code" href="thread_8h.html#ae2739961013a00cede621d4d72f2173ca656047d30f939008f2f528ce6fabe1c7">THREADSTATUS_WAIT_SLEEP</a>;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;}</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div><div class="line"><a name="l00198"></a><span class="lineno"><a class="line" href="namespace_kernel.html#a21df05cea2994e37c48d7ca896f0dce3">  198</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespace_kernel.html#a21df05cea2994e37c48d7ca896f0dce3">ExitCurrentThread</a>() {</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <a class="code" href="class_kernel_1_1_thread.html">Thread</a>* thread{<a class="code" href="namespace_kernel.html#a468effefd7385726635010b18e69a625">GetCurrentThread</a>()};</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    thread-&gt;<a class="code" href="class_kernel_1_1_thread.html#afc1eccdba24dd9c1405d0c79acafb76c">Stop</a>();</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    thread_list.erase(std::remove(thread_list.begin(), thread_list.end(), thread),</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                      thread_list.end());</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;}</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;</div><div class="line"><a name="l00210"></a><span class="lineno"><a class="line" href="namespace_kernel.html#aae441b6285ab4907e8fe87cc0e8297bf">  210</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="namespace_kernel.html#aae441b6285ab4907e8fe87cc0e8297bf">ThreadWakeupCallback</a>(<a class="code" href="common__types_8h.html#a66e1d499241ccae9a18a20a1f4f0590d">u64</a> thread_handle, <a class="code" href="common__types_8h.html#a35714c97d4ec315cb8c6e79d7b2a1cbc">s64</a> cycles_late) {</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <a class="code" href="namespace_kernel.html#afc9bde79933dd23864df0768adeb6cfe">SharedPtr&lt;Thread&gt;</a> thread{wakeup_callback_handle_table.<a class="code" href="class_kernel_1_1_handle_table.html#a49b9a4eb348b1528afac22d7fdd34a3a">Get</a>&lt;<a class="code" href="class_kernel_1_1_thread.html">Thread</a>&gt;((<a class="code" href="namespace_kernel.html#ad6b2714868b2c2be12c3b00822d18b2e">Handle</a>)thread_handle)};</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="keywordflow">if</span> (thread == <span class="keyword">nullptr</span>) {</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        <a class="code" href="log_8h.html#a51fb52bb5a30e10d1eff3cc23c71d747">LOG_CRITICAL</a>(<a class="code" href="namespace_kernel.html">Kernel</a>, <span class="stringliteral">&quot;Callback fired for invalid thread {:08X}&quot;</span>, thread_handle);</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    }</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="keywordflow">if</span> (thread-&gt;status == <a class="code" href="thread_8h.html#ae2739961013a00cede621d4d72f2173ca742bfb20eaa72521d7df72464ea20a90">THREADSTATUS_WAIT_SYNCH_ANY</a> ||</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        thread-&gt;status == <a class="code" href="thread_8h.html#ae2739961013a00cede621d4d72f2173ca000e025c8cf9041da85d0dabc19ad777">THREADSTATUS_WAIT_SYNCH_ALL</a> || thread-&gt;status == <a class="code" href="thread_8h.html#ae2739961013a00cede621d4d72f2173cabe45f2d11eb47a80b9b268f9ea5bc695">THREADSTATUS_WAIT_ARB</a> ||</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        thread-&gt;status == <a class="code" href="thread_8h.html#ae2739961013a00cede621d4d72f2173ca1c4225d1e5a678d4f4f512130c77cf22">THREADSTATUS_WAIT_HLE_EVENT</a>) {</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        <span class="comment">// Invoke the wakeup callback before clearing the wait objects</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        <span class="keywordflow">if</span> (thread-&gt;wakeup_callback)</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;            thread-&gt;wakeup_callback(<a class="code" href="thread_8h.html#a36bd654753f9fb7e2b269831f4e6ad80ac85a251cc457840f1e032f1b733e9398">ThreadWakeupReason::Timeout</a>, thread, <span class="keyword">nullptr</span>);</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        <span class="comment">// Remove the thread from each of its waiting objects&#39; waitlists</span></div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; <span class="keywordtype">object</span> : thread-&gt;wait_objects)</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;            <span class="keywordtype">object</span>-&gt;RemoveWaitingThread(thread.get());</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        thread-&gt;wait_objects.clear();</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    }</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    thread-&gt;ResumeFromWait();</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;}</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;</div><div class="line"><a name="l00234"></a><span class="lineno"><a class="line" href="class_kernel_1_1_thread.html#ae4de32cafc24def63c2e1da27ad0dd39">  234</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_kernel_1_1_thread.html#ae4de32cafc24def63c2e1da27ad0dd39">Thread::WakeAfterDelay</a>(<a class="code" href="common__types_8h.html#a35714c97d4ec315cb8c6e79d7b2a1cbc">s64</a> nanoseconds) {</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="comment">// Don&#39;t schedule a wakeup if the thread wants to wait forever</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="keywordflow">if</span> (nanoseconds == -1)</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <a class="code" href="namespace_core_timing.html#a9e1678c03397fd456975cc4060f6feab">CoreTiming::ScheduleEvent</a>(<a class="code" href="core__timing_8h.html#ae07683b2295c7762ef165931412ab10d">nsToCycles</a>(nanoseconds), <a class="code" href="namespace_kernel.html#ada81dec7407585e67527a2748902b829">ThreadWakeupEventType</a>, <a class="code" href="class_kernel_1_1_thread.html#a45860435fb69f8d8d56eb4e4efdee67d">callback_handle</a>);</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;}</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;</div><div class="line"><a name="l00242"></a><span class="lineno"><a class="line" href="class_kernel_1_1_thread.html#a9ccfba16056218acee5f3d4ee031b12b">  242</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_kernel_1_1_thread.html#a9ccfba16056218acee5f3d4ee031b12b">Thread::ResumeFromWait</a>() {</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <a class="code" href="assert_8h.html#a4b432fb3d47e2ca732caf965691a54d7">ASSERT_MSG</a>(<a class="code" href="class_kernel_1_1_thread.html#a1b16fe65c9f07e069bb8bb97c1ad6689">wait_objects</a>.empty(), <span class="stringliteral">&quot;Thread is waking up while waiting for objects&quot;</span>);</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="class_kernel_1_1_thread.html#aa36c37078e343a0681974bf0077fd3ab">status</a>) {</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="thread_8h.html#ae2739961013a00cede621d4d72f2173ca000e025c8cf9041da85d0dabc19ad777">THREADSTATUS_WAIT_SYNCH_ALL</a>:</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="thread_8h.html#ae2739961013a00cede621d4d72f2173ca742bfb20eaa72521d7df72464ea20a90">THREADSTATUS_WAIT_SYNCH_ANY</a>:</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="thread_8h.html#ae2739961013a00cede621d4d72f2173ca1c4225d1e5a678d4f4f512130c77cf22">THREADSTATUS_WAIT_HLE_EVENT</a>:</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="thread_8h.html#ae2739961013a00cede621d4d72f2173cabe45f2d11eb47a80b9b268f9ea5bc695">THREADSTATUS_WAIT_ARB</a>:</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="thread_8h.html#ae2739961013a00cede621d4d72f2173ca656047d30f939008f2f528ce6fabe1c7">THREADSTATUS_WAIT_SLEEP</a>:</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="thread_8h.html#ae2739961013a00cede621d4d72f2173ca5f6e947e083848f5976cfc321bb74b01">THREADSTATUS_WAIT_IPC</a>:</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="thread_8h.html#ae2739961013a00cede621d4d72f2173cadf17bd50b28528532f3db84ba9eae228">THREADSTATUS_READY</a>:</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        <span class="comment">// The thread&#39;s wakeup callback must have already been cleared when the thread was first</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        <span class="comment">// awoken.</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        <a class="code" href="assert_8h.html#a9f920d5e0c0e8780d4ce9bfb15bfd9e2">ASSERT</a>(<a class="code" href="class_kernel_1_1_thread.html#a76b8c91d28e852f66c4343d531964b64">wakeup_callback</a> == <span class="keyword">nullptr</span>);</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        <span class="comment">// If the thread is waiting on multiple wait objects, it might be awoken more than once</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        <span class="comment">// before actually resuming. We can ignore subsequent wakeups if the thread status has</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        <span class="comment">// already been set to THREADSTATUS_READY.</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="thread_8h.html#ae2739961013a00cede621d4d72f2173ca77ebc88c857506e20c820efcd24903fb">THREADSTATUS_RUNNING</a>:</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        <a class="code" href="assert_8h.html#afbc5558e0fd2920b8774c8b366dd4100">DEBUG_ASSERT_MSG</a>(<span class="keyword">false</span>, <span class="stringliteral">&quot;Thread with object id {} has already resumed.&quot;</span>, <a class="code" href="class_kernel_1_1_object.html#a9df364a9204a4b3cb27ae2b48982568f">GetObjectId</a>());</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="thread_8h.html#ae2739961013a00cede621d4d72f2173ca45bf95b1b887bdba9b3e24b98cc814ee">THREADSTATUS_DEAD</a>:</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        <span class="comment">// This should never happen, as threads must complete before being stopped.</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        <a class="code" href="assert_8h.html#afbc5558e0fd2920b8774c8b366dd4100">DEBUG_ASSERT_MSG</a>(<span class="keyword">false</span>, <span class="stringliteral">&quot;Thread with object id {} cannot be resumed because it&#39;s DEAD.&quot;</span>,</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                         <a class="code" href="class_kernel_1_1_object.html#a9df364a9204a4b3cb27ae2b48982568f">GetObjectId</a>());</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    }</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <a class="code" href="class_kernel_1_1_thread.html#a76b8c91d28e852f66c4343d531964b64">wakeup_callback</a> = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    ready_queue.<a class="code" href="struct_common_1_1_thread_queue_list.html#a5babf831bd7a32cd0e59f4305fb22e14">push_back</a>(<a class="code" href="class_kernel_1_1_thread.html#af9c2edebfe0ad65f7de1375b9a075c20">current_priority</a>, <span class="keyword">this</span>);</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <a class="code" href="class_kernel_1_1_thread.html#aa36c37078e343a0681974bf0077fd3ab">status</a> = <a class="code" href="thread_8h.html#ae2739961013a00cede621d4d72f2173cadf17bd50b28528532f3db84ba9eae228">THREADSTATUS_READY</a>;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <a class="code" href="class_core_1_1_system.html#ab2f9ff357787ec877567d8c4ffe2a2d4">Core::System::GetInstance</a>().<a class="code" href="class_core_1_1_system.html#acc138e43b0c06bf63a0429f1d062bfc4">PrepareReschedule</a>();</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;}</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;</div><div class="line"><a name="l00288"></a><span class="lineno"><a class="line" href="namespace_kernel.html#a6322f1b0959e8514c58a93ac414f4d5a">  288</a></span>&#160;<span class="keyword">static</span> std::tuple&lt;std::size_t, std::size_t, bool&gt; <a class="code" href="namespace_kernel.html#a6322f1b0959e8514c58a93ac414f4d5a">GetFreeThreadLocalSlot</a>(</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="keyword">const</span> std::vector&lt;std::bitset&lt;8&gt;&gt;&amp; tls_slots) {</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="comment">// Iterate over all the allocated pages, and try to find one where not all slots are used.</span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="keywordflow">for</span> (std::size_t page{}; page &lt; tls_slots.size(); ++page) {</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span>&amp; page_tls_slots{tls_slots[page]};</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        <span class="keywordflow">if</span> (!page_tls_slots.all()) {</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;            <span class="comment">// We found a page with at least one free slot, find which slot it is</span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;            <span class="keywordflow">for</span> (std::size_t slot{}; slot &lt; page_tls_slots.size(); ++slot) {</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                <span class="keywordflow">if</span> (!page_tls_slots.test(slot)) {</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                    <span class="keywordflow">return</span> std::make_tuple(page, slot, <span class="keyword">false</span>);</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                }</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;            }</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        }</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    }</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="keywordflow">return</span> std::make_tuple(0, 0, <span class="keyword">true</span>);</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;}</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;</div><div class="line"><a name="l00313"></a><span class="lineno"><a class="line" href="namespace_kernel.html#add0758203dd366887f2b1de7de1e2f3f">  313</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="namespace_kernel.html#add0758203dd366887f2b1de7de1e2f3f">ResetThreadContext</a>(<span class="keyword">const</span> std::unique_ptr&lt;ThreadContext&gt;&amp; <a class="code" href="class_kernel_1_1_thread.html#ad951569c330a60c2f62e465800ebcb47">context</a>, <a class="code" href="common__types_8h.html#a65cf28726f89e62ccf2f1354bc2716df">u32</a> <a class="code" href="class_kernel_1_1_thread.html#aaabeb4aa9725cffaec9c53c36e96eb8e">stack_top</a>,</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                               <a class="code" href="common__types_8h.html#a65cf28726f89e62ccf2f1354bc2716df">u32</a> <a class="code" href="class_kernel_1_1_thread.html#adbb27afcdc9ce1d85edbd3ec8ab76030">entry_point</a>, <a class="code" href="common__types_8h.html#a65cf28726f89e62ccf2f1354bc2716df">u32</a> arg) {</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    context-&gt;Reset();</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    context-&gt;SetCpuRegister(0, arg);</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    context-&gt;SetProgramCounter(entry_point);</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    context-&gt;SetStackPointer(stack_top);</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    context-&gt;SetCpsr(<a class="code" href="core_2cpu_2common_8h.html#a755aa35b683d219676ce9e07b7eda4d1">USER32MODE</a> | ((entry_point &amp; 1) &lt;&lt; 5)); <span class="comment">// Usermode and THUMB mode</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;}</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;</div><div class="line"><a name="l00322"></a><span class="lineno"><a class="line" href="class_kernel_1_1_thread.html#a00f5958b3c1f24db6d11b593d6e31ad2">  322</a></span>&#160;<a class="code" href="class_result_val.html">ResultVal&lt;SharedPtr&lt;Thread&gt;</a>&gt; <a class="code" href="class_kernel_1_1_thread.html#a00f5958b3c1f24db6d11b593d6e31ad2">Thread::Create</a>(std::string <a class="code" href="class_kernel_1_1_thread.html#a8dae41fac6cb0e98ccf316031cb7bc57">name</a>, <a class="code" href="common__types_8h.html#ace342d87f62470edf84b7593d7dc8b27">VAddr</a> <a class="code" href="class_kernel_1_1_thread.html#adbb27afcdc9ce1d85edbd3ec8ab76030">entry_point</a>, <a class="code" href="common__types_8h.html#a65cf28726f89e62ccf2f1354bc2716df">u32</a> priority,</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                                            <a class="code" href="common__types_8h.html#a65cf28726f89e62ccf2f1354bc2716df">u32</a> arg, <a class="code" href="common__types_8h.html#ab0b052f6ae930a8319bef4c5760f72c0">s32</a> <a class="code" href="class_kernel_1_1_thread.html#a7bc369db59f3a581be6dd929e44bcdb0">processor_id</a>, <a class="code" href="common__types_8h.html#ace342d87f62470edf84b7593d7dc8b27">VAddr</a> <a class="code" href="class_kernel_1_1_thread.html#aaabeb4aa9725cffaec9c53c36e96eb8e">stack_top</a>,</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                                            <a class="code" href="namespace_kernel.html#afc9bde79933dd23864df0768adeb6cfe">SharedPtr&lt;Process&gt;</a> <a class="code" href="class_kernel_1_1_thread.html#a6c6cf033699fdc311f5b89132facf339">owner_process</a>) {</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="comment">// Check if priority is in ranged. Lowest priority -&gt; highest priority id.</span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="keywordflow">if</span> (priority &gt; <a class="code" href="thread_8h.html#a7f5a53b4a276b18ce9c72982ab3fc772a3a09ff6360c3f2a2648fb73ac154e37a">THREADPRIO_LOWEST</a>) {</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        <a class="code" href="log_8h.html#a2f872ec42bda0e5baf8783313a28494c">LOG_ERROR</a>(Kernel_SVC, <span class="stringliteral">&quot;Invalid thread priority: {}&quot;</span>, priority);</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="namespace_kernel.html#a968e7c20e8c0e782055b1f8c53939ce8">ERR_OUT_OF_RANGE</a>;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    }</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="keywordflow">if</span> (processor_id &gt; <a class="code" href="thread_8h.html#aa22fbc47a3eef37e7a1b68462ffd8f2da8011039d301f169faf196be6c5a5289b">THREADPROCESSORID_MAX</a>) {</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        <a class="code" href="log_8h.html#a2f872ec42bda0e5baf8783313a28494c">LOG_ERROR</a>(Kernel_SVC, <span class="stringliteral">&quot;Invalid processor id: {}&quot;</span>, processor_id);</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="namespace_kernel.html#a712ba5c60b9228ac11b5338615e4c3ae">ERR_OUT_OF_RANGE_KERNEL</a>;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    }</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="comment">// TODO(yuriks): Other checks, returning 0xD9001BEA</span></div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="namespace_memory.html#a3bf02d5785f2a1e9f6116bbbdcdfb4e7">Memory::IsValidVirtualAddress</a>(*owner_process, entry_point)) {</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        <a class="code" href="log_8h.html#a2f872ec42bda0e5baf8783313a28494c">LOG_ERROR</a>(Kernel_SVC, <span class="stringliteral">&quot;(name={}): invalid entry {:08x}&quot;</span>, name, entry_point);</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        <span class="comment">// TODO: Verify error</span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="union_result_code.html">ResultCode</a>(<a class="code" href="result_8h.html#afe30fc4506a4cf2ee780b2319dbec74da66196dd9678aef4aaad947e7181049c0">ErrorDescription::InvalidAddress</a>, <a class="code" href="result_8h.html#a67158ef38e1ab9113151768007433e3aa6ff9f4444ac481652f4412b5e1623846">ErrorModule::Kernel</a>,</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;                          <a class="code" href="result_8h.html#a1d3c3229b2c38b6fe717b434732c5b86a253ca7dd096ee0956cccee4d376cab8b">ErrorSummary::InvalidArgument</a>, <a class="code" href="result_8h.html#aa3b9056eb03ec4e7c3561192eb830739a23adaa457573eeb089c33214c90d3013">ErrorLevel::Permanent</a>);</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    }</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <a class="code" href="namespace_kernel.html#afc9bde79933dd23864df0768adeb6cfe">SharedPtr&lt;Thread&gt;</a> thread(<span class="keyword">new</span> <a class="code" href="class_kernel_1_1_thread.html">Thread</a>);</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    thread_list.push_back(thread);</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    ready_queue.<a class="code" href="struct_common_1_1_thread_queue_list.html#a818ceae82b99dac25e93c72958c6118b">prepare</a>(priority);</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    thread-&gt;thread_id = <a class="code" href="namespace_kernel.html#a9acd1f517f5c78daa3d519fd31b48796">NewThreadId</a>();</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    thread-&gt;status = <a class="code" href="thread_8h.html#ae2739961013a00cede621d4d72f2173ca4ea4195be2fc5341eb2de05cf8e11b2e">THREADSTATUS_DORMANT</a>;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    thread-&gt;entry_point = <a class="code" href="class_kernel_1_1_thread.html#adbb27afcdc9ce1d85edbd3ec8ab76030">entry_point</a>;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    thread-&gt;stack_top = <a class="code" href="class_kernel_1_1_thread.html#aaabeb4aa9725cffaec9c53c36e96eb8e">stack_top</a>;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    thread-&gt;nominal_priority = thread-&gt;current_priority = priority;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    thread-&gt;last_running_ticks = <a class="code" href="namespace_core_timing.html#a3ed2b5dcdf393fa1f42be0b25c1a43ad">CoreTiming::GetTicks</a>();</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    thread-&gt;processor_id = <a class="code" href="class_kernel_1_1_thread.html#a7bc369db59f3a581be6dd929e44bcdb0">processor_id</a>;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    thread-&gt;wait_objects.clear();</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    thread-&gt;wait_address = 0;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    thread-&gt;name = std::move(name);</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    thread-&gt;callback_handle = wakeup_callback_handle_table.<a class="code" href="class_kernel_1_1_handle_table.html#a5b29630a4f933d886325cdf00528f46e">Create</a>(thread).Unwrap();</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    thread-&gt;owner_process = <a class="code" href="class_kernel_1_1_thread.html#a6c6cf033699fdc311f5b89132facf339">owner_process</a>;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="comment">// Find the next available TLS index, and mark it as used</span></div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <span class="keyword">auto</span>&amp; tls_slots{owner_process-&gt;tls_slots};</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="keyword">auto</span> [available_page, available_slot, needs_allocation]{<a class="code" href="namespace_kernel.html#a6322f1b0959e8514c58a93ac414f4d5a">GetFreeThreadLocalSlot</a>(tls_slots)};</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="keywordflow">if</span> (needs_allocation) {</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        <span class="comment">// There are no already-allocated pages with free slots, lets allocate a new one.</span></div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        <span class="comment">// TLS pages are allocated from the BASE region in the linear heap.</span></div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        <a class="code" href="namespace_kernel.html#struct_kernel_1_1_memory_region_info">MemoryRegionInfo</a>* memory_region{<a class="code" href="namespace_kernel.html#a1bce0cfa9f85567e044bb113dc00599b">GetMemoryRegion</a>(<a class="code" href="namespace_kernel.html#aee28364411c4e2f2ce57323277907440ae7b1a5c82772e0e055096008cb9883ef">MemoryRegion::BASE</a>)};</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        <span class="keyword">auto</span>&amp; linheap_memory{memory_region-&gt;<a class="code" href="namespace_kernel.html#ae91eedd3b1a0322f15235a3fc66a7f35">linear_heap_memory</a>};</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        <span class="keywordflow">if</span> (linheap_memory-&gt;size() + <a class="code" href="namespace_memory.html#a41fd7618a06f2e2d24eebe866db68d7d">Memory::PAGE_SIZE</a> &gt; memory_region-&gt;size) {</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;            <a class="code" href="log_8h.html#a2f872ec42bda0e5baf8783313a28494c">LOG_ERROR</a>(Kernel_SVC,</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                      <span class="stringliteral">&quot;Not enough space in region to allocate a new TLS page for thread&quot;</span>);</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="namespace_kernel.html#ab6ce89d727d7323f89dbab10c23a9c37">ERR_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        }</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        std::size_t offset{linheap_memory-&gt;size()};</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        <span class="comment">// Allocate some memory from the end of the linear heap for this region.</span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        linheap_memory-&gt;insert(linheap_memory-&gt;end(), <a class="code" href="namespace_memory.html#a41fd7618a06f2e2d24eebe866db68d7d">Memory::PAGE_SIZE</a>, 0);</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        memory_region-&gt;used += <a class="code" href="namespace_memory.html#a41fd7618a06f2e2d24eebe866db68d7d">Memory::PAGE_SIZE</a>;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        owner_process-&gt;linear_heap_used += <a class="code" href="namespace_memory.html#a41fd7618a06f2e2d24eebe866db68d7d">Memory::PAGE_SIZE</a>;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        tls_slots.emplace_back(0); <span class="comment">// The page is completely available at the start</span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        available_page = tls_slots.size() - 1;</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        available_slot = 0; <span class="comment">// Use the first slot in the new page</span></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        <span class="keyword">auto</span>&amp; vm_manager{owner_process-&gt;vm_manager};</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        vm_manager.RefreshMemoryBlockMappings(linheap_memory.get());</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        <span class="comment">// Map the page to the current process&#39; address space.</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        <span class="comment">// TODO(Subv): Find the correct MemoryState for this region.</span></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        vm_manager.MapMemoryBlock(<a class="code" href="namespace_memory.html#a0abdbb4b878710f67db886fba7a802ffa1c713c87eb1364d04b3809eb5c997300">Memory::TLS_AREA_VADDR</a> + available_page * <a class="code" href="namespace_memory.html#a41fd7618a06f2e2d24eebe866db68d7d">Memory::PAGE_SIZE</a>,</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                                  linheap_memory, offset, Memory::PAGE_SIZE, <a class="code" href="namespace_kernel.html#ac98ea407adc130ee57ae39f4d65337d8a47f9082fc380ca62d531096aa1d110f1">MemoryState::Private</a>);</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    }</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <span class="comment">// Mark the slot as used</span></div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    tls_slots[available_page].set(available_slot);</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    thread-&gt;tls_address = <a class="code" href="namespace_memory.html#a0abdbb4b878710f67db886fba7a802ffa1c713c87eb1364d04b3809eb5c997300">Memory::TLS_AREA_VADDR</a> + available_page * <a class="code" href="namespace_memory.html#a41fd7618a06f2e2d24eebe866db68d7d">Memory::PAGE_SIZE</a> +</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                          available_slot * <a class="code" href="namespace_memory.html#a0abdbb4b878710f67db886fba7a802ffa820834c3a77024ad4188433682366051">Memory::TLS_ENTRY_SIZE</a>;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <span class="comment">// TODO(peachum): move to ScheduleThread() when scheduler is added so selected core is used</span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="comment">// to initialize the context</span></div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <a class="code" href="namespace_kernel.html#add0758203dd366887f2b1de7de1e2f3f">ResetThreadContext</a>(thread-&gt;context, stack_top, entry_point, arg);</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    ready_queue.<a class="code" href="struct_common_1_1_thread_queue_list.html#a5babf831bd7a32cd0e59f4305fb22e14">push_back</a>(thread-&gt;current_priority, thread.get());</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    thread-&gt;status = <a class="code" href="thread_8h.html#ae2739961013a00cede621d4d72f2173cadf17bd50b28528532f3db84ba9eae228">THREADSTATUS_READY</a>;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <span class="keywordflow">return</span> MakeResult&lt;SharedPtr&lt;Thread&gt;&gt;(std::move(thread));</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;}</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;</div><div class="line"><a name="l00415"></a><span class="lineno"><a class="line" href="class_kernel_1_1_thread.html#a6394962e85e59b1a25a8f156ff09ecda">  415</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_kernel_1_1_thread.html#a6394962e85e59b1a25a8f156ff09ecda">Thread::SetPriority</a>(<a class="code" href="common__types_8h.html#a65cf28726f89e62ccf2f1354bc2716df">u32</a> priority) {</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <a class="code" href="assert_8h.html#a4b432fb3d47e2ca732caf965691a54d7">ASSERT_MSG</a>(priority &lt;= THREADPRIO_LOWEST &amp;&amp; priority &gt;= <a class="code" href="thread_8h.html#a7f5a53b4a276b18ce9c72982ab3fc772a27721a7ab79c120e622b9718a66546f8">THREADPRIO_HIGHEST</a>,</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;               <span class="stringliteral">&quot;Invalid priority value.&quot;</span>);</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="comment">// If thread was ready, adjust queues</span></div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="class_kernel_1_1_thread.html#aa36c37078e343a0681974bf0077fd3ab">status</a> == <a class="code" href="thread_8h.html#ae2739961013a00cede621d4d72f2173cadf17bd50b28528532f3db84ba9eae228">THREADSTATUS_READY</a>)</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        ready_queue.<a class="code" href="struct_common_1_1_thread_queue_list.html#a561ab94bad249fa98cf35888ec1371dc">move</a>(<span class="keyword">this</span>, <a class="code" href="class_kernel_1_1_thread.html#af9c2edebfe0ad65f7de1375b9a075c20">current_priority</a>, priority);</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        ready_queue.<a class="code" href="struct_common_1_1_thread_queue_list.html#a818ceae82b99dac25e93c72958c6118b">prepare</a>(priority);</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <a class="code" href="class_kernel_1_1_thread.html#a6e0f27efc7742878543134d50aa0e342">nominal_priority</a> = <a class="code" href="class_kernel_1_1_thread.html#af9c2edebfe0ad65f7de1375b9a075c20">current_priority</a> = priority;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;}</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;</div><div class="line"><a name="l00427"></a><span class="lineno"><a class="line" href="class_kernel_1_1_thread.html#a4ff2955fd517f4e727e1335d6db55073">  427</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_kernel_1_1_thread.html#a4ff2955fd517f4e727e1335d6db55073">Thread::UpdatePriority</a>() {</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <a class="code" href="common__types_8h.html#a65cf28726f89e62ccf2f1354bc2716df">u32</a> best_priority{<a class="code" href="class_kernel_1_1_thread.html#a6e0f27efc7742878543134d50aa0e342">nominal_priority</a>};</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; mutex : <a class="code" href="class_kernel_1_1_thread.html#a5f600013306821c2e8e319432b5a14c5">held_mutexes</a>) {</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        <span class="keywordflow">if</span> (mutex-&gt;priority &lt; best_priority)</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;            best_priority = mutex-&gt;priority;</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    }</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <a class="code" href="class_kernel_1_1_thread.html#af23eac6fd1b937083b79739204c2a833">BoostPriority</a>(best_priority);</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;}</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;</div><div class="line"><a name="l00436"></a><span class="lineno"><a class="line" href="class_kernel_1_1_thread.html#af23eac6fd1b937083b79739204c2a833">  436</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_kernel_1_1_thread.html#af23eac6fd1b937083b79739204c2a833">Thread::BoostPriority</a>(<a class="code" href="common__types_8h.html#a65cf28726f89e62ccf2f1354bc2716df">u32</a> priority) {</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <span class="comment">// If thread was ready, adjust queues</span></div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="class_kernel_1_1_thread.html#aa36c37078e343a0681974bf0077fd3ab">status</a> == <a class="code" href="thread_8h.html#ae2739961013a00cede621d4d72f2173cadf17bd50b28528532f3db84ba9eae228">THREADSTATUS_READY</a>)</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        ready_queue.<a class="code" href="struct_common_1_1_thread_queue_list.html#a561ab94bad249fa98cf35888ec1371dc">move</a>(<span class="keyword">this</span>, <a class="code" href="class_kernel_1_1_thread.html#af9c2edebfe0ad65f7de1375b9a075c20">current_priority</a>, priority);</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        ready_queue.<a class="code" href="struct_common_1_1_thread_queue_list.html#a818ceae82b99dac25e93c72958c6118b">prepare</a>(priority);</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <a class="code" href="class_kernel_1_1_thread.html#af9c2edebfe0ad65f7de1375b9a075c20">current_priority</a> = priority;</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;}</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;</div><div class="line"><a name="l00445"></a><span class="lineno"><a class="line" href="namespace_kernel.html#a6d881391f98be9ad867180e91f8f59a6">  445</a></span>&#160;<a class="code" href="namespace_kernel.html#afc9bde79933dd23864df0768adeb6cfe">SharedPtr&lt;Thread&gt;</a> <a class="code" href="namespace_kernel.html#a6d881391f98be9ad867180e91f8f59a6">SetupMainThread</a>(<a class="code" href="common__types_8h.html#a65cf28726f89e62ccf2f1354bc2716df">u32</a> <a class="code" href="class_kernel_1_1_thread.html#adbb27afcdc9ce1d85edbd3ec8ab76030">entry_point</a>, <a class="code" href="common__types_8h.html#a65cf28726f89e62ccf2f1354bc2716df">u32</a> priority, <a class="code" href="namespace_kernel.html#afc9bde79933dd23864df0768adeb6cfe">SharedPtr&lt;Process&gt;</a> <a class="code" href="class_kernel_1_1_thread.html#a6c6cf033699fdc311f5b89132facf339">owner_process</a>) {</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    <span class="comment">// Initialize new &quot;main&quot; thread</span></div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <span class="keyword">auto</span> thread_res{<a class="code" href="class_kernel_1_1_thread.html#a00f5958b3c1f24db6d11b593d6e31ad2">Thread::Create</a>(<span class="stringliteral">&quot;main&quot;</span>, entry_point, priority, 0, owner_process-&gt;ideal_processor,</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                                   <a class="code" href="namespace_memory.html#a0abdbb4b878710f67db886fba7a802ffabfd5b3d456d510e70be2afb6a4da1316">Memory::HEAP_VADDR_END</a>, owner_process)};</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <a class="code" href="namespace_kernel.html#afc9bde79933dd23864df0768adeb6cfe">SharedPtr&lt;Thread&gt;</a> thread{std::move(thread_res).Unwrap()};</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    thread-&gt;context-&gt;SetFpscr(<a class="code" href="core_2cpu_2common_8h.html#ac0a6fd055c958aa80160e3f7b411fa7a">FPSCR_DEFAULT_NAN</a> | <a class="code" href="core_2cpu_2common_8h.html#aa20d39a4d63facba7baa6f25ac71b710">FPSCR_FLUSH_TO_ZERO</a> | <a class="code" href="core_2cpu_2common_8h.html#a354c6f419d1ad4d8924c5a0858ed72bc">FPSCR_ROUND_TOZERO</a> |</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;                              <a class="code" href="core_2cpu_2common_8h.html#ae0086b74dce0fe464bcd2f56b61ade12">FPSCR_IXC</a>); <span class="comment">// 0x03C00010</span></div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <span class="comment">// Note: The newly created thread will be run when the scheduler fires.</span></div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <span class="keywordflow">return</span> thread;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;}</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;</div><div class="line"><a name="l00459"></a><span class="lineno"><a class="line" href="namespace_kernel.html#a98a6cc20503acf96fbfa25e9acf53178">  459</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="namespace_kernel.html#a98a6cc20503acf96fbfa25e9acf53178">HaveReadyThreads</a>() {</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <span class="keywordflow">return</span> ready_queue.<a class="code" href="struct_common_1_1_thread_queue_list.html#a636d4bce7833ef66b5d26f6e2765609e">get_first</a>() != <span class="keyword">nullptr</span>;</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;}</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;</div><div class="line"><a name="l00463"></a><span class="lineno"><a class="line" href="namespace_kernel.html#acc94fbb639695fd4effa646fcc0ea631">  463</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespace_kernel.html#acc94fbb639695fd4effa646fcc0ea631">Reschedule</a>() {</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespace_settings.html#a89bad2e81a950120963b3f26c691810a">Settings::values</a>.priority_boost)</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        <a class="code" href="namespace_kernel.html#a8ab884791d23ec8f12c464b21e1983f7">PriorityBoostStarvedThreads</a>();</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <a class="code" href="class_kernel_1_1_thread.html">Thread</a>* cur{<a class="code" href="namespace_kernel.html#a468effefd7385726635010b18e69a625">GetCurrentThread</a>()};</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <a class="code" href="class_kernel_1_1_thread.html">Thread</a>* next{<a class="code" href="namespace_kernel.html#abb5661fdc2fa616b12a53b0b558d203f">PopNextReadyThread</a>()};</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    <span class="keywordflow">if</span> (cur &amp;&amp; next) {</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        <a class="code" href="log_8h.html#ae9fb9e5f54be61c473be717ec6e71298">LOG_TRACE</a>(<a class="code" href="namespace_kernel.html">Kernel</a>, <span class="stringliteral">&quot;context switch {} -&gt; {}&quot;</span>, cur-&gt;GetObjectId(), next-&gt;GetObjectId());</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (cur) {</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        <a class="code" href="log_8h.html#ae9fb9e5f54be61c473be717ec6e71298">LOG_TRACE</a>(<a class="code" href="namespace_kernel.html">Kernel</a>, <span class="stringliteral">&quot;context switch {} -&gt; idle&quot;</span>, cur-&gt;GetObjectId());</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (next) {</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        <a class="code" href="log_8h.html#ae9fb9e5f54be61c473be717ec6e71298">LOG_TRACE</a>(<a class="code" href="namespace_kernel.html">Kernel</a>, <span class="stringliteral">&quot;context switch idle -&gt; {}&quot;</span>, next-&gt;GetObjectId());</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    }</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <a class="code" href="namespace_kernel.html#a98690d9f14327bf8026ca1de39216e87">SwitchContext</a>(next);</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;}</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;</div><div class="line"><a name="l00481"></a><span class="lineno"><a class="line" href="class_kernel_1_1_thread.html#a9984001281eb73a5491a03ee64fa0bd6">  481</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_kernel_1_1_thread.html#a9984001281eb73a5491a03ee64fa0bd6">Thread::SetWaitSynchronizationResult</a>(<a class="code" href="union_result_code.html">ResultCode</a> result) {</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <a class="code" href="class_kernel_1_1_thread.html#ad951569c330a60c2f62e465800ebcb47">context</a>-&gt;SetCpuRegister(0, result.<a class="code" href="union_result_code.html#ac2f3fa949e4d5a894cc7bb1698e8506f">raw</a>);</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;}</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;</div><div class="line"><a name="l00485"></a><span class="lineno"><a class="line" href="class_kernel_1_1_thread.html#a6250be36caf094fb747836d59e45fb55">  485</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_kernel_1_1_thread.html#a6250be36caf094fb747836d59e45fb55">Thread::SetWaitSynchronizationOutput</a>(<a class="code" href="common__types_8h.html#ab0b052f6ae930a8319bef4c5760f72c0">s32</a> output) {</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <a class="code" href="class_kernel_1_1_thread.html#ad951569c330a60c2f62e465800ebcb47">context</a>-&gt;SetCpuRegister(1, output);</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;}</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;</div><div class="line"><a name="l00489"></a><span class="lineno"><a class="line" href="class_kernel_1_1_thread.html#afc096d222a1be1ae47edf791d3425e22">  489</a></span>&#160;<a class="code" href="common__types_8h.html#ab0b052f6ae930a8319bef4c5760f72c0">s32</a> <a class="code" href="class_kernel_1_1_thread.html#afc096d222a1be1ae47edf791d3425e22">Thread::GetWaitObjectIndex</a>(<a class="code" href="class_kernel_1_1_wait_object.html">WaitObject</a>* <span class="keywordtype">object</span>)<span class="keyword"> const </span>{</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <a class="code" href="assert_8h.html#a4b432fb3d47e2ca732caf965691a54d7">ASSERT_MSG</a>(!<a class="code" href="class_kernel_1_1_thread.html#a1b16fe65c9f07e069bb8bb97c1ad6689">wait_objects</a>.empty(), <span class="stringliteral">&quot;Thread is not waiting for anything&quot;</span>);</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    <span class="keyword">auto</span> match{std::find(<a class="code" href="class_kernel_1_1_thread.html#a1b16fe65c9f07e069bb8bb97c1ad6689">wait_objects</a>.rbegin(), <a class="code" href="class_kernel_1_1_thread.html#a1b16fe65c9f07e069bb8bb97c1ad6689">wait_objects</a>.rend(), object)};</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span><a class="code" href="common__types_8h.html#ab0b052f6ae930a8319bef4c5760f72c0">s32</a><span class="keyword">&gt;</span>(std::distance(match, <a class="code" href="class_kernel_1_1_thread.html#a1b16fe65c9f07e069bb8bb97c1ad6689">wait_objects</a>.rend()) - 1);</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;}</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;</div><div class="line"><a name="l00495"></a><span class="lineno"><a class="line" href="class_kernel_1_1_thread.html#a9e9f309142a6fc6a67a68900be435d42">  495</a></span>&#160;<a class="code" href="common__types_8h.html#ace342d87f62470edf84b7593d7dc8b27">VAddr</a> <a class="code" href="class_kernel_1_1_thread.html#a9e9f309142a6fc6a67a68900be435d42">Thread::GetCommandBufferAddress</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <span class="comment">// Offset from the start of TLS at which the IPC command buffer begins.</span></div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <span class="keyword">static</span> constexpr <span class="keywordtype">int</span> CommandHeaderOffset{0x80};</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="class_kernel_1_1_thread.html#aba14d687d899ff02d80be171232001ca">GetTLSAddress</a>() + CommandHeaderOffset;</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;}</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;</div><div class="line"><a name="l00503"></a><span class="lineno"><a class="line" href="namespace_kernel.html#a268aae86c41ad158e2ce656cd2ca36af">  503</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespace_kernel.html#a268aae86c41ad158e2ce656cd2ca36af">ThreadingInit</a>() {</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    <a class="code" href="namespace_kernel.html#ada81dec7407585e67527a2748902b829">ThreadWakeupEventType</a> = <a class="code" href="namespace_core_timing.html#ab4899206b9bc7858155c3a47cb9bce6e">CoreTiming::RegisterEvent</a>(<span class="stringliteral">&quot;ThreadWakeupCallback&quot;</span>, <a class="code" href="namespace_kernel.html#aae441b6285ab4907e8fe87cc0e8297bf">ThreadWakeupCallback</a>);</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    current_thread = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    next_thread_id = 1;</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;}</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;</div><div class="line"><a name="l00510"></a><span class="lineno"><a class="line" href="namespace_kernel.html#afb064e9aa4fac4a8c2540f009c878746">  510</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespace_kernel.html#afb064e9aa4fac4a8c2540f009c878746">ThreadingShutdown</a>() {</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    current_thread = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; t : thread_list) {</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;        t-&gt;Stop();</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    }</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    thread_list.clear();</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    ready_queue.<a class="code" href="struct_common_1_1_thread_queue_list.html#aa06dc7e00d6a7912847ce3db9c4d50ab">clear</a>();</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    <a class="code" href="namespace_kernel.html#a3b47eb55cabbb2b04953d5b9a7f37dac">ClearProcessList</a>();</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;}</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;</div><div class="line"><a name="l00521"></a><span class="lineno"><a class="line" href="namespace_kernel.html#a9f631a85725bcba76d420c422e4f28db">  521</a></span>&#160;<span class="keyword">const</span> std::vector&lt;SharedPtr&lt;Thread&gt;&gt;&amp; <a class="code" href="namespace_kernel.html#a9f631a85725bcba76d420c422e4f28db">GetThreadList</a>() {</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespace_kernel.html#ad00267a61de98b3d9ea70e2edc015443">thread_list</a>;</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;}</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;} <span class="comment">// namespace Kernel</span></div><div class="ttc" id="core_2cpu_2common_8h_html_a354c6f419d1ad4d8924c5a0858ed72bc"><div class="ttname"><a href="core_2cpu_2common_8h.html#a354c6f419d1ad4d8924c5a0858ed72bc">FPSCR_ROUND_TOZERO</a></div><div class="ttdeci">#define FPSCR_ROUND_TOZERO</div><div class="ttdef"><b>Definition:</b> <a href="core_2cpu_2common_8h_source.html#l00013">common.h:13</a></div></div>
<div class="ttc" id="class_kernel_1_1_thread_html_a898ba548b1c136e5cd15f8e1060f59ca"><div class="ttname"><a href="class_kernel_1_1_thread.html#a898ba548b1c136e5cd15f8e1060f59ca">Kernel::Thread::Acquire</a></div><div class="ttdeci">void Acquire(Thread *thread) override</div><div class="ttdoc">Acquire/lock the object for the specified thread if it is available. </div><div class="ttdef"><b>Definition:</b> <a href="thread_8cpp_source.html#l00036">thread.cpp:36</a></div></div>
<div class="ttc" id="log_8h_html_ae9fb9e5f54be61c473be717ec6e71298"><div class="ttname"><a href="log_8h.html#ae9fb9e5f54be61c473be717ec6e71298">LOG_TRACE</a></div><div class="ttdeci">#define LOG_TRACE(log_class, fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="log_8h_source.html#l00124">log.h:124</a></div></div>
<div class="ttc" id="class_kernel_1_1_thread_html_a00f5958b3c1f24db6d11b593d6e31ad2"><div class="ttname"><a href="class_kernel_1_1_thread.html#a00f5958b3c1f24db6d11b593d6e31ad2">Kernel::Thread::Create</a></div><div class="ttdeci">static ResultVal&lt; SharedPtr&lt; Thread &gt; &gt; Create(std::string name, VAddr entry_point, u32 priority, u32 arg, s32 processor_id, VAddr stack_top, SharedPtr&lt; Process &gt; owner_process)</div><div class="ttdoc">Creates and returns a new thread. </div><div class="ttdef"><b>Definition:</b> <a href="thread_8cpp_source.html#l00322">thread.cpp:322</a></div></div>
<div class="ttc" id="namespace_kernel_html_a846e3fb350cf464f33d53d965525e3b7"><div class="ttname"><a href="namespace_kernel.html#a846e3fb350cf464f33d53d965525e3b7">Kernel::ReleaseThreadMutexes</a></div><div class="ttdeci">void ReleaseThreadMutexes(Thread *thread)</div><div class="ttdoc">Releases all the mutexes held by the specified thread. </div><div class="ttdef"><b>Definition:</b> <a href="mutex_8cpp_source.html#l00018">mutex.cpp:18</a></div></div>
<div class="ttc" id="namespace_kernel_html_a98690d9f14327bf8026ca1de39216e87"><div class="ttname"><a href="namespace_kernel.html#a98690d9f14327bf8026ca1de39216e87">Kernel::SwitchContext</a></div><div class="ttdeci">static void SwitchContext(Thread *new_thread)</div><div class="ttdoc">Switches the CPU&amp;#39;s active thread context to that of the specified thread. </div><div class="ttdef"><b>Definition:</b> <a href="thread_8cpp_source.html#l00122">thread.cpp:122</a></div></div>
<div class="ttc" id="namespace_kernel_html_a968e7c20e8c0e782055b1f8c53939ce8"><div class="ttname"><a href="namespace_kernel.html#a968e7c20e8c0e782055b1f8c53939ce8">Kernel::ERR_OUT_OF_RANGE</a></div><div class="ttdeci">constexpr ResultCode ERR_OUT_OF_RANGE(ErrorDescription::OutOfRange, ErrorModule::OS, ErrorSummary::InvalidArgument, ErrorLevel::Usage)</div></div>
<div class="ttc" id="memory_8h_html"><div class="ttname"><a href="memory_8h.html">memory.h</a></div></div>
<div class="ttc" id="class_kernel_1_1_wait_object_html_ad510a76d2ef9ecfe8c83d4fb6590c5b4"><div class="ttname"><a href="class_kernel_1_1_wait_object.html#ad510a76d2ef9ecfe8c83d4fb6590c5b4">Kernel::WaitObject::WakeupAllWaitingThreads</a></div><div class="ttdeci">virtual void WakeupAllWaitingThreads()</div><div class="ttdoc">Wake up all threads waiting on this object that can be awoken, in priority order, and set the synchro...</div><div class="ttdef"><b>Definition:</b> <a href="wait__object_8cpp_source.html#l00071">wait_object.cpp:71</a></div></div>
<div class="ttc" id="namespace_kernel_html_a7acc8be3d256fc8599288360bd57342a"><div class="ttname"><a href="namespace_kernel.html#a7acc8be3d256fc8599288360bd57342a">Kernel::wakeup_callback_handle_table</a></div><div class="ttdeci">static Kernel::HandleTable wakeup_callback_handle_table</div><div class="ttdef"><b>Definition:</b> <a href="thread_8cpp_source.html#l00042">thread.cpp:42</a></div></div>
<div class="ttc" id="class_result_val_html"><div class="ttname"><a href="class_result_val.html">ResultVal</a></div><div class="ttdoc">This is an optional value type. </div><div class="ttdef"><b>Definition:</b> <a href="result_8h_source.html#l00285">result.h:285</a></div></div>
<div class="ttc" id="class_kernel_1_1_thread_html_a4ff2955fd517f4e727e1335d6db55073"><div class="ttname"><a href="class_kernel_1_1_thread.html#a4ff2955fd517f4e727e1335d6db55073">Kernel::Thread::UpdatePriority</a></div><div class="ttdeci">void UpdatePriority()</div><div class="ttdoc">Boost&amp;#39;s a thread&amp;#39;s priority to the best priority among the thread&amp;#39;s held mutexes. ...</div><div class="ttdef"><b>Definition:</b> <a href="thread_8cpp_source.html#l00427">thread.cpp:427</a></div></div>
<div class="ttc" id="class_kernel_1_1_handle_table_html_a1f8903aec8da59b47d359239430de93d"><div class="ttname"><a href="class_kernel_1_1_handle_table.html#a1f8903aec8da59b47d359239430de93d">Kernel::HandleTable::Close</a></div><div class="ttdeci">ResultCode Close(Handle handle)</div><div class="ttdoc">Closes a handle, removing it from the table and decreasing the object&amp;#39;s ref-count. </div><div class="ttdef"><b>Definition:</b> <a href="handle__table_8cpp_source.html#l00055">handle_table.cpp:55</a></div></div>
<div class="ttc" id="class_kernel_1_1_object_html_a9df364a9204a4b3cb27ae2b48982568f"><div class="ttname"><a href="class_kernel_1_1_object.html#a9df364a9204a4b3cb27ae2b48982568f">Kernel::Object::GetObjectId</a></div><div class="ttdeci">u32 GetObjectId() const</div><div class="ttdoc">Returns a unique identifier for the object. For debugging purposes only. </div><div class="ttdef"><b>Definition:</b> <a href="object_8h_source.html#l00052">object.h:52</a></div></div>
<div class="ttc" id="namespace_kernel_html_a872b8e406b9e61b70516126556653b39"><div class="ttname"><a href="namespace_kernel.html#a872b8e406b9e61b70516126556653b39">Kernel::ready_queue</a></div><div class="ttdeci">static Common::ThreadQueueList&lt; Thread *, THREADPRIO_LOWEST+1 &gt; ready_queue</div><div class="ttdef"><b>Definition:</b> <a href="thread_8cpp_source.html#l00048">thread.cpp:48</a></div></div>
<div class="ttc" id="class_kernel_1_1_thread_html_aba14d687d899ff02d80be171232001ca"><div class="ttname"><a href="class_kernel_1_1_thread.html#aba14d687d899ff02d80be171232001ca">Kernel::Thread::GetTLSAddress</a></div><div class="ttdeci">VAddr GetTLSAddress() const</div><div class="ttdef"><b>Definition:</b> <a href="thread_8h_source.html#l00166">thread.h:166</a></div></div>
<div class="ttc" id="namespace_kernel_html_a3cbf9bdd4932714dc3f3f9627bb3338f"><div class="ttname"><a href="namespace_kernel.html#a3cbf9bdd4932714dc3f3f9627bb3338f">Kernel::current_thread</a></div><div class="ttdeci">static SharedPtr&lt; Thread &gt; current_thread</div><div class="ttdef"><b>Definition:</b> <a href="thread_8cpp_source.html#l00050">thread.cpp:50</a></div></div>
<div class="ttc" id="thread_8h_html_ae2739961013a00cede621d4d72f2173ca77ebc88c857506e20c820efcd24903fb"><div class="ttname"><a href="thread_8h.html#ae2739961013a00cede621d4d72f2173ca77ebc88c857506e20c820efcd24903fb">THREADSTATUS_RUNNING</a></div><div class="ttdoc">Currently running. </div><div class="ttdef"><b>Definition:</b> <a href="thread_8h_source.html#l00035">thread.h:35</a></div></div>
<div class="ttc" id="class_kernel_1_1_handle_table_html_a49b9a4eb348b1528afac22d7fdd34a3a"><div class="ttname"><a href="class_kernel_1_1_handle_table.html#a49b9a4eb348b1528afac22d7fdd34a3a">Kernel::HandleTable::Get</a></div><div class="ttdeci">SharedPtr&lt; T &gt; Get(Handle handle) const</div><div class="ttdoc">Looks up a handle while verifying its type. </div><div class="ttdef"><b>Definition:</b> <a href="handle__table_8h_source.html#l00084">handle_table.h:84</a></div></div>
<div class="ttc" id="thread__queue__list_8h_html"><div class="ttname"><a href="thread__queue__list_8h.html">thread_queue_list.h</a></div></div>
<div class="ttc" id="class_kernel_1_1_thread_html_aa36c37078e343a0681974bf0077fd3ab"><div class="ttname"><a href="class_kernel_1_1_thread.html#aa36c37078e343a0681974bf0077fd3ab">Kernel::Thread::status</a></div><div class="ttdeci">u32 status</div><div class="ttdef"><b>Definition:</b> <a href="thread_8h_source.html#l00189">thread.h:189</a></div></div>
<div class="ttc" id="kernel_8h_html"><div class="ttname"><a href="kernel_8h.html">kernel.h</a></div></div>
<div class="ttc" id="thread_8h_html_ae2739961013a00cede621d4d72f2173ca45bf95b1b887bdba9b3e24b98cc814ee"><div class="ttname"><a href="thread_8h.html#ae2739961013a00cede621d4d72f2173ca45bf95b1b887bdba9b3e24b98cc814ee">THREADSTATUS_DEAD</a></div><div class="ttdoc">Run to completion, or forcefully terminated. </div><div class="ttdef"><b>Definition:</b> <a href="thread_8h_source.html#l00044">thread.h:44</a></div></div>
<div class="ttc" id="namespace_kernel_html_afc9bde79933dd23864df0768adeb6cfe"><div class="ttname"><a href="namespace_kernel.html#afc9bde79933dd23864df0768adeb6cfe">Kernel::SharedPtr</a></div><div class="ttdeci">boost::intrusive_ptr&lt; T &gt; SharedPtr</div><div class="ttdef"><b>Definition:</b> <a href="object_8h_source.html#l00093">object.h:93</a></div></div>
<div class="ttc" id="namespace_memory_html_a41fd7618a06f2e2d24eebe866db68d7d"><div class="ttname"><a href="namespace_memory.html#a41fd7618a06f2e2d24eebe866db68d7d">Memory::PAGE_SIZE</a></div><div class="ttdeci">const u32 PAGE_SIZE</div><div class="ttdoc">Page size used by the ARM architecture. </div><div class="ttdef"><b>Definition:</b> <a href="memory_8h_source.html#l00025">memory.h:25</a></div></div>
<div class="ttc" id="struct_common_1_1_thread_queue_list_html_a5babf831bd7a32cd0e59f4305fb22e14"><div class="ttname"><a href="struct_common_1_1_thread_queue_list.html#a5babf831bd7a32cd0e59f4305fb22e14">Common::ThreadQueueList::push_back</a></div><div class="ttdeci">void push_back(Priority priority, const T &amp;thread_id)</div><div class="ttdef"><b>Definition:</b> <a href="thread__queue__list_8h_source.html#l00086">thread_queue_list.h:86</a></div></div>
<div class="ttc" id="thread_8h_html_ae2739961013a00cede621d4d72f2173ca000e025c8cf9041da85d0dabc19ad777"><div class="ttname"><a href="thread_8h.html#ae2739961013a00cede621d4d72f2173ca000e025c8cf9041da85d0dabc19ad777">THREADSTATUS_WAIT_SYNCH_ALL</a></div><div class="ttdoc">Waiting due to WaitSynchronizationN with wait_all = true. </div><div class="ttdef"><b>Definition:</b> <a href="thread_8h_source.html#l00041">thread.h:41</a></div></div>
<div class="ttc" id="class_kernel_1_1_thread_html_af23eac6fd1b937083b79739204c2a833"><div class="ttname"><a href="class_kernel_1_1_thread.html#af23eac6fd1b937083b79739204c2a833">Kernel::Thread::BoostPriority</a></div><div class="ttdeci">void BoostPriority(u32 priority)</div><div class="ttdoc">Temporarily boosts the thread&amp;#39;s priority until the next time it is scheduled. </div><div class="ttdef"><b>Definition:</b> <a href="thread_8cpp_source.html#l00436">thread.cpp:436</a></div></div>
<div class="ttc" id="log_8h_html_a2f872ec42bda0e5baf8783313a28494c"><div class="ttname"><a href="log_8h.html#a2f872ec42bda0e5baf8783313a28494c">LOG_ERROR</a></div><div class="ttdeci">#define LOG_ERROR(log_class,...)</div><div class="ttdef"><b>Definition:</b> <a href="log_8h_source.html#l00136">log.h:136</a></div></div>
<div class="ttc" id="thread_8h_html_ae2739961013a00cede621d4d72f2173ca5f6e947e083848f5976cfc321bb74b01"><div class="ttname"><a href="thread_8h.html#ae2739961013a00cede621d4d72f2173ca5f6e947e083848f5976cfc321bb74b01">THREADSTATUS_WAIT_IPC</a></div><div class="ttdoc">Waiting for the reply from an IPC request. </div><div class="ttdef"><b>Definition:</b> <a href="thread_8h_source.html#l00039">thread.h:39</a></div></div>
<div class="ttc" id="namespace_core_html_a451d67b62d548c4f3ee8363056ad97e7"><div class="ttname"><a href="namespace_core.html#a451d67b62d548c4f3ee8363056ad97e7">Core::GetCPU</a></div><div class="ttdeci">CPU &amp; GetCPU()</div><div class="ttdef"><b>Definition:</b> <a href="core_8h_source.html#l00248">core.h:248</a></div></div>
<div class="ttc" id="namespace_kernel_html"><div class="ttname"><a href="namespace_kernel.html">Kernel</a></div><div class="ttdef"><b>Definition:</b> <a href="ipc_8h_source.html#l00012">ipc.h:12</a></div></div>
<div class="ttc" id="namespace_kernel_html_ac98ea407adc130ee57ae39f4d65337d8a47f9082fc380ca62d531096aa1d110f1"><div class="ttname"><a href="namespace_kernel.html#ac98ea407adc130ee57ae39f4d65337d8a47f9082fc380ca62d531096aa1d110f1">Kernel::MemoryState::Private</a></div></div>
<div class="ttc" id="core__timing_8h_html_ae07683b2295c7762ef165931412ab10d"><div class="ttname"><a href="core__timing_8h.html#ae07683b2295c7762ef165931412ab10d">nsToCycles</a></div><div class="ttdeci">s64 nsToCycles(float ns)</div><div class="ttdef"><b>Definition:</b> <a href="core__timing_8h_source.html#l00078">core_timing.h:78</a></div></div>
<div class="ttc" id="namespace_kernel_html_a98a6cc20503acf96fbfa25e9acf53178"><div class="ttname"><a href="namespace_kernel.html#a98a6cc20503acf96fbfa25e9acf53178">Kernel::HaveReadyThreads</a></div><div class="ttdeci">bool HaveReadyThreads()</div><div class="ttdoc">Returns whether there are any threads that are ready to run. </div><div class="ttdef"><b>Definition:</b> <a href="thread_8cpp_source.html#l00459">thread.cpp:459</a></div></div>
<div class="ttc" id="namespace_kernel_html_ad00267a61de98b3d9ea70e2edc015443"><div class="ttname"><a href="namespace_kernel.html#ad00267a61de98b3d9ea70e2edc015443">Kernel::thread_list</a></div><div class="ttdeci">static std::vector&lt; SharedPtr&lt; Thread &gt; &gt; thread_list</div><div class="ttdef"><b>Definition:</b> <a href="thread_8cpp_source.html#l00045">thread.cpp:45</a></div></div>
<div class="ttc" id="namespace_core_timing_html_a9e1678c03397fd456975cc4060f6feab"><div class="ttname"><a href="namespace_core_timing.html#a9e1678c03397fd456975cc4060f6feab">CoreTiming::ScheduleEvent</a></div><div class="ttdeci">void ScheduleEvent(s64 cycles_into_future, const EventType *event_type, u64 userdata)</div><div class="ttdoc">After the first Advance, the slice lengths and the downcount will be reduced whenever an event is sch...</div><div class="ttdef"><b>Definition:</b> <a href="core__timing_8cpp_source.html#l00135">core_timing.cpp:135</a></div></div>
<div class="ttc" id="core_8h_html"><div class="ttname"><a href="core_8h.html">core.h</a></div></div>
<div class="ttc" id="class_kernel_1_1_thread_html_afc1eccdba24dd9c1405d0c79acafb76c"><div class="ttname"><a href="class_kernel_1_1_thread.html#afc1eccdba24dd9c1405d0c79acafb76c">Kernel::Thread::Stop</a></div><div class="ttdeci">void Stop()</div><div class="ttdoc">Stops a thread, invalidating it from further use. </div><div class="ttdef"><b>Definition:</b> <a href="thread_8cpp_source.html#l00070">thread.cpp:70</a></div></div>
<div class="ttc" id="namespace_core_timing_html_ab4899206b9bc7858155c3a47cb9bce6e"><div class="ttname"><a href="namespace_core_timing.html#ab4899206b9bc7858155c3a47cb9bce6e">CoreTiming::RegisterEvent</a></div><div class="ttdeci">EventType * RegisterEvent(const std::string &amp;name, TimedCallback callback)</div><div class="ttdoc">Returns the event_type identifier. </div><div class="ttdef"><b>Definition:</b> <a href="core__timing_8cpp_source.html#l00072">core_timing.cpp:72</a></div></div>
<div class="ttc" id="namespace_kernel_html_a9acd1f517f5c78daa3d519fd31b48796"><div class="ttname"><a href="namespace_kernel.html#a9acd1f517f5c78daa3d519fd31b48796">Kernel::NewThreadId</a></div><div class="ttdeci">static u32 const NewThreadId()</div><div class="ttdoc">Creates a new thread ID. </div><div class="ttdef"><b>Definition:</b> <a href="thread_8cpp_source.html#l00059">thread.cpp:59</a></div></div>
<div class="ttc" id="hle_2kernel_2errors_8h_html"><div class="ttname"><a href="hle_2kernel_2errors_8h.html">errors.h</a></div></div>
<div class="ttc" id="namespace_kernel_html_ada81dec7407585e67527a2748902b829"><div class="ttname"><a href="namespace_kernel.html#ada81dec7407585e67527a2748902b829">Kernel::ThreadWakeupEventType</a></div><div class="ttdeci">static CoreTiming::EventType * ThreadWakeupEventType</div><div class="ttdoc">Event type for the thread wake up event. </div><div class="ttdef"><b>Definition:</b> <a href="thread_8cpp_source.html#l00030">thread.cpp:30</a></div></div>
<div class="ttc" id="class_core_1_1_system_html_acc138e43b0c06bf63a0429f1d062bfc4"><div class="ttname"><a href="class_core_1_1_system.html#acc138e43b0c06bf63a0429f1d062bfc4">Core::System::PrepareReschedule</a></div><div class="ttdeci">void PrepareReschedule()</div><div class="ttdoc">Prepare the core emulation for a reschedule. </div><div class="ttdef"><b>Definition:</b> <a href="core_8cpp_source.html#l00128">core.cpp:128</a></div></div>
<div class="ttc" id="namespace_memory_html_a0abdbb4b878710f67db886fba7a802ffa820834c3a77024ad4188433682366051"><div class="ttname"><a href="namespace_memory.html#a0abdbb4b878710f67db886fba7a802ffa820834c3a77024ad4188433682366051">Memory::TLS_ENTRY_SIZE</a></div><div class="ttdef"><b>Definition:</b> <a href="memory_8h_source.html#l00171">memory.h:171</a></div></div>
<div class="ttc" id="class_kernel_1_1_thread_html_a6394962e85e59b1a25a8f156ff09ecda"><div class="ttname"><a href="class_kernel_1_1_thread.html#a6394962e85e59b1a25a8f156ff09ecda">Kernel::Thread::SetPriority</a></div><div class="ttdeci">void SetPriority(u32 priority)</div><div class="ttdoc">Sets the thread&amp;#39;s current priority. </div><div class="ttdef"><b>Definition:</b> <a href="thread_8cpp_source.html#l00415">thread.cpp:415</a></div></div>
<div class="ttc" id="hle_2kernel_2memory_8h_html"><div class="ttname"><a href="hle_2kernel_2memory_8h.html">memory.h</a></div></div>
<div class="ttc" id="namespace_core_timing_html_struct_core_timing_1_1_event_type"><div class="ttname"><a href="namespace_core_timing.html#struct_core_timing_1_1_event_type">CoreTiming::EventType</a></div><div class="ttdef"><b>Definition:</b> <a href="core__timing_8cpp_source.html#l00024">core_timing.cpp:24</a></div></div>
<div class="ttc" id="class_c_p_u_html_a5d448f8d0b9d55ab9cf05f9344de263b"><div class="ttname"><a href="class_c_p_u.html#a5d448f8d0b9d55ab9cf05f9344de263b">CPU::SetCP15Register</a></div><div class="ttdeci">void SetCP15Register(CP15Register reg, u32 value)</div><div class="ttdef"><b>Definition:</b> <a href="cpu_8cpp_source.html#l00183">cpu.cpp:183</a></div></div>
<div class="ttc" id="core_2cpu_2common_8h_html_ae0086b74dce0fe464bcd2f56b61ade12"><div class="ttname"><a href="core_2cpu_2common_8h.html#ae0086b74dce0fe464bcd2f56b61ade12">FPSCR_IXC</a></div><div class="ttdeci">#define FPSCR_IXC</div><div class="ttdef"><b>Definition:</b> <a href="core_2cpu_2common_8h_source.html#l00014">common.h:14</a></div></div>
<div class="ttc" id="struct_common_1_1_thread_queue_list_html_a01bf13601adfb673b79f8f6202652acb"><div class="ttname"><a href="struct_common_1_1_thread_queue_list.html#a01bf13601adfb673b79f8f6202652acb">Common::ThreadQueueList::push_front</a></div><div class="ttdeci">void push_front(Priority priority, const T &amp;thread_id)</div><div class="ttdef"><b>Definition:</b> <a href="thread__queue__list_8h_source.html#l00081">thread_queue_list.h:81</a></div></div>
<div class="ttc" id="namespace_kernel_html_aee28364411c4e2f2ce57323277907440ae7b1a5c82772e0e055096008cb9883ef"><div class="ttname"><a href="namespace_kernel.html#aee28364411c4e2f2ce57323277907440ae7b1a5c82772e0e055096008cb9883ef">Kernel::MemoryRegion::BASE</a></div></div>
<div class="ttc" id="class_kernel_1_1_thread_html_a5f600013306821c2e8e319432b5a14c5"><div class="ttname"><a href="class_kernel_1_1_thread.html#a5f600013306821c2e8e319432b5a14c5">Kernel::Thread::held_mutexes</a></div><div class="ttdeci">boost::container::flat_set&lt; SharedPtr&lt; Mutex &gt; &gt; held_mutexes</div><div class="ttdoc">Mutexes currently held by this thread, which will be released when it exits. </div><div class="ttdef"><b>Definition:</b> <a href="thread_8h_source.html#l00203">thread.h:203</a></div></div>
<div class="ttc" id="class_kernel_1_1_thread_html_a6c6cf033699fdc311f5b89132facf339"><div class="ttname"><a href="class_kernel_1_1_thread.html#a6c6cf033699fdc311f5b89132facf339">Kernel::Thread::owner_process</a></div><div class="ttdeci">SharedPtr&lt; Process &gt; owner_process</div><div class="ttdoc">Process that owns this thread. </div><div class="ttdef"><b>Definition:</b> <a href="thread_8h_source.html#l00208">thread.h:208</a></div></div>
<div class="ttc" id="namespace_memory_html_a0abdbb4b878710f67db886fba7a802ffabfd5b3d456d510e70be2afb6a4da1316"><div class="ttname"><a href="namespace_memory.html#a0abdbb4b878710f67db886fba7a802ffabfd5b3d456d510e70be2afb6a4da1316">Memory::HEAP_VADDR_END</a></div><div class="ttdef"><b>Definition:</b> <a href="memory_8h_source.html#l00130">memory.h:130</a></div></div>
<div class="ttc" id="result_8h_html_afe30fc4506a4cf2ee780b2319dbec74da66196dd9678aef4aaad947e7181049c0"><div class="ttname"><a href="result_8h.html#afe30fc4506a4cf2ee780b2319dbec74da66196dd9678aef4aaad947e7181049c0">ErrorDescription::InvalidAddress</a></div></div>
<div class="ttc" id="class_kernel_1_1_handle_table_html"><div class="ttname"><a href="class_kernel_1_1_handle_table.html">Kernel::HandleTable</a></div><div class="ttdoc">This class allows the creation of Handles, which are references to objects that can be tested for val...</div><div class="ttdef"><b>Definition:</b> <a href="handle__table_8h_source.html#l00043">handle_table.h:43</a></div></div>
<div class="ttc" id="common__types_8h_html_ab0b052f6ae930a8319bef4c5760f72c0"><div class="ttname"><a href="common__types_8h.html#ab0b052f6ae930a8319bef4c5760f72c0">s32</a></div><div class="ttdeci">std::int32_t s32</div><div class="ttdoc">32-bit signed word </div><div class="ttdef"><b>Definition:</b> <a href="common__types_8h_source.html#l00042">common_types.h:42</a></div></div>
<div class="ttc" id="thread_8h_html_ae2739961013a00cede621d4d72f2173cadf17bd50b28528532f3db84ba9eae228"><div class="ttname"><a href="thread_8h.html#ae2739961013a00cede621d4d72f2173cadf17bd50b28528532f3db84ba9eae228">THREADSTATUS_READY</a></div><div class="ttdoc">Ready to run. </div><div class="ttdef"><b>Definition:</b> <a href="thread_8h_source.html#l00036">thread.h:36</a></div></div>
<div class="ttc" id="common__types_8h_html_a35714c97d4ec315cb8c6e79d7b2a1cbc"><div class="ttname"><a href="common__types_8h.html#a35714c97d4ec315cb8c6e79d7b2a1cbc">s64</a></div><div class="ttdeci">std::int64_t s64</div><div class="ttdoc">64-bit signed int </div><div class="ttdef"><b>Definition:</b> <a href="common__types_8h_source.html#l00043">common_types.h:43</a></div></div>
<div class="ttc" id="common__types_8h_html"><div class="ttname"><a href="common__types_8h.html">common_types.h</a></div><div class="ttdoc">Copyright (C) 2005-2012 Gekko Emulator. </div></div>
<div class="ttc" id="log_8h_html_a51fb52bb5a30e10d1eff3cc23c71d747"><div class="ttname"><a href="log_8h.html#a51fb52bb5a30e10d1eff3cc23c71d747">LOG_CRITICAL</a></div><div class="ttdeci">#define LOG_CRITICAL(log_class,...)</div><div class="ttdef"><b>Definition:</b> <a href="log_8h_source.html#l00139">log.h:139</a></div></div>
<div class="ttc" id="thread_8h_html"><div class="ttname"><a href="thread_8h.html">thread.h</a></div></div>
<div class="ttc" id="assert_8h_html_a4b432fb3d47e2ca732caf965691a54d7"><div class="ttname"><a href="assert_8h.html#a4b432fb3d47e2ca732caf965691a54d7">ASSERT_MSG</a></div><div class="ttdeci">#define ASSERT_MSG(_a_,...)</div><div class="ttdef"><b>Definition:</b> <a href="assert_8h_source.html#l00037">assert.h:37</a></div></div>
<div class="ttc" id="result_8h_html"><div class="ttname"><a href="result_8h.html">result.h</a></div></div>
<div class="ttc" id="struct_common_1_1_thread_queue_list_html_a818ceae82b99dac25e93c72958c6118b"><div class="ttname"><a href="struct_common_1_1_thread_queue_list.html#a818ceae82b99dac25e93c72958c6118b">Common::ThreadQueueList::prepare</a></div><div class="ttdeci">void prepare(Priority priority)</div><div class="ttdef"><b>Definition:</b> <a href="thread__queue__list_8h_source.html#l00121">thread_queue_list.h:121</a></div></div>
<div class="ttc" id="assert_8h_html"><div class="ttname"><a href="assert_8h.html">assert.h</a></div></div>
<div class="ttc" id="common__types_8h_html_ace342d87f62470edf84b7593d7dc8b27"><div class="ttname"><a href="common__types_8h.html#ace342d87f62470edf84b7593d7dc8b27">VAddr</a></div><div class="ttdeci">u32 VAddr</div><div class="ttdoc">Represents a pointer in the userspace virtual address space. </div><div class="ttdef"><b>Definition:</b> <a href="common__types_8h_source.html#l00049">common_types.h:49</a></div></div>
<div class="ttc" id="result_8h_html_aa3b9056eb03ec4e7c3561192eb830739a23adaa457573eeb089c33214c90d3013"><div class="ttname"><a href="result_8h.html#aa3b9056eb03ec4e7c3561192eb830739a23adaa457573eeb089c33214c90d3013">ErrorLevel::Permanent</a></div></div>
<div class="ttc" id="class_c_p_u_html_a730fc0cc09c3a47eb93cf8ec667ae70a"><div class="ttname"><a href="class_c_p_u.html#a730fc0cc09c3a47eb93cf8ec667ae70a">CPU::SaveContext</a></div><div class="ttdeci">void SaveContext(const std::unique_ptr&lt; ThreadContext &gt; &amp;arg)</div><div class="ttdef"><b>Definition:</b> <a href="cpu_8cpp_source.html#l00191">cpu.cpp:191</a></div></div>
<div class="ttc" id="namespace_kernel_html_ac7460d5f540b785aea634c73c5430acd"><div class="ttname"><a href="namespace_kernel.html#ac7460d5f540b785aea634c73c5430acd">Kernel::g_current_process</a></div><div class="ttdeci">SharedPtr&lt; Process &gt; g_current_process</div><div class="ttdef"><b>Definition:</b> <a href="process_8cpp_source.html#l00333">process.cpp:333</a></div></div>
<div class="ttc" id="namespace_kernel_html_ab6ce89d727d7323f89dbab10c23a9c37"><div class="ttname"><a href="namespace_kernel.html#ab6ce89d727d7323f89dbab10c23a9c37">Kernel::ERR_OUT_OF_MEMORY</a></div><div class="ttdeci">constexpr ResultCode ERR_OUT_OF_MEMORY(ErrorDescription::OutOfMemory, ErrorModule::Kernel, ErrorSummary::OutOfResource, ErrorLevel::Permanent)</div></div>
<div class="ttc" id="namespace_kernel_html_add0758203dd366887f2b1de7de1e2f3f"><div class="ttname"><a href="namespace_kernel.html#add0758203dd366887f2b1de7de1e2f3f">Kernel::ResetThreadContext</a></div><div class="ttdeci">static void ResetThreadContext(const std::unique_ptr&lt; ThreadContext &gt; &amp;context, u32 stack_top, u32 entry_point, u32 arg)</div><div class="ttdoc">Resets a thread context, making it ready to be scheduled and run by the CPU. </div><div class="ttdef"><b>Definition:</b> <a href="thread_8cpp_source.html#l00313">thread.cpp:313</a></div></div>
<div class="ttc" id="struct_common_1_1_thread_queue_list_html_ab2944a061ab6c46698c8be50d5579146"><div class="ttname"><a href="struct_common_1_1_thread_queue_list.html#ab2944a061ab6c46698c8be50d5579146">Common::ThreadQueueList::pop_first</a></div><div class="ttdeci">T pop_first()</div><div class="ttdef"><b>Definition:</b> <a href="thread__queue__list_8h_source.html#l00052">thread_queue_list.h:52</a></div></div>
<div class="ttc" id="core_2cpu_2common_8h_html_ae8e14720547949c44161179b028b4f62a710e3130568ad2b5fc34d57dfa1d4efe"><div class="ttname"><a href="core_2cpu_2common_8h.html#ae8e14720547949c44161179b028b4f62a710e3130568ad2b5fc34d57dfa1d4efe">CP15_THREAD_URO</a></div><div class="ttdef"><b>Definition:</b> <a href="core_2cpu_2common_8h_source.html#l00026">common.h:26</a></div></div>
<div class="ttc" id="thread_8h_html_a36bd654753f9fb7e2b269831f4e6ad80ac85a251cc457840f1e032f1b733e9398"><div class="ttname"><a href="thread_8h.html#a36bd654753f9fb7e2b269831f4e6ad80ac85a251cc457840f1e032f1b733e9398">ThreadWakeupReason::Timeout</a></div></div>
<div class="ttc" id="namespace_kernel_html_a21df05cea2994e37c48d7ca896f0dce3"><div class="ttname"><a href="namespace_kernel.html#a21df05cea2994e37c48d7ca896f0dce3">Kernel::ExitCurrentThread</a></div><div class="ttdeci">void ExitCurrentThread()</div><div class="ttdoc">Stops the current thread and removes it from the thread_list. </div><div class="ttdef"><b>Definition:</b> <a href="thread_8cpp_source.html#l00198">thread.cpp:198</a></div></div>
<div class="ttc" id="class_kernel_1_1_thread_html_ae4de32cafc24def63c2e1da27ad0dd39"><div class="ttname"><a href="class_kernel_1_1_thread.html#ae4de32cafc24def63c2e1da27ad0dd39">Kernel::Thread::WakeAfterDelay</a></div><div class="ttdeci">void WakeAfterDelay(s64 nanoseconds)</div><div class="ttdoc">Schedules an event to wake up the specified thread after the specified delay. </div><div class="ttdef"><b>Definition:</b> <a href="thread_8cpp_source.html#l00234">thread.cpp:234</a></div></div>
<div class="ttc" id="common__types_8h_html_a66e1d499241ccae9a18a20a1f4f0590d"><div class="ttname"><a href="common__types_8h.html#a66e1d499241ccae9a18a20a1f4f0590d">u64</a></div><div class="ttdeci">std::uint64_t u64</div><div class="ttdoc">64-bit unsigned int </div><div class="ttdef"><b>Definition:</b> <a href="common__types_8h_source.html#l00038">common_types.h:38</a></div></div>
<div class="ttc" id="struct_common_1_1_thread_queue_list_html_a35811fb17ea0f69d77a8213f0eedf1ae"><div class="ttname"><a href="struct_common_1_1_thread_queue_list.html#a35811fb17ea0f69d77a8213f0eedf1ae">Common::ThreadQueueList::pop_first_better</a></div><div class="ttdeci">T pop_first_better(Priority priority)</div><div class="ttdef"><b>Definition:</b> <a href="thread__queue__list_8h_source.html#l00066">thread_queue_list.h:66</a></div></div>
<div class="ttc" id="thread_8h_html_ae2739961013a00cede621d4d72f2173ca742bfb20eaa72521d7df72464ea20a90"><div class="ttname"><a href="thread_8h.html#ae2739961013a00cede621d4d72f2173ca742bfb20eaa72521d7df72464ea20a90">THREADSTATUS_WAIT_SYNCH_ANY</a></div><div class="ttdoc">Waiting due to WaitSynch1 or WaitSynchN with wait_all = false. </div><div class="ttdef"><b>Definition:</b> <a href="thread_8h_source.html#l00040">thread.h:40</a></div></div>
<div class="ttc" id="namespace_kernel_html_a229a63fa51a0cb8a68e9d265b7afaf32"><div class="ttname"><a href="namespace_kernel.html#a229a63fa51a0cb8a68e9d265b7afaf32">Kernel::next_thread_id</a></div><div class="ttdeci">static u32 next_thread_id</div><div class="ttdef"><b>Definition:</b> <a href="thread_8cpp_source.html#l00053">thread.cpp:53</a></div></div>
<div class="ttc" id="class_kernel_1_1_thread_html_a6e0f27efc7742878543134d50aa0e342"><div class="ttname"><a href="class_kernel_1_1_thread.html#a6e0f27efc7742878543134d50aa0e342">Kernel::Thread::nominal_priority</a></div><div class="ttdeci">u32 nominal_priority</div><div class="ttdoc">Nominal thread priority, as set by the emulated application. </div><div class="ttdef"><b>Definition:</b> <a href="thread_8h_source.html#l00193">thread.h:193</a></div></div>
<div class="ttc" id="class_kernel_1_1_thread_html_afc096d222a1be1ae47edf791d3425e22"><div class="ttname"><a href="class_kernel_1_1_thread.html#afc096d222a1be1ae47edf791d3425e22">Kernel::Thread::GetWaitObjectIndex</a></div><div class="ttdeci">s32 GetWaitObjectIndex(WaitObject *object) const</div><div class="ttdoc">Retrieves the index that this particular object occupies in the list of objects that the thread passe...</div><div class="ttdef"><b>Definition:</b> <a href="thread_8cpp_source.html#l00489">thread.cpp:489</a></div></div>
<div class="ttc" id="handle__table_8h_html"><div class="ttname"><a href="handle__table_8h.html">handle_table.h</a></div></div>
<div class="ttc" id="class_kernel_1_1_thread_html_a1b16fe65c9f07e069bb8bb97c1ad6689"><div class="ttname"><a href="class_kernel_1_1_thread.html#a1b16fe65c9f07e069bb8bb97c1ad6689">Kernel::Thread::wait_objects</a></div><div class="ttdeci">std::vector&lt; SharedPtr&lt; WaitObject &gt; &gt; wait_objects</div><div class="ttdoc">Objects that the thread is waiting on, in the same order as they were. </div><div class="ttdef"><b>Definition:</b> <a href="thread_8h_source.html#l00212">thread.h:212</a></div></div>
<div class="ttc" id="namespace_core_html"><div class="ttname"><a href="namespace_core.html">Core</a></div><div class="ttdef"><b>Definition:</b> <a href="3ds_8h_source.html#l00007">3ds.h:7</a></div></div>
<div class="ttc" id="namespace_core_timing_html_a1d0fc13b562a6c699cdcbfd4ccdfbc10"><div class="ttname"><a href="namespace_core_timing.html#a1d0fc13b562a6c699cdcbfd4ccdfbc10">CoreTiming::UnscheduleEvent</a></div><div class="ttdeci">void UnscheduleEvent(const EventType *event_type, u64 userdata)</div><div class="ttdef"><b>Definition:</b> <a href="core__timing_8cpp_source.html#l00151">core_timing.cpp:151</a></div></div>
<div class="ttc" id="struct_common_1_1_thread_queue_list_html_ad85031b2be281c42ef537553a2fd4510"><div class="ttname"><a href="struct_common_1_1_thread_queue_list.html#ad85031b2be281c42ef537553a2fd4510">Common::ThreadQueueList::remove</a></div><div class="ttdeci">void remove(Priority priority, const T &amp;thread_id)</div><div class="ttdef"><b>Definition:</b> <a href="thread__queue__list_8h_source.html#l00097">thread_queue_list.h:97</a></div></div>
<div class="ttc" id="namespace_kernel_html_a6322f1b0959e8514c58a93ac414f4d5a"><div class="ttname"><a href="namespace_kernel.html#a6322f1b0959e8514c58a93ac414f4d5a">Kernel::GetFreeThreadLocalSlot</a></div><div class="ttdeci">static std::tuple&lt; std::size_t, std::size_t, bool &gt; GetFreeThreadLocalSlot(const std::vector&lt; std::bitset&lt; 8 &gt;&gt; &amp;tls_slots)</div><div class="ttdoc">Finds a free location for the TLS section of a thread. </div><div class="ttdef"><b>Definition:</b> <a href="thread_8cpp_source.html#l00288">thread.cpp:288</a></div></div>
<div class="ttc" id="thread_8h_html_ae2739961013a00cede621d4d72f2173cabe45f2d11eb47a80b9b268f9ea5bc695"><div class="ttname"><a href="thread_8h.html#ae2739961013a00cede621d4d72f2173cabe45f2d11eb47a80b9b268f9ea5bc695">THREADSTATUS_WAIT_ARB</a></div><div class="ttdoc">Waiting on an address arbiter. </div><div class="ttdef"><b>Definition:</b> <a href="thread_8h_source.html#l00037">thread.h:37</a></div></div>
<div class="ttc" id="result_8h_html_a67158ef38e1ab9113151768007433e3aa6ff9f4444ac481652f4412b5e1623846"><div class="ttname"><a href="result_8h.html#a67158ef38e1ab9113151768007433e3aa6ff9f4444ac481652f4412b5e1623846">ErrorModule::Kernel</a></div></div>
<div class="ttc" id="class_c_p_u_html_aefb1b0cec418b7f41b2d88e0c24242de"><div class="ttname"><a href="class_c_p_u.html#aefb1b0cec418b7f41b2d88e0c24242de">CPU::LoadContext</a></div><div class="ttdeci">void LoadContext(const std::unique_ptr&lt; ThreadContext &gt; &amp;arg)</div><div class="ttdef"><b>Definition:</b> <a href="cpu_8cpp_source.html#l00199">cpu.cpp:199</a></div></div>
<div class="ttc" id="class_kernel_1_1_thread_html_aaabeb4aa9725cffaec9c53c36e96eb8e"><div class="ttname"><a href="class_kernel_1_1_thread.html#aaabeb4aa9725cffaec9c53c36e96eb8e">Kernel::Thread::stack_top</a></div><div class="ttdeci">u32 stack_top</div><div class="ttdef"><b>Definition:</b> <a href="thread_8h_source.html#l00191">thread.h:191</a></div></div>
<div class="ttc" id="namespace_kernel_html_struct_kernel_1_1_memory_region_info"><div class="ttname"><a href="namespace_kernel.html#struct_kernel_1_1_memory_region_info">Kernel::MemoryRegionInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="hle_2kernel_2memory_8h_source.html#l00015">memory.h:15</a></div></div>
<div class="ttc" id="class_kernel_1_1_thread_html_a8dae41fac6cb0e98ccf316031cb7bc57"><div class="ttname"><a href="class_kernel_1_1_thread.html#a8dae41fac6cb0e98ccf316031cb7bc57">Kernel::Thread::name</a></div><div class="ttdeci">std::string name</div><div class="ttdef"><b>Definition:</b> <a href="thread_8h_source.html#l00216">thread.h:216</a></div></div>
<div class="ttc" id="namespace_kernel_html_ae91eedd3b1a0322f15235a3fc66a7f35"><div class="ttname"><a href="namespace_kernel.html#ae91eedd3b1a0322f15235a3fc66a7f35">Kernel::MemoryRegionInfo::linear_heap_memory</a></div><div class="ttdeci">std::shared_ptr&lt; std::vector&lt; u8 &gt; &gt; linear_heap_memory</div><div class="ttdef"><b>Definition:</b> <a href="hle_2kernel_2memory_8h_source.html#l00020">memory.h:20</a></div></div>
<div class="ttc" id="process_8h_html"><div class="ttname"><a href="process_8h.html">process.h</a></div></div>
<div class="ttc" id="class_kernel_1_1_thread_html_a6250be36caf094fb747836d59e45fb55"><div class="ttname"><a href="class_kernel_1_1_thread.html#a6250be36caf094fb747836d59e45fb55">Kernel::Thread::SetWaitSynchronizationOutput</a></div><div class="ttdeci">void SetWaitSynchronizationOutput(s32 output)</div><div class="ttdoc">Sets the output parameter value after the thread awakens (from WaitSynchronizationN SVC only) ...</div><div class="ttdef"><b>Definition:</b> <a href="thread_8cpp_source.html#l00485">thread.cpp:485</a></div></div>
<div class="ttc" id="struct_common_1_1_thread_queue_list_html_aa06dc7e00d6a7912847ce3db9c4d50ab"><div class="ttname"><a href="struct_common_1_1_thread_queue_list.html#aa06dc7e00d6a7912847ce3db9c4d50ab">Common::ThreadQueueList::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> <a href="thread__queue__list_8h_source.html#l00111">thread_queue_list.h:111</a></div></div>
<div class="ttc" id="class_kernel_1_1_thread_html_ad951569c330a60c2f62e465800ebcb47"><div class="ttname"><a href="class_kernel_1_1_thread.html#ad951569c330a60c2f62e465800ebcb47">Kernel::Thread::context</a></div><div class="ttdeci">std::unique_ptr&lt; ThreadContext &gt; context</div><div class="ttdef"><b>Definition:</b> <a href="thread_8h_source.html#l00185">thread.h:185</a></div></div>
<div class="ttc" id="namespace_memory_html_a3bf02d5785f2a1e9f6116bbbdcdfb4e7"><div class="ttname"><a href="namespace_memory.html#a3bf02d5785f2a1e9f6116bbbdcdfb4e7">Memory::IsValidVirtualAddress</a></div><div class="ttdeci">bool IsValidVirtualAddress(const Kernel::Process &amp;process, const VAddr vaddr)</div><div class="ttdoc">Determines if the given VAddr is valid for the specified process. </div><div class="ttdef"><b>Definition:</b> <a href="memory_8cpp_source.html#l00210">memory.cpp:210</a></div></div>
<div class="ttc" id="namespace_kernel_html_a8ab884791d23ec8f12c464b21e1983f7"><div class="ttname"><a href="namespace_kernel.html#a8ab884791d23ec8f12c464b21e1983f7">Kernel::PriorityBoostStarvedThreads</a></div><div class="ttdeci">static void PriorityBoostStarvedThreads()</div><div class="ttdoc">Boost low priority threads (temporarily) that have been starved. </div><div class="ttdef"><b>Definition:</b> <a href="thread_8cpp_source.html#l00103">thread.cpp:103</a></div></div>
<div class="ttc" id="core__timing_8h_html"><div class="ttname"><a href="core__timing_8h.html">core_timing.h</a></div></div>
<div class="ttc" id="core_2cpu_2common_8h_html_a755aa35b683d219676ce9e07b7eda4d1"><div class="ttname"><a href="core_2cpu_2common_8h.html#a755aa35b683d219676ce9e07b7eda4d1">USER32MODE</a></div><div class="ttdeci">#define USER32MODE</div><div class="ttdef"><b>Definition:</b> <a href="core_2cpu_2common_8h_source.html#l00010">common.h:10</a></div></div>
<div class="ttc" id="class_kernel_1_1_handle_table_html_a5b29630a4f933d886325cdf00528f46e"><div class="ttname"><a href="class_kernel_1_1_handle_table.html#a5b29630a4f933d886325cdf00528f46e">Kernel::HandleTable::Create</a></div><div class="ttdeci">ResultVal&lt; Handle &gt; Create(SharedPtr&lt; Object &gt; obj)</div><div class="ttdoc">Allocates a handle for the given object. </div><div class="ttdef"><b>Definition:</b> <a href="handle__table_8cpp_source.html#l00022">handle_table.cpp:22</a></div></div>
<div class="ttc" id="cpu_8h_html"><div class="ttname"><a href="cpu_8h.html">cpu.h</a></div></div>
<div class="ttc" id="class_kernel_1_1_thread_html_af9c2edebfe0ad65f7de1375b9a075c20"><div class="ttname"><a href="class_kernel_1_1_thread.html#af9c2edebfe0ad65f7de1375b9a075c20">Kernel::Thread::current_priority</a></div><div class="ttdeci">u32 current_priority</div><div class="ttdoc">Current thread priority, can be temporarily changed. </div><div class="ttdef"><b>Definition:</b> <a href="thread_8h_source.html#l00194">thread.h:194</a></div></div>
<div class="ttc" id="mutex_8h_html"><div class="ttname"><a href="mutex_8h.html">mutex.h</a></div></div>
<div class="ttc" id="namespace_settings_html_a89bad2e81a950120963b3f26c691810a"><div class="ttname"><a href="namespace_settings.html#a89bad2e81a950120963b3f26c691810a">Settings::values</a></div><div class="ttdeci">Values values</div><div class="ttdef"><b>Definition:</b> <a href="settings_8cpp_source.html#l00015">settings.cpp:15</a></div></div>
<div class="ttc" id="common__types_8h_html_a65cf28726f89e62ccf2f1354bc2716df"><div class="ttname"><a href="common__types_8h.html#a65cf28726f89e62ccf2f1354bc2716df">u32</a></div><div class="ttdeci">std::uint32_t u32</div><div class="ttdoc">32-bit unsigned word </div><div class="ttdef"><b>Definition:</b> <a href="common__types_8h_source.html#l00037">common_types.h:37</a></div></div>
<div class="ttc" id="thread_8h_html_a7f5a53b4a276b18ce9c72982ab3fc772a27721a7ab79c120e622b9718a66546f8"><div class="ttname"><a href="thread_8h.html#a7f5a53b4a276b18ce9c72982ab3fc772a27721a7ab79c120e622b9718a66546f8">THREADPRIO_HIGHEST</a></div><div class="ttdoc">Highest thread priority. </div><div class="ttdef"><b>Definition:</b> <a href="thread_8h_source.html#l00019">thread.h:19</a></div></div>
<div class="ttc" id="namespace_kernel_html_acc94fbb639695fd4effa646fcc0ea631"><div class="ttname"><a href="namespace_kernel.html#acc94fbb639695fd4effa646fcc0ea631">Kernel::Reschedule</a></div><div class="ttdeci">void Reschedule()</div><div class="ttdoc">Reschedules to the next available thread (call after current thread is suspended) ...</div><div class="ttdef"><b>Definition:</b> <a href="thread_8cpp_source.html#l00463">thread.cpp:463</a></div></div>
<div class="ttc" id="namespace_kernel_html_aae441b6285ab4907e8fe87cc0e8297bf"><div class="ttname"><a href="namespace_kernel.html#aae441b6285ab4907e8fe87cc0e8297bf">Kernel::ThreadWakeupCallback</a></div><div class="ttdeci">static void ThreadWakeupCallback(u64 thread_handle, s64 cycles_late)</div><div class="ttdoc">Callback that will wake up the thread it was scheduled for. </div><div class="ttdef"><b>Definition:</b> <a href="thread_8cpp_source.html#l00210">thread.cpp:210</a></div></div>
<div class="ttc" id="namespace_kernel_html_a1bce0cfa9f85567e044bb113dc00599b"><div class="ttname"><a href="namespace_kernel.html#a1bce0cfa9f85567e044bb113dc00599b">Kernel::GetMemoryRegion</a></div><div class="ttdeci">MemoryRegionInfo * GetMemoryRegion(MemoryRegion region)</div><div class="ttdef"><b>Definition:</b> <a href="hle_2kernel_2memory_8cpp_source.html#l00097">memory.cpp:97</a></div></div>
<div class="ttc" id="result_8h_html_a1d3c3229b2c38b6fe717b434732c5b86a253ca7dd096ee0956cccee4d376cab8b"><div class="ttname"><a href="result_8h.html#a1d3c3229b2c38b6fe717b434732c5b86a253ca7dd096ee0956cccee4d376cab8b">ErrorSummary::InvalidArgument</a></div><div class="ttdoc">Returned when a passed argument is invalid in the current runtime context. (Invalid handle...</div></div>
<div class="ttc" id="thread_8h_html_aa22fbc47a3eef37e7a1b68462ffd8f2da8011039d301f169faf196be6c5a5289b"><div class="ttname"><a href="thread_8h.html#aa22fbc47a3eef37e7a1b68462ffd8f2da8011039d301f169faf196be6c5a5289b">THREADPROCESSORID_MAX</a></div><div class="ttdoc">Processor ID must be less than this. </div><div class="ttdef"><b>Definition:</b> <a href="thread_8h_source.html#l00031">thread.h:31</a></div></div>
<div class="ttc" id="class_kernel_1_1_thread_html_a7bc369db59f3a581be6dd929e44bcdb0"><div class="ttname"><a href="class_kernel_1_1_thread.html#a7bc369db59f3a581be6dd929e44bcdb0">Kernel::Thread::processor_id</a></div><div class="ttdeci">s32 processor_id</div><div class="ttdef"><b>Definition:</b> <a href="thread_8h_source.html#l00198">thread.h:198</a></div></div>
<div class="ttc" id="thread_8h_html_ae2739961013a00cede621d4d72f2173ca656047d30f939008f2f528ce6fabe1c7"><div class="ttname"><a href="thread_8h.html#ae2739961013a00cede621d4d72f2173ca656047d30f939008f2f528ce6fabe1c7">THREADSTATUS_WAIT_SLEEP</a></div><div class="ttdoc">Waiting due to a SleepThread SVC. </div><div class="ttdef"><b>Definition:</b> <a href="thread_8h_source.html#l00038">thread.h:38</a></div></div>
<div class="ttc" id="class_kernel_1_1_thread_html_a7c3764b8467d7a626f024b6f87abf2f0"><div class="ttname"><a href="class_kernel_1_1_thread.html#a7c3764b8467d7a626f024b6f87abf2f0">Kernel::Thread::~Thread</a></div><div class="ttdeci">~Thread() override</div><div class="ttdef"><b>Definition:</b> <a href="thread_8cpp_source.html#l00064">thread.cpp:64</a></div></div>
<div class="ttc" id="settings_8h_html"><div class="ttname"><a href="settings_8h.html">settings.h</a></div></div>
<div class="ttc" id="struct_common_1_1_thread_queue_list_html_a561ab94bad249fa98cf35888ec1371dc"><div class="ttname"><a href="struct_common_1_1_thread_queue_list.html#a561ab94bad249fa98cf35888ec1371dc">Common::ThreadQueueList::move</a></div><div class="ttdeci">void move(const T &amp;thread_id, Priority old_priority, Priority new_priority)</div><div class="ttdef"><b>Definition:</b> <a href="thread__queue__list_8h_source.html#l00091">thread_queue_list.h:91</a></div></div>
<div class="ttc" id="class_kernel_1_1_thread_html_a76b8c91d28e852f66c4343d531964b64"><div class="ttname"><a href="class_kernel_1_1_thread.html#a76b8c91d28e852f66c4343d531964b64">Kernel::Thread::wakeup_callback</a></div><div class="ttdeci">std::function&lt; WakeupCallback &gt; wakeup_callback</div><div class="ttdef"><b>Definition:</b> <a href="thread_8h_source.html#l00226">thread.h:226</a></div></div>
<div class="ttc" id="namespace_kernel_html_a3b47eb55cabbb2b04953d5b9a7f37dac"><div class="ttname"><a href="namespace_kernel.html#a3b47eb55cabbb2b04953d5b9a7f37dac">Kernel::ClearProcessList</a></div><div class="ttdeci">void ClearProcessList()</div><div class="ttdef"><b>Definition:</b> <a href="process_8cpp_source.html#l00314">process.cpp:314</a></div></div>
<div class="ttc" id="union_result_code_html_ac2f3fa949e4d5a894cc7bb1698e8506f"><div class="ttname"><a href="union_result_code.html#ac2f3fa949e4d5a894cc7bb1698e8506f">ResultCode::raw</a></div><div class="ttdeci">u32 raw</div><div class="ttdef"><b>Definition:</b> <a href="result_8h_source.html#l00196">result.h:196</a></div></div>
<div class="ttc" id="namespace_kernel_html_a468effefd7385726635010b18e69a625"><div class="ttname"><a href="namespace_kernel.html#a468effefd7385726635010b18e69a625">Kernel::GetCurrentThread</a></div><div class="ttdeci">Thread * GetCurrentThread()</div><div class="ttdoc">Gets the current thread. </div><div class="ttdef"><b>Definition:</b> <a href="thread_8cpp_source.html#l00066">thread.cpp:66</a></div></div>
<div class="ttc" id="namespace_kernel_html_a268aae86c41ad158e2ce656cd2ca36af"><div class="ttname"><a href="namespace_kernel.html#a268aae86c41ad158e2ce656cd2ca36af">Kernel::ThreadingInit</a></div><div class="ttdeci">void ThreadingInit()</div><div class="ttdoc">Initialize threading. </div><div class="ttdef"><b>Definition:</b> <a href="thread_8cpp_source.html#l00503">thread.cpp:503</a></div></div>
<div class="ttc" id="union_result_code_html"><div class="ttname"><a href="union_result_code.html">ResultCode</a></div><div class="ttdoc">Encapsulates a CTR-OS error code, allowing it to be separated into its constituent fields...</div><div class="ttdef"><b>Definition:</b> <a href="result_8h_source.html#l00195">result.h:195</a></div></div>
<div class="ttc" id="class_kernel_1_1_thread_html"><div class="ttname"><a href="class_kernel_1_1_thread.html">Kernel::Thread</a></div><div class="ttdef"><b>Definition:</b> <a href="thread_8h_source.html#l00057">thread.h:57</a></div></div>
<div class="ttc" id="class_kernel_1_1_thread_html_a9984001281eb73a5491a03ee64fa0bd6"><div class="ttname"><a href="class_kernel_1_1_thread.html#a9984001281eb73a5491a03ee64fa0bd6">Kernel::Thread::SetWaitSynchronizationResult</a></div><div class="ttdeci">void SetWaitSynchronizationResult(ResultCode result)</div><div class="ttdoc">Sets the result after the thread awakens (from either WaitSynchronization SVC) </div><div class="ttdef"><b>Definition:</b> <a href="thread_8cpp_source.html#l00481">thread.cpp:481</a></div></div>
<div class="ttc" id="core_2cpu_2common_8h_html_ac0a6fd055c958aa80160e3f7b411fa7a"><div class="ttname"><a href="core_2cpu_2common_8h.html#ac0a6fd055c958aa80160e3f7b411fa7a">FPSCR_DEFAULT_NAN</a></div><div class="ttdeci">#define FPSCR_DEFAULT_NAN</div><div class="ttdef"><b>Definition:</b> <a href="core_2cpu_2common_8h_source.html#l00011">common.h:11</a></div></div>
<div class="ttc" id="assert_8h_html_afbc5558e0fd2920b8774c8b366dd4100"><div class="ttname"><a href="assert_8h.html#afbc5558e0fd2920b8774c8b366dd4100">DEBUG_ASSERT_MSG</a></div><div class="ttdeci">#define DEBUG_ASSERT_MSG(_a_, _desc_,...)</div><div class="ttdef"><b>Definition:</b> <a href="assert_8h_source.html#l00052">assert.h:52</a></div></div>
<div class="ttc" id="thread_8h_html_ae2739961013a00cede621d4d72f2173ca1c4225d1e5a678d4f4f512130c77cf22"><div class="ttname"><a href="thread_8h.html#ae2739961013a00cede621d4d72f2173ca1c4225d1e5a678d4f4f512130c77cf22">THREADSTATUS_WAIT_HLE_EVENT</a></div><div class="ttdoc">Waiting due to an HLE handler pausing the thread. </div><div class="ttdef"><b>Definition:</b> <a href="thread_8h_source.html#l00042">thread.h:42</a></div></div>
<div class="ttc" id="core_2cpu_2common_8h_html_aa20d39a4d63facba7baa6f25ac71b710"><div class="ttname"><a href="core_2cpu_2common_8h.html#aa20d39a4d63facba7baa6f25ac71b710">FPSCR_FLUSH_TO_ZERO</a></div><div class="ttdeci">#define FPSCR_FLUSH_TO_ZERO</div><div class="ttdef"><b>Definition:</b> <a href="core_2cpu_2common_8h_source.html#l00012">common.h:12</a></div></div>
<div class="ttc" id="namespace_kernel_html_a712ba5c60b9228ac11b5338615e4c3ae"><div class="ttname"><a href="namespace_kernel.html#a712ba5c60b9228ac11b5338615e4c3ae">Kernel::ERR_OUT_OF_RANGE_KERNEL</a></div><div class="ttdeci">constexpr ResultCode ERR_OUT_OF_RANGE_KERNEL(ErrorDescription::OutOfRange, ErrorModule::Kernel, ErrorSummary::InvalidArgument, ErrorLevel::Permanent)</div></div>
<div class="ttc" id="class_kernel_1_1_thread_html_adbb27afcdc9ce1d85edbd3ec8ab76030"><div class="ttname"><a href="class_kernel_1_1_thread.html#adbb27afcdc9ce1d85edbd3ec8ab76030">Kernel::Thread::entry_point</a></div><div class="ttdeci">u32 entry_point</div><div class="ttdef"><b>Definition:</b> <a href="thread_8h_source.html#l00190">thread.h:190</a></div></div>
<div class="ttc" id="namespace_kernel_html_abb5661fdc2fa616b12a53b0b558d203f"><div class="ttname"><a href="namespace_kernel.html#abb5661fdc2fa616b12a53b0b558d203f">Kernel::PopNextReadyThread</a></div><div class="ttdeci">static Thread * PopNextReadyThread()</div><div class="ttdoc">Pops and returns the next thread from the thread queue. </div><div class="ttdef"><b>Definition:</b> <a href="thread_8cpp_source.html#l00174">thread.cpp:174</a></div></div>
<div class="ttc" id="namespace_memory_html_a9385b06235a83b908d97dedb0416ce7b"><div class="ttname"><a href="namespace_memory.html#a9385b06235a83b908d97dedb0416ce7b">Memory::SetCurrentPageTable</a></div><div class="ttdeci">void SetCurrentPageTable(PageTable *page_table)</div><div class="ttdoc">Currently active page table. </div><div class="ttdef"><b>Definition:</b> <a href="memory_8cpp_source.html#l00029">memory.cpp:29</a></div></div>
<div class="ttc" id="class_kernel_1_1_thread_html_a1e3c43a8deb41dc6153ea268bcc0d0ea"><div class="ttname"><a href="class_kernel_1_1_thread.html#a1e3c43a8deb41dc6153ea268bcc0d0ea">Kernel::Thread::last_running_ticks</a></div><div class="ttdeci">u64 last_running_ticks</div><div class="ttdoc">CPU tick when thread was last running. </div><div class="ttdef"><b>Definition:</b> <a href="thread_8h_source.html#l00196">thread.h:196</a></div></div>
<div class="ttc" id="class_core_1_1_system_html_ab2f9ff357787ec877567d8c4ffe2a2d4"><div class="ttname"><a href="class_core_1_1_system.html#ab2f9ff357787ec877567d8c4ffe2a2d4">Core::System::GetInstance</a></div><div class="ttdeci">static System &amp; GetInstance()</div><div class="ttdoc">Gets the instance of the System singleton class. </div><div class="ttdef"><b>Definition:</b> <a href="core_8h_source.html#l00049">core.h:49</a></div></div>
<div class="ttc" id="class_kernel_1_1_wait_object_html"><div class="ttname"><a href="class_kernel_1_1_wait_object.html">Kernel::WaitObject</a></div><div class="ttdoc">Class that represents a Kernel object that a thread can be waiting on. </div><div class="ttdef"><b>Definition:</b> <a href="wait__object_8h_source.html#l00017">wait_object.h:17</a></div></div>
<div class="ttc" id="class_kernel_1_1_thread_html_a9e9f309142a6fc6a67a68900be435d42"><div class="ttname"><a href="class_kernel_1_1_thread.html#a9e9f309142a6fc6a67a68900be435d42">Kernel::Thread::GetCommandBufferAddress</a></div><div class="ttdeci">VAddr GetCommandBufferAddress() const</div><div class="ttdef"><b>Definition:</b> <a href="thread_8cpp_source.html#l00495">thread.cpp:495</a></div></div>
<div class="ttc" id="namespace_kernel_html_a799098b4a3ef3b8700965b981e08d160"><div class="ttname"><a href="namespace_kernel.html#a799098b4a3ef3b8700965b981e08d160">Kernel::WaitCurrentThread_Sleep</a></div><div class="ttdeci">void WaitCurrentThread_Sleep()</div><div class="ttdoc">Waits the current thread on a sleep. </div><div class="ttdef"><b>Definition:</b> <a href="thread_8cpp_source.html#l00193">thread.cpp:193</a></div></div>
<div class="ttc" id="thread_8h_html_ae2739961013a00cede621d4d72f2173ca4ea4195be2fc5341eb2de05cf8e11b2e"><div class="ttname"><a href="thread_8h.html#ae2739961013a00cede621d4d72f2173ca4ea4195be2fc5341eb2de05cf8e11b2e">THREADSTATUS_DORMANT</a></div><div class="ttdoc">Created but not yet made ready. </div><div class="ttdef"><b>Definition:</b> <a href="thread_8h_source.html#l00043">thread.h:43</a></div></div>
<div class="ttc" id="struct_common_1_1_thread_queue_list_html_a636d4bce7833ef66b5d26f6e2765609e"><div class="ttname"><a href="struct_common_1_1_thread_queue_list.html#a636d4bce7833ef66b5d26f6e2765609e">Common::ThreadQueueList::get_first</a></div><div class="ttdeci">T get_first()</div><div class="ttdef"><b>Definition:</b> <a href="thread__queue__list_8h_source.html#l00040">thread_queue_list.h:40</a></div></div>
<div class="ttc" id="assert_8h_html_a9f920d5e0c0e8780d4ce9bfb15bfd9e2"><div class="ttname"><a href="assert_8h.html#a9f920d5e0c0e8780d4ce9bfb15bfd9e2">ASSERT</a></div><div class="ttdeci">#define ASSERT(_a_)</div><div class="ttdef"><b>Definition:</b> <a href="assert_8h_source.html#l00030">assert.h:30</a></div></div>
<div class="ttc" id="thread_8h_html_a7f5a53b4a276b18ce9c72982ab3fc772a3a09ff6360c3f2a2648fb73ac154e37a"><div class="ttname"><a href="thread_8h.html#a7f5a53b4a276b18ce9c72982ab3fc772a3a09ff6360c3f2a2648fb73ac154e37a">THREADPRIO_LOWEST</a></div><div class="ttdoc">Lowest thread priority. </div><div class="ttdef"><b>Definition:</b> <a href="thread_8h_source.html#l00022">thread.h:22</a></div></div>
<div class="ttc" id="log_8h_html"><div class="ttname"><a href="log_8h.html">log.h</a></div></div>
<div class="ttc" id="namespace_kernel_html_afb064e9aa4fac4a8c2540f009c878746"><div class="ttname"><a href="namespace_kernel.html#afb064e9aa4fac4a8c2540f009c878746">Kernel::ThreadingShutdown</a></div><div class="ttdeci">void ThreadingShutdown()</div><div class="ttdoc">Shutdown threading. </div><div class="ttdef"><b>Definition:</b> <a href="thread_8cpp_source.html#l00510">thread.cpp:510</a></div></div>
<div class="ttc" id="namespace_kernel_html_a6d881391f98be9ad867180e91f8f59a6"><div class="ttname"><a href="namespace_kernel.html#a6d881391f98be9ad867180e91f8f59a6">Kernel::SetupMainThread</a></div><div class="ttdeci">SharedPtr&lt; Thread &gt; SetupMainThread(u32 entry_point, u32 priority, SharedPtr&lt; Process &gt; owner_process)</div><div class="ttdoc">Sets up the primary application thread. </div><div class="ttdef"><b>Definition:</b> <a href="thread_8cpp_source.html#l00445">thread.cpp:445</a></div></div>
<div class="ttc" id="class_kernel_1_1_thread_html_a9ccfba16056218acee5f3d4ee031b12b"><div class="ttname"><a href="class_kernel_1_1_thread.html#a9ccfba16056218acee5f3d4ee031b12b">Kernel::Thread::ResumeFromWait</a></div><div class="ttdeci">void ResumeFromWait()</div><div class="ttdoc">Resumes a thread from waiting. </div><div class="ttdef"><b>Definition:</b> <a href="thread_8cpp_source.html#l00242">thread.cpp:242</a></div></div>
<div class="ttc" id="class_kernel_1_1_thread_html_a35c6a5d5f80bc6dff2526aacb35d6b53"><div class="ttname"><a href="class_kernel_1_1_thread.html#a35c6a5d5f80bc6dff2526aacb35d6b53">Kernel::Thread::Thread</a></div><div class="ttdeci">Thread()</div><div class="ttdef"><b>Definition:</b> <a href="thread_8cpp_source.html#l00063">thread.cpp:63</a></div></div>
<div class="ttc" id="class_kernel_1_1_thread_html_a45860435fb69f8d8d56eb4e4efdee67d"><div class="ttname"><a href="class_kernel_1_1_thread.html#a45860435fb69f8d8d56eb4e4efdee67d">Kernel::Thread::callback_handle</a></div><div class="ttdeci">Handle callback_handle</div><div class="ttdoc">Handle used as userdata to reference this object when inserting into the CoreTiming queue...</div><div class="ttdef"><b>Definition:</b> <a href="thread_8h_source.html#l00219">thread.h:219</a></div></div>
<div class="ttc" id="namespace_kernel_html_a9f631a85725bcba76d420c422e4f28db"><div class="ttname"><a href="namespace_kernel.html#a9f631a85725bcba76d420c422e4f28db">Kernel::GetThreadList</a></div><div class="ttdeci">const std::vector&lt; SharedPtr&lt; Thread &gt; &gt; &amp; GetThreadList()</div><div class="ttdoc">Get a const reference to the thread list for debug use. </div><div class="ttdef"><b>Definition:</b> <a href="thread_8cpp_source.html#l00521">thread.cpp:521</a></div></div>
<div class="ttc" id="class_kernel_1_1_thread_html_ae460590ab237cf75e3927450f89be5e7"><div class="ttname"><a href="class_kernel_1_1_thread.html#ae460590ab237cf75e3927450f89be5e7">Kernel::Thread::ShouldWait</a></div><div class="ttdeci">bool ShouldWait(Thread *thread) const override</div><div class="ttdoc">Check if the specified thread should wait until the object is available. </div><div class="ttdef"><b>Definition:</b> <a href="thread_8cpp_source.html#l00032">thread.cpp:32</a></div></div>
<div class="ttc" id="class_kernel_1_1_thread_html_ad1f94dc234c3f94dcbd1df9d4c21510b"><div class="ttname"><a href="class_kernel_1_1_thread.html#ad1f94dc234c3f94dcbd1df9d4c21510b">Kernel::Thread::tls_address</a></div><div class="ttdeci">VAddr tls_address</div><div class="ttdoc">Virtual address of the Thread Local Storage of the thread. </div><div class="ttdef"><b>Definition:</b> <a href="thread_8h_source.html#l00200">thread.h:200</a></div></div>
<div class="ttc" id="namespace_kernel_html_ad6b2714868b2c2be12c3b00822d18b2e"><div class="ttname"><a href="namespace_kernel.html#ad6b2714868b2c2be12c3b00822d18b2e">Kernel::Handle</a></div><div class="ttdeci">u32 Handle</div><div class="ttdef"><b>Definition:</b> <a href="object_8h_source.html#l00017">object.h:17</a></div></div>
<div class="ttc" id="namespace_memory_html_a0abdbb4b878710f67db886fba7a802ffa1c713c87eb1364d04b3809eb5c997300"><div class="ttname"><a href="namespace_memory.html#a0abdbb4b878710f67db886fba7a802ffa1c713c87eb1364d04b3809eb5c997300">Memory::TLS_AREA_VADDR</a></div><div class="ttdoc">Area where TLS (Thread-Local Storage) buffers are allocated. </div><div class="ttdef"><b>Definition:</b> <a href="memory_8h_source.html#l00170">memory.h:170</a></div></div>
<div class="ttc" id="struct_common_1_1_thread_queue_list_html"><div class="ttname"><a href="struct_common_1_1_thread_queue_list.html">Common::ThreadQueueList</a></div><div class="ttdef"><b>Definition:</b> <a href="thread__queue__list_8h_source.html#l00014">thread_queue_list.h:14</a></div></div>
<div class="ttc" id="math__util_8h_html"><div class="ttname"><a href="math__util_8h.html">math_util.h</a></div></div>
<div class="ttc" id="namespace_core_timing_html_a3ed2b5dcdf393fa1f42be0b25c1a43ad"><div class="ttname"><a href="namespace_core_timing.html#a3ed2b5dcdf393fa1f42be0b25c1a43ad">CoreTiming::GetTicks</a></div><div class="ttdeci">u64 GetTicks()</div><div class="ttdoc">This should only be called from the emu thread, if you are calling it any other thread, you are doing something evil. </div><div class="ttdef"><b>Definition:</b> <a href="core__timing_8cpp_source.html#l00115">core_timing.cpp:115</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_aebb8dcc11953d78e620bbef0b9e2183.html">core</a></li><li class="navelem"><a class="el" href="dir_ad0974a1dfe0794d9a8a3cb5a67eca54.html">hle</a></li><li class="navelem"><a class="el" href="dir_e23e4a7de7edb28c2451a78f271be30e.html">kernel</a></li><li class="navelem"><a class="el" href="thread_8cpp.html">thread.cpp</a></li>
    <li class="footer">Generated on Thu Sep 13 2018 12:49:43 for Citra by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
