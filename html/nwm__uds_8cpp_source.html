<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Citra: src/core/hle/service/nwm/nwm_uds.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="doc-icon.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Citra
   </div>
   <div id="projectbrief">Nintendo 3DS emulator</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('nwm__uds_8cpp_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">nwm_uds.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="nwm__uds_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// Copyright 2017 Citra Emulator Project</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">// Licensed under GPLv2 or any later version</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// Refer to the license.txt file included.</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &lt;algorithm&gt;</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &lt;array&gt;</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &lt;atomic&gt;</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &lt;cstring&gt;</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &lt;list&gt;</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &lt;map&gt;</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &lt;mutex&gt;</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &lt;unordered_map&gt;</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &lt;vector&gt;</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &lt;cryptopp/osrng.h&gt;</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="common__types_8h.html">common/common_types.h</a>&quot;</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="log_8h.html">common/logging/log.h</a>&quot;</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="core_8h.html">core/core.h</a>&quot;</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="core__timing_8h.html">core/core_timing.h</a>&quot;</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ipc__helpers_8h.html">core/hle/ipc_helpers.h</a>&quot;</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="core_2hle_2kernel_2event_8h.html">core/hle/kernel/event.h</a>&quot;</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="core_2hle_2kernel_2shared__memory_8h.html">core/hle/kernel/shared_memory.h</a>&quot;</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="lock_8h.html">core/hle/lock.h</a>&quot;</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="result_8h.html">core/hle/result.h</a>&quot;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="nwm__uds_8h.html">core/hle/service/nwm/nwm_uds.h</a>&quot;</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="uds__beacon_8h.html">core/hle/service/nwm/uds_beacon.h</a>&quot;</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="uds__connection_8h.html">core/hle/service/nwm/uds_connection.h</a>&quot;</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="uds__data_8h.html">core/hle/service/nwm/uds_data.h</a>&quot;</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="memory_8h.html">core/memory.h</a>&quot;</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="network_8h.html">network/network.h</a>&quot;</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespace_service_1_1_n_w_m.html">Service::NWM</a> {</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div><div class="line"><a name="l00033"></a><span class="lineno"><a class="line" href="namespace_service_1_1_n_w_m_1_1_err_codes.html">   33</a></span>&#160;<span class="keyword">namespace </span>ErrCodes {</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="keyword">enum</span> {</div><div class="line"><a name="l00035"></a><span class="lineno"><a class="line" href="namespace_service_1_1_n_w_m_1_1_err_codes.html#aeb854535fff279bb2aba92bfd22b7558aa93f73db48d3440a8257d905cc9fa62e">   35</a></span>&#160;    <a class="code" href="namespace_service_1_1_n_w_m_1_1_err_codes.html#aeb854535fff279bb2aba92bfd22b7558aa93f73db48d3440a8257d905cc9fa62e">NotInitialized</a> = 2,</div><div class="line"><a name="l00036"></a><span class="lineno"><a class="line" href="namespace_service_1_1_n_w_m_1_1_err_codes.html#aeb854535fff279bb2aba92bfd22b7558a93a5e56ad80aba8e21f449e36f03c35b">   36</a></span>&#160;    <a class="code" href="namespace_service_1_1_n_w_m_1_1_err_codes.html#aeb854535fff279bb2aba92bfd22b7558a93a5e56ad80aba8e21f449e36f03c35b">WrongStatus</a> = 490,</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;};</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;} <span class="comment">// namespace ErrCodes</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">// Event that is signaled every time the connection status changes.</span></div><div class="line"><a name="l00041"></a><span class="lineno"><a class="line" href="namespace_service_1_1_n_w_m.html#a9963cc544896afb34b26fbee1ba671c5">   41</a></span>&#160;<span class="keyword">static</span> <a class="code" href="namespace_kernel.html#afc9bde79933dd23864df0768adeb6cfe">Kernel::SharedPtr&lt;Kernel::Event&gt;</a> <a class="code" href="namespace_service_1_1_n_w_m.html#a9963cc544896afb34b26fbee1ba671c5">connection_status_event</a>;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">// Shared memory provided by the application to store the receive buffer.</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">// This is not currently used.</span></div><div class="line"><a name="l00045"></a><span class="lineno"><a class="line" href="namespace_service_1_1_n_w_m.html#a2e7ef1e7be59821c8fcabb4b60606d2b">   45</a></span>&#160;<span class="keyword">static</span> <a class="code" href="namespace_kernel.html#afc9bde79933dd23864df0768adeb6cfe">Kernel::SharedPtr&lt;Kernel::SharedMemory&gt;</a> <a class="code" href="namespace_service_1_1_n_w_m.html#a2e7ef1e7be59821c8fcabb4b60606d2b">recv_buffer_memory</a>;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">// Connection status of this 3DS.</span></div><div class="line"><a name="l00048"></a><span class="lineno"><a class="line" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">   48</a></span>&#160;<span class="keyword">static</span> <a class="code" href="struct_service_1_1_n_w_m_1_1_connection_status.html">ConnectionStatus</a> <a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a>{};</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="keyword">static</span> std::atomic&lt;bool&gt; <a class="code" href="namespace_service_1_1_n_w_m.html#a774871a74b2577582842ad16e4abec64">initialized</a>(<span class="keyword">false</span>);</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">/* Node information about the current network.</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment"> * The amount of elements in this vector is always the maximum number</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment"> * of nodes specified in the network configuration.</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment"> * The first node is always the host.</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00057"></a><span class="lineno"><a class="line" href="namespace_service_1_1_n_w_m.html#ab532ab50d4ee263def66a4c4c6be5a80">   57</a></span>&#160;<span class="keyword">static</span> <a class="code" href="namespace_service_1_1_n_w_m.html#a6eb4e95da394c037a2110a2c8f4a755e">NodeList</a> <a class="code" href="namespace_service_1_1_n_w_m.html#ab532ab50d4ee263def66a4c4c6be5a80">node_info</a>;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">// Node information about our own system.</span></div><div class="line"><a name="l00060"></a><span class="lineno"><a class="line" href="namespace_service_1_1_n_w_m.html#a4f4c0df5e69105de353121769e93ce69">   60</a></span>&#160;<span class="keyword">static</span> <a class="code" href="struct_service_1_1_n_w_m_1_1_node_info.html">NodeInfo</a> <a class="code" href="namespace_service_1_1_n_w_m.html#a4f4c0df5e69105de353121769e93ce69">current_node</a>;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div><div class="line"><a name="l00062"></a><span class="lineno"><a class="line" href="namespace_service_1_1_n_w_m.html">   62</a></span>&#160;<span class="keyword">struct </span><a class="code" href="namespace_service_1_1_n_w_m.html#struct_service_1_1_n_w_m_1_1_bind_node_data">BindNodeData</a> {</div><div class="line"><a name="l00063"></a><span class="lineno"><a class="line" href="namespace_service_1_1_n_w_m.html#a3b77ebaf6597a65dfcaadbcad27f0e31">   63</a></span>&#160;    <a class="code" href="common__types_8h.html#a65cf28726f89e62ccf2f1354bc2716df">u32</a> <a class="code" href="namespace_service_1_1_n_w_m.html#a3b77ebaf6597a65dfcaadbcad27f0e31">bind_node_id</a>;    </div><div class="line"><a name="l00064"></a><span class="lineno"><a class="line" href="namespace_service_1_1_n_w_m.html#abbc964ff9ab40fe882a6dee0839cbb3c">   64</a></span>&#160;    <a class="code" href="common__types_8h.html#a254d32383658e016368673396e7afc1b">u8</a> <a class="code" href="namespace_service_1_1_n_w_m.html#abbc964ff9ab40fe882a6dee0839cbb3c">channel</a>;          </div><div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="namespace_service_1_1_n_w_m.html#a3437e6ebfdbfacfa5adbb65883e3f1f5">   65</a></span>&#160;    <a class="code" href="common__types_8h.html#a917e58b0692c2df778a27350534cbfe7">u16</a> <a class="code" href="namespace_service_1_1_n_w_m.html#a3437e6ebfdbfacfa5adbb65883e3f1f5">network_node_id</a>; </div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <a class="code" href="namespace_kernel.html#afc9bde79933dd23864df0768adeb6cfe">Kernel::SharedPtr&lt;Kernel::Event&gt;</a> event;       </div><div class="line"><a name="l00068"></a><span class="lineno"><a class="line" href="namespace_service_1_1_n_w_m.html#a58ef6a8158f680004df214759843213b">   68</a></span>&#160;    std::deque&lt;std::vector&lt;u8&gt;&gt; <a class="code" href="namespace_service_1_1_n_w_m.html#a58ef6a8158f680004df214759843213b">received_packets</a>; </div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;};</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">// Mapping of data channels to their internal data.</span></div><div class="line"><a name="l00072"></a><span class="lineno"><a class="line" href="namespace_service_1_1_n_w_m.html#a317f4717f4324bfa17f07f9965f78952">   72</a></span>&#160;<span class="keyword">static</span> std::unordered_map&lt;u32, BindNodeData&gt; <a class="code" href="namespace_service_1_1_n_w_m.html#a317f4717f4324bfa17f07f9965f78952">channel_data</a>;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">// The WiFi network channel that the network is currently on.</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">// Since we&#39;re not actually interacting with physical radio waves, this is just a dummy value.</span></div><div class="line"><a name="l00076"></a><span class="lineno"><a class="line" href="namespace_service_1_1_n_w_m.html#a623a500ff8b4c3f1c93be76297039f1a">   76</a></span>&#160;<span class="keyword">static</span> <a class="code" href="common__types_8h.html#a254d32383658e016368673396e7afc1b">u8</a> <a class="code" href="namespace_service_1_1_n_w_m.html#a623a500ff8b4c3f1c93be76297039f1a">network_channel</a>{<a class="code" href="namespace_service_1_1_n_w_m.html#aa8893d16a17753698cd0c699d125d726">DefaultNetworkChannel</a>};</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">// Information about the network that we&#39;re currently connected to.</span></div><div class="line"><a name="l00079"></a><span class="lineno"><a class="line" href="namespace_service_1_1_n_w_m.html#acea04888afd12666e6eedae3911874cb">   79</a></span>&#160;<span class="keyword">static</span> <a class="code" href="struct_service_1_1_n_w_m_1_1_network_info.html">NetworkInfo</a> <a class="code" href="namespace_service_1_1_n_w_m.html#acea04888afd12666e6eedae3911874cb">network_info</a>;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">// Mapping of mac addresses to their respective node_ids.</span></div><div class="line"><a name="l00082"></a><span class="lineno"><a class="line" href="namespace_service_1_1_n_w_m.html#ac3f4477f0ba58e580d2bd4df3af43e25">   82</a></span>&#160;<span class="keyword">static</span> std::map&lt;MacAddress, u16&gt; <a class="code" href="namespace_service_1_1_n_w_m.html#ac3f4477f0ba58e580d2bd4df3af43e25">node_map</a>;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">// Event that will generate and send the 802.11 beacon frames.</span></div><div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="namespace_service_1_1_n_w_m.html#a01b19f16dd3935f6f5046784fba16480">   85</a></span>&#160;<span class="keyword">static</span> <a class="code" href="namespace_core_timing.html#struct_core_timing_1_1_event_type">CoreTiming::EventType</a>* <a class="code" href="namespace_service_1_1_n_w_m.html#a01b19f16dd3935f6f5046784fba16480">beacon_broadcast_event</a>;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">// Callback identifier for the OnWifiPacketReceived event.</span></div><div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="namespace_service_1_1_n_w_m.html#a2a915093b75121e760a3c2578eceb44a">   88</a></span>&#160;<span class="keyword">static</span> <a class="code" href="class_network_1_1_room_member.html#aa5637d98c13810dcee05de0bc41f25df">Network::RoomMember::CallbackHandle&lt;Network::WifiPacket&gt;</a> <a class="code" href="namespace_service_1_1_n_w_m.html#a2a915093b75121e760a3c2578eceb44a">wifi_packet_received</a>;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">// Mutex to synchronize access to the connection status between the emulation thread and the</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">// network thread.</span></div><div class="line"><a name="l00092"></a><span class="lineno"><a class="line" href="namespace_service_1_1_n_w_m.html#a1607ea35acaa873bc8554c269c90e0b3">   92</a></span>&#160;<span class="keyword">static</span> std::mutex <a class="code" href="namespace_service_1_1_n_w_m.html#a1607ea35acaa873bc8554c269c90e0b3">connection_status_mutex</a>;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div><div class="line"><a name="l00094"></a><span class="lineno"><a class="line" href="namespace_service_1_1_n_w_m.html#aba7a5e5ca1e111160bac8dc5180ebffe">   94</a></span>&#160;<span class="keyword">static</span> <a class="code" href="namespace_kernel.html#afc9bde79933dd23864df0768adeb6cfe">Kernel::SharedPtr&lt;Kernel::Event&gt;</a> <a class="code" href="namespace_service_1_1_n_w_m.html#aba7a5e5ca1e111160bac8dc5180ebffe">connection_event</a>;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">// Mutex to synchronize access to the list of received beacons between the emulation thread and the</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">// network thread.</span></div><div class="line"><a name="l00098"></a><span class="lineno"><a class="line" href="namespace_service_1_1_n_w_m.html#a77909b4bf6f29806ad6f214da381052f">   98</a></span>&#160;<span class="keyword">static</span> std::mutex <a class="code" href="namespace_service_1_1_n_w_m.html#a77909b4bf6f29806ad6f214da381052f">beacon_mutex</a>;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">// Number of beacons to store before we start dropping the old ones.</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">// TODO(Subv): Find a more accurate value for this limit.</span></div><div class="line"><a name="l00102"></a><span class="lineno"><a class="line" href="namespace_service_1_1_n_w_m.html#a57047a561e887cde9847b73b142a4dc6">  102</a></span>&#160;constexpr std::size_t <a class="code" href="namespace_service_1_1_n_w_m.html#a57047a561e887cde9847b73b142a4dc6">MaxBeaconFrames</a>{15};</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">// List of the last &lt;MaxBeaconFrames&gt; beacons received from the network.</span></div><div class="line"><a name="l00105"></a><span class="lineno"><a class="line" href="namespace_service_1_1_n_w_m.html#a8da2b90dc6abdf8de054b4e8f3cb5b02">  105</a></span>&#160;<span class="keyword">static</span> std::list&lt;Network::WifiPacket&gt; <a class="code" href="namespace_service_1_1_n_w_m.html#a8da2b90dc6abdf8de054b4e8f3cb5b02">received_beacons</a>;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">// Network node id used when a SecureData packet is addressed to every connected node.</span></div><div class="line"><a name="l00108"></a><span class="lineno"><a class="line" href="namespace_service_1_1_n_w_m.html#a0dde7396fe6df5c5f3f57972cf98203f">  108</a></span>&#160;constexpr <a class="code" href="common__types_8h.html#a917e58b0692c2df778a27350534cbfe7">u16</a> <a class="code" href="namespace_service_1_1_n_w_m.html#a0dde7396fe6df5c5f3f57972cf98203f">BroadcastNetworkNodeId</a>{0xFFFF};</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div><div class="line"><a name="l00113"></a><span class="lineno"><a class="line" href="namespace_service_1_1_n_w_m.html#a09a8c3835b523982576400aaead788ee">  113</a></span>&#160;std::list&lt;Network::WifiPacket&gt; <a class="code" href="namespace_service_1_1_n_w_m.html#a09a8c3835b523982576400aaead788ee">GetReceivedBeacons</a>(<span class="keyword">const</span> <a class="code" href="namespace_service_1_1_n_w_m.html#ab12fda5a2bfd7850870f7b03fcc21e72">MacAddress</a>&amp; sender) {</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    std::lock_guard&lt;std::mutex&gt; lock{beacon_mutex};</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="keywordflow">if</span> (sender != <a class="code" href="namespace_network.html#a8591cf445700107127c0f2bf46365e88">Network::BroadcastMac</a>) {</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        std::list&lt;Network::WifiPacket&gt; filtered_list{};</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> beacon{std::find_if(received_beacons.begin(), received_beacons.end(),</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                                       [&amp;sender](<span class="keyword">const</span> <a class="code" href="struct_network_1_1_wifi_packet.html">Network::WifiPacket</a>&amp; packet) {</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                                           <span class="keywordflow">return</span> packet.transmitter_address == sender;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                                       })};</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        <span class="keywordflow">if</span> (beacon != received_beacons.end()) {</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;            filtered_list.push_back(*beacon);</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;            <span class="comment">// TODO(B3N30): Check if the complete deque is cleared or just the fetched entries</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;            received_beacons.erase(beacon);</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        }</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        <span class="keywordflow">return</span> filtered_list;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    }</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="keywordflow">return</span> std::move(received_beacons);</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;}</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;</div><div class="line"><a name="l00132"></a><span class="lineno"><a class="line" href="namespace_service_1_1_n_w_m.html#aab843dbb97d49e6d10a14bcca9fc715c">  132</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespace_service_1_1_n_w_m.html#aab843dbb97d49e6d10a14bcca9fc715c">SendPacket</a>(<a class="code" href="struct_network_1_1_wifi_packet.html">Network::WifiPacket</a>&amp; packet) {</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> room_member{<a class="code" href="namespace_network.html#a5ee509b747f2af4c4110f7542a6efe8b">Network::GetRoomMember</a>().lock()}) {</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        <span class="keywordflow">if</span> (room_member-&gt;GetState() == <a class="code" href="class_network_1_1_room_member.html#a4fb1681ff11cc6027849e85aa917b5aca7d50c09f1ad7d098e0a847bcdcab7efb">Network::RoomMember::State::Joined</a>) {</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;            packet.<a class="code" href="struct_network_1_1_wifi_packet.html#af52e496f816ac80521b2328294c07ffa">transmitter_address</a> = room_member-&gt;GetMacAddress();</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;            room_member-&gt;SendWifiPacket(packet);</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        }</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    }</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;}</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment"> * Returns an available index in the nodes array for the</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment"> * currently-hosted UDS network.</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00145"></a><span class="lineno"><a class="line" href="namespace_service_1_1_n_w_m.html#a178bbf8dd6a12282d613d95aee419040">  145</a></span>&#160;<span class="keyword">static</span> <a class="code" href="common__types_8h.html#a917e58b0692c2df778a27350534cbfe7">u16</a> <a class="code" href="namespace_service_1_1_n_w_m.html#a178bbf8dd6a12282d613d95aee419040">GetNextAvailableNodeId</a>() {</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="common__types_8h.html#a917e58b0692c2df778a27350534cbfe7">u16</a> index{}; index &lt; <a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a>.<a class="code" href="struct_service_1_1_n_w_m_1_1_connection_status.html#a1316e3ca28f939ea4453649235c14a4e">max_nodes</a>; ++index) {</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        <span class="keywordflow">if</span> ((<a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a>.<a class="code" href="struct_service_1_1_n_w_m_1_1_connection_status.html#a2db87e8db746a74c27e1785c58e40cb0">node_bitmask</a> &amp; (1 &lt;&lt; index)) == 0)</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;            <span class="keywordflow">return</span> index + 1;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    }</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="comment">// Any connection attempts to an already full network should have been refused.</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <a class="code" href="assert_8h.html#a4b432fb3d47e2ca732caf965691a54d7">ASSERT_MSG</a>(<span class="keyword">false</span>, <span class="stringliteral">&quot;No available connection slots in the network&quot;</span>);</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;}</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;</div><div class="line"><a name="l00155"></a><span class="lineno"><a class="line" href="namespace_service_1_1_n_w_m.html#a91fbeaa6b7edaf5eff2a57306b86571e">  155</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="namespace_service_1_1_n_w_m.html#a91fbeaa6b7edaf5eff2a57306b86571e">BroadcastNodeMap</a>() {</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="comment">// Note: This is not how UDS on a 3ds does it but it shouldn&#39;t be</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="comment">// necessary for citra</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <a class="code" href="struct_network_1_1_wifi_packet.html">Network::WifiPacket</a> packet{};</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    packet.<a class="code" href="struct_network_1_1_wifi_packet.html#ae6f9dbe04ee6b8039f6b43601c6cd05c">channel</a> = <a class="code" href="namespace_service_1_1_n_w_m.html#a623a500ff8b4c3f1c93be76297039f1a">network_channel</a>;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    packet.type = <a class="code" href="struct_network_1_1_wifi_packet.html#a9047c2d448a65b11b302c7e9d0870d39a4cc567608b06d0cc686ac005ed880fab">Network::WifiPacket::PacketType::NodeMap</a>;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    packet.destination_address = <a class="code" href="namespace_network.html#a8591cf445700107127c0f2bf46365e88">Network::BroadcastMac</a>;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    std::size_t size{node_map.size()};</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="keyword">using</span> node_t = decltype(node_map)::value_type;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    packet.data.resize(<span class="keyword">sizeof</span>(size) + (<span class="keyword">sizeof</span>(node_t::first) + <span class="keyword">sizeof</span>(node_t::second)) * size);</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    std::memcpy(packet.data.data(), &amp;size, <span class="keyword">sizeof</span>(size));</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    std::size_t offset{<span class="keyword">sizeof</span>(size)};</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; node : node_map) {</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        std::memcpy(packet.data.data() + offset, node.first.data(), <span class="keyword">sizeof</span>(node.first));</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        std::memcpy(packet.data.data() + offset + <span class="keyword">sizeof</span>(node.first), &amp;node.second,</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                    <span class="keyword">sizeof</span>(node.second));</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        offset += <span class="keyword">sizeof</span>(node.first) + <span class="keyword">sizeof</span>(node.second);</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    }</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <a class="code" href="namespace_service_1_1_n_w_m.html#aab843dbb97d49e6d10a14bcca9fc715c">SendPacket</a>(packet);</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;}</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div><div class="line"><a name="l00177"></a><span class="lineno"><a class="line" href="namespace_service_1_1_n_w_m.html#a15b266f19f1e4ea059e7466e583bc199">  177</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="namespace_service_1_1_n_w_m.html#a15b266f19f1e4ea059e7466e583bc199">HandleNodeMapPacket</a>(<span class="keyword">const</span> <a class="code" href="struct_network_1_1_wifi_packet.html">Network::WifiPacket</a>&amp; packet) {</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    std::lock_guard&lt;std::mutex&gt; lock{connection_status_mutex};</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    node_map.clear();</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    std::size_t num_entries{};</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <a class="code" href="namespace_network.html#ad53970187104c70b9d5bd6506427c48b">Network::MacAddress</a> address{};</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <a class="code" href="common__types_8h.html#a917e58b0692c2df778a27350534cbfe7">u16</a> <span class="keywordtype">id</span>{};</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    std::memcpy(&amp;num_entries, packet.<a class="code" href="struct_network_1_1_wifi_packet.html#a48b867db11d2bbd7315e2855c13ab1bf">data</a>.data(), <span class="keyword">sizeof</span>(num_entries));</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    std::size_t offset{<span class="keyword">sizeof</span>(num_entries)};</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="keywordflow">for</span> (std::size_t i{}; i &lt; num_entries; ++i) {</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        std::memcpy(&amp;address, packet.<a class="code" href="struct_network_1_1_wifi_packet.html#a48b867db11d2bbd7315e2855c13ab1bf">data</a>.data() + offset, <span class="keyword">sizeof</span>(address));</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        std::memcpy(&amp;<span class="keywordtype">id</span>, packet.<a class="code" href="struct_network_1_1_wifi_packet.html#a48b867db11d2bbd7315e2855c13ab1bf">data</a>.data() + offset + <span class="keyword">sizeof</span>(address), <span class="keyword">sizeof</span>(<span class="keywordtype">id</span>));</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        node_map[address] = id;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        offset += <span class="keyword">sizeof</span>(address) + <span class="keyword">sizeof</span>(<span class="keywordtype">id</span>);</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    }</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;}</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">// Inserts the received beacon frame in the beacon queue and removes any older beacons if the size</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">// limit is exceeded.</span></div><div class="line"><a name="l00195"></a><span class="lineno"><a class="line" href="namespace_service_1_1_n_w_m.html#a31d1ba9f2dedeb1ba5fb5588db9d1213">  195</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespace_service_1_1_n_w_m.html#a31d1ba9f2dedeb1ba5fb5588db9d1213">HandleBeaconFrame</a>(<span class="keyword">const</span> <a class="code" href="struct_network_1_1_wifi_packet.html">Network::WifiPacket</a>&amp; packet) {</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    std::lock_guard&lt;std::mutex&gt; lock{beacon_mutex};</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> unique_beacon{std::find_if(received_beacons.begin(), received_beacons.end(),</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                                          [&amp;packet](<span class="keyword">const</span> <a class="code" href="struct_network_1_1_wifi_packet.html">Network::WifiPacket</a>&amp; new_packet) {</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                                              <span class="keywordflow">return</span> new_packet.transmitter_address ==</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                                                     packet.<a class="code" href="struct_network_1_1_wifi_packet.html#af52e496f816ac80521b2328294c07ffa">transmitter_address</a>;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                                          })};</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="keywordflow">if</span> (unique_beacon != received_beacons.end()) {</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        <span class="comment">// We already have a beacon from the same mac in the deque, remove the old one;</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        received_beacons.erase(unique_beacon);</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    }</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    received_beacons.emplace_back(packet);</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="comment">// Discard old beacons if the buffer is full.</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="keywordflow">if</span> (received_beacons.size() &gt; <a class="code" href="namespace_service_1_1_n_w_m.html#a57047a561e887cde9847b73b142a4dc6">MaxBeaconFrames</a>)</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        received_beacons.pop_front();</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;}</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;</div><div class="line"><a name="l00214"></a><span class="lineno"><a class="line" href="namespace_service_1_1_n_w_m.html#a61b6e3afb7217166137c50bc88745baa">  214</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespace_service_1_1_n_w_m.html#a61b6e3afb7217166137c50bc88745baa">HandleAssociationResponseFrame</a>(<span class="keyword">const</span> <a class="code" href="struct_network_1_1_wifi_packet.html">Network::WifiPacket</a>&amp; packet) {</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="keyword">auto</span> assoc_result{<a class="code" href="namespace_service_1_1_n_w_m.html#a3f692bdb7cf94e669038a2f5fa9914d8">GetAssociationResult</a>(packet.<a class="code" href="struct_network_1_1_wifi_packet.html#a48b867db11d2bbd7315e2855c13ab1bf">data</a>)};</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <a class="code" href="assert_8h.html#a4b432fb3d47e2ca732caf965691a54d7">ASSERT_MSG</a>(std::get&lt;AssocStatus&gt;(assoc_result) == <a class="code" href="namespace_service_1_1_n_w_m.html#a685f6f9337a209488e57af85c6dd2d85a30ae8fff8898dc197acd49d9c0797d20">AssocStatus::Successful</a>,</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;               <span class="stringliteral">&quot;Could not join network&quot;</span>);</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    {</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        std::lock_guard&lt;std::mutex&gt; lock{connection_status_mutex};</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        <a class="code" href="assert_8h.html#a9f920d5e0c0e8780d4ce9bfb15bfd9e2">ASSERT</a>(<a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a>.<a class="code" href="struct_service_1_1_n_w_m_1_1_connection_status.html#a06757367dc9053bdb0f13218ddfdc90c">status</a> == static_cast&lt;u32&gt;(<a class="code" href="namespace_service_1_1_n_w_m.html#a314d2573d77dfa9a69d021eb31ee2d64ae321c53b354930ba96f0243e652df458">NetworkStatus::Connecting</a>));</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    }</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="comment">// Send the EAPoL-Start packet to the server.</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="keyword">using</span> <a class="code" href="struct_network_1_1_wifi_packet.html">Network::WifiPacket</a>;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    WifiPacket eapol_start{};</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    eapol_start.<a class="code" href="struct_network_1_1_wifi_packet.html#ae6f9dbe04ee6b8039f6b43601c6cd05c">channel</a> = <a class="code" href="namespace_service_1_1_n_w_m.html#a623a500ff8b4c3f1c93be76297039f1a">network_channel</a>;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    eapol_start.data = <a class="code" href="namespace_service_1_1_n_w_m.html#aa713fe363101df94d41248db0873dea0">GenerateEAPoLStartFrame</a>(std::get&lt;u16&gt;(assoc_result), current_node);</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="comment">// TODO(B3N30): Encrypt the packet.</span></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    eapol_start.destination_address = packet.<a class="code" href="struct_network_1_1_wifi_packet.html#af52e496f816ac80521b2328294c07ffa">transmitter_address</a>;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    eapol_start.type = WifiPacket::PacketType::Data;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <a class="code" href="namespace_service_1_1_n_w_m.html#aab843dbb97d49e6d10a14bcca9fc715c">SendPacket</a>(eapol_start);</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;}</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;</div><div class="line"><a name="l00236"></a><span class="lineno"><a class="line" href="namespace_service_1_1_n_w_m.html#a67935288aed4bb0336843d027cfe7d97">  236</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="namespace_service_1_1_n_w_m.html#a67935288aed4bb0336843d027cfe7d97">HandleEAPoLPacket</a>(<span class="keyword">const</span> <a class="code" href="struct_network_1_1_wifi_packet.html">Network::WifiPacket</a>&amp; packet) {</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    std::unique_lock&lt;std::recursive_mutex&gt; hle_lock(<a class="code" href="namespace_h_l_e.html#acbdcc3b0ea2929dbf52e25ced9529d39">HLE::g_hle_lock</a>, std::defer_lock);</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    std::unique_lock&lt;std::mutex&gt; lock{<a class="code" href="namespace_service_1_1_n_w_m.html#a1607ea35acaa873bc8554c269c90e0b3">connection_status_mutex</a>, std::defer_lock};</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    std::lock(hle_lock, lock);</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespace_service_1_1_n_w_m.html#ad9a1f7b95f409b171cbc15e066bbaf2c">GetEAPoLFrameType</a>(packet.<a class="code" href="struct_network_1_1_wifi_packet.html#a48b867db11d2bbd7315e2855c13ab1bf">data</a>) == <a class="code" href="namespace_service_1_1_n_w_m.html#a2fc2dee0d5c58ef8768b4c450f650c65">EAPoLStartMagic</a>) {</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a>.<a class="code" href="struct_service_1_1_n_w_m_1_1_connection_status.html#a06757367dc9053bdb0f13218ddfdc90c">status</a> != static_cast&lt;u32&gt;(<a class="code" href="namespace_service_1_1_n_w_m.html#a314d2573d77dfa9a69d021eb31ee2d64a1bacb914b9ecea50415b08ba2d438cc6">NetworkStatus::ConnectedAsHost</a>)) {</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;            <a class="code" href="log_8h.html#add982f3fbcbb8bfd9e729ab9356efb34">LOG_DEBUG</a>(Service_NWM, <span class="stringliteral">&quot;Connection sequence aborted, because connection status is {}&quot;</span>,</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                      <a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a>.<a class="code" href="struct_service_1_1_n_w_m_1_1_connection_status.html#a06757367dc9053bdb0f13218ddfdc90c">status</a>);</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        }</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        <span class="keyword">auto</span> node = <a class="code" href="namespace_service_1_1_n_w_m.html#a94a14466865b6846cf049524147b52b0">DeserializeNodeInfoFromFrame</a>(packet.<a class="code" href="struct_network_1_1_wifi_packet.html#a48b867db11d2bbd7315e2855c13ab1bf">data</a>);</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a>.<a class="code" href="struct_service_1_1_n_w_m_1_1_connection_status.html#a1316e3ca28f939ea4453649235c14a4e">max_nodes</a> == <a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a>.<a class="code" href="struct_service_1_1_n_w_m_1_1_connection_status.html#abb6fb689a303df1553ff4a76e0028888">total_nodes</a>) {</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;            <span class="comment">// Reject connection attempt</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;            <a class="code" href="log_8h.html#a2f872ec42bda0e5baf8783313a28494c">LOG_ERROR</a>(Service_NWM, <span class="stringliteral">&quot;Reached maximum nodes, but reject packet wasn&#39;t sent.&quot;</span>);</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;            <span class="comment">// TODO(B3N30): Figure out what packet is sent here</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        }</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        <span class="comment">// Get an unused network node id</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        <a class="code" href="common__types_8h.html#a917e58b0692c2df778a27350534cbfe7">u16</a> node_id = <a class="code" href="namespace_service_1_1_n_w_m.html#a178bbf8dd6a12282d613d95aee419040">GetNextAvailableNodeId</a>();</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        node.network_node_id = node_id;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        <a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a>.<a class="code" href="struct_service_1_1_n_w_m_1_1_connection_status.html#a2db87e8db746a74c27e1785c58e40cb0">node_bitmask</a> |= 1 &lt;&lt; (node_id - 1);</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        <a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a>.<a class="code" href="struct_service_1_1_n_w_m_1_1_connection_status.html#a9d333528ec44be3e2c30011490e9701d">changed_nodes</a> |= 1 &lt;&lt; (node_id - 1);</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        <a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a>.<a class="code" href="struct_service_1_1_n_w_m_1_1_connection_status.html#a350f538191a8b78051f3161d4e49440d">nodes</a>[node_id - 1] = node.network_node_id;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        <a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a>.<a class="code" href="struct_service_1_1_n_w_m_1_1_connection_status.html#abb6fb689a303df1553ff4a76e0028888">total_nodes</a>++;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        <a class="code" href="common__types_8h.html#a254d32383658e016368673396e7afc1b">u8</a> current_nodes = network_info.<a class="code" href="struct_service_1_1_n_w_m_1_1_network_info.html#a8cf9b7de67292d2e626ecad3de82ffab">total_nodes</a>;</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        node_info[current_nodes] = node;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        network_info.<a class="code" href="struct_service_1_1_n_w_m_1_1_network_info.html#a8cf9b7de67292d2e626ecad3de82ffab">total_nodes</a>++;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        node_map[packet.<a class="code" href="struct_network_1_1_wifi_packet.html#af52e496f816ac80521b2328294c07ffa">transmitter_address</a>] = node.network_node_id;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        <a class="code" href="namespace_service_1_1_n_w_m.html#a91fbeaa6b7edaf5eff2a57306b86571e">BroadcastNodeMap</a>();</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        <span class="comment">// Send the EAPoL-Logoff packet.</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        <span class="keyword">using</span> <a class="code" href="struct_network_1_1_wifi_packet.html">Network::WifiPacket</a>;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        WifiPacket eapol_logoff{};</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        eapol_logoff.<a class="code" href="struct_network_1_1_wifi_packet.html#ae6f9dbe04ee6b8039f6b43601c6cd05c">channel</a> = <a class="code" href="namespace_service_1_1_n_w_m.html#a623a500ff8b4c3f1c93be76297039f1a">network_channel</a>;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        eapol_logoff.data =</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;            <a class="code" href="namespace_service_1_1_n_w_m.html#aa5afda8b42249b5e3ca4e878132b5f35">GenerateEAPoLLogoffFrame</a>(packet.<a class="code" href="struct_network_1_1_wifi_packet.html#af52e496f816ac80521b2328294c07ffa">transmitter_address</a>, node.network_node_id, node_info,</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                                     network_info.<a class="code" href="struct_service_1_1_n_w_m_1_1_network_info.html#a769ed02f16d54595754344c23d4e21f2">max_nodes</a>, network_info.<a class="code" href="struct_service_1_1_n_w_m_1_1_network_info.html#a8cf9b7de67292d2e626ecad3de82ffab">total_nodes</a>);</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        <span class="comment">// TODO(Subv): Encrypt the packet.</span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        <span class="comment">// TODO(B3N30): send the eapol packet just to the new client and implement a proper</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        <span class="comment">// broadcast packet for all other clients</span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        <span class="comment">// On a 3ds the eapol packet is only sent to packet.transmitter_address</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        <span class="comment">// while a packet containing the node information is broadcasted</span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        <span class="comment">// For now we will broadcast the eapol packet instead</span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        eapol_logoff.destination_address = <a class="code" href="namespace_network.html#a8591cf445700107127c0f2bf46365e88">Network::BroadcastMac</a>;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        eapol_logoff.type = WifiPacket::PacketType::Data;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        <a class="code" href="namespace_service_1_1_n_w_m.html#aab843dbb97d49e6d10a14bcca9fc715c">SendPacket</a>(eapol_logoff);</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        connection_status_event-&gt;Signal();</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a>.<a class="code" href="struct_service_1_1_n_w_m_1_1_connection_status.html#a06757367dc9053bdb0f13218ddfdc90c">status</a> == static_cast&lt;u32&gt;(<a class="code" href="namespace_service_1_1_n_w_m.html#a314d2573d77dfa9a69d021eb31ee2d64ae321c53b354930ba96f0243e652df458">NetworkStatus::Connecting</a>)) {</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        <span class="keyword">auto</span> logoff = <a class="code" href="namespace_service_1_1_n_w_m.html#a85aa62edb6a5318814d964da561bf776">ParseEAPoLLogoffFrame</a>(packet.<a class="code" href="struct_network_1_1_wifi_packet.html#a48b867db11d2bbd7315e2855c13ab1bf">data</a>);</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        network_info.<a class="code" href="struct_service_1_1_n_w_m_1_1_network_info.html#a2a29d90219373c16a753cc4ce7496d69">host_mac_address</a> = packet.<a class="code" href="struct_network_1_1_wifi_packet.html#af52e496f816ac80521b2328294c07ffa">transmitter_address</a>;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        network_info.<a class="code" href="struct_service_1_1_n_w_m_1_1_network_info.html#a8cf9b7de67292d2e626ecad3de82ffab">total_nodes</a> = logoff.connected_nodes;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        network_info.<a class="code" href="struct_service_1_1_n_w_m_1_1_network_info.html#a769ed02f16d54595754344c23d4e21f2">max_nodes</a> = logoff.max_nodes;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        <a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a>.<a class="code" href="struct_service_1_1_n_w_m_1_1_connection_status.html#a0ece6d8ec29eea3c29718d747910f8d0">network_node_id</a> = logoff.assigned_node_id;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        <a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a>.<a class="code" href="struct_service_1_1_n_w_m_1_1_connection_status.html#abb6fb689a303df1553ff4a76e0028888">total_nodes</a> = logoff.connected_nodes;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        <a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a>.<a class="code" href="struct_service_1_1_n_w_m_1_1_connection_status.html#a1316e3ca28f939ea4453649235c14a4e">max_nodes</a> = logoff.max_nodes;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        node_info.clear();</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        node_info.reserve(network_info.<a class="code" href="struct_service_1_1_n_w_m_1_1_network_info.html#a769ed02f16d54595754344c23d4e21f2">max_nodes</a>);</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        <span class="keywordflow">for</span> (std::size_t index{}; index &lt; logoff.connected_nodes; ++index) {</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;            <a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a>.<a class="code" href="struct_service_1_1_n_w_m_1_1_connection_status.html#a2db87e8db746a74c27e1785c58e40cb0">node_bitmask</a> |= 1 &lt;&lt; index;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;            <a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a>.<a class="code" href="struct_service_1_1_n_w_m_1_1_connection_status.html#a9d333528ec44be3e2c30011490e9701d">changed_nodes</a> |= 1 &lt;&lt; index;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;            <a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a>.<a class="code" href="struct_service_1_1_n_w_m_1_1_connection_status.html#a350f538191a8b78051f3161d4e49440d">nodes</a>[index] = logoff.nodes[index].network_node_id;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;            node_info.emplace_back(<a class="code" href="namespace_service_1_1_n_w_m.html#a103b54629406e058fb318ab165116320">DeserializeNodeInfo</a>(logoff.nodes[index]));</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        }</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        <span class="comment">// We&#39;re now connected, signal the application</span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        <a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a>.<a class="code" href="struct_service_1_1_n_w_m_1_1_connection_status.html#a06757367dc9053bdb0f13218ddfdc90c">status</a> = <span class="keyword">static_cast&lt;</span><a class="code" href="common__types_8h.html#a65cf28726f89e62ccf2f1354bc2716df">u32</a><span class="keyword">&gt;</span>(<a class="code" href="namespace_service_1_1_n_w_m.html#a314d2573d77dfa9a69d021eb31ee2d64ac10c2f98fd4e55ef8dc130ebe5347121">NetworkStatus::ConnectedAsClient</a>);</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        <span class="comment">// Some games require ConnectToNetwork to block, for now it doesn&#39;t</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        <span class="comment">// If blocking is implemented this lock needs to be changed,</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        <span class="comment">// otherwise it might cause deadlocks</span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        connection_status_event-&gt;Signal();</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        connection_event-&gt;Signal();</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a>.<a class="code" href="struct_service_1_1_n_w_m_1_1_connection_status.html#a06757367dc9053bdb0f13218ddfdc90c">status</a> == static_cast&lt;u32&gt;(<a class="code" href="namespace_service_1_1_n_w_m.html#a314d2573d77dfa9a69d021eb31ee2d64ac10c2f98fd4e55ef8dc130ebe5347121">NetworkStatus::ConnectedAsClient</a>)) {</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        <span class="comment">// On a 3ds this packet wouldn&#39;t be addressed to already connected clients</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        <span class="comment">// We use this information because in the current implementation the host</span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        <span class="comment">// isn&#39;t broadcasting the node information</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        <span class="keyword">auto</span> logoff = <a class="code" href="namespace_service_1_1_n_w_m.html#a85aa62edb6a5318814d964da561bf776">ParseEAPoLLogoffFrame</a>(packet.<a class="code" href="struct_network_1_1_wifi_packet.html#a48b867db11d2bbd7315e2855c13ab1bf">data</a>);</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        network_info.<a class="code" href="struct_service_1_1_n_w_m_1_1_network_info.html#a8cf9b7de67292d2e626ecad3de82ffab">total_nodes</a> = logoff.connected_nodes;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        <a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a>.<a class="code" href="struct_service_1_1_n_w_m_1_1_connection_status.html#abb6fb689a303df1553ff4a76e0028888">total_nodes</a> = logoff.connected_nodes;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        node_info.clear();</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        node_info.reserve(network_info.<a class="code" href="struct_service_1_1_n_w_m_1_1_network_info.html#a769ed02f16d54595754344c23d4e21f2">max_nodes</a>);</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        <span class="keywordflow">for</span> (std::size_t index{}; index &lt; logoff.connected_nodes; ++index) {</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;            <span class="keywordflow">if</span> ((<a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a>.<a class="code" href="struct_service_1_1_n_w_m_1_1_connection_status.html#a2db87e8db746a74c27e1785c58e40cb0">node_bitmask</a> &amp; (1 &lt;&lt; index)) == 0) {</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                <a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a>.<a class="code" href="struct_service_1_1_n_w_m_1_1_connection_status.html#a9d333528ec44be3e2c30011490e9701d">changed_nodes</a> |= 1 &lt;&lt; index;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;            }</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;            <a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a>.<a class="code" href="struct_service_1_1_n_w_m_1_1_connection_status.html#a350f538191a8b78051f3161d4e49440d">nodes</a>[index] = logoff.nodes[index].network_node_id;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;            <a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a>.<a class="code" href="struct_service_1_1_n_w_m_1_1_connection_status.html#a2db87e8db746a74c27e1785c58e40cb0">node_bitmask</a> |= 1 &lt;&lt; index;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;            node_info.emplace_back(<a class="code" href="namespace_service_1_1_n_w_m.html#a103b54629406e058fb318ab165116320">DeserializeNodeInfo</a>(logoff.nodes[index]));</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        }</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        connection_status_event-&gt;Signal();</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    }</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;}</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;</div><div class="line"><a name="l00346"></a><span class="lineno"><a class="line" href="namespace_service_1_1_n_w_m.html#ac3768635cdf1d1f24881988e0f0ccbfa">  346</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="namespace_service_1_1_n_w_m.html#ac3768635cdf1d1f24881988e0f0ccbfa">HandleSecureDataPacket</a>(<span class="keyword">const</span> <a class="code" href="struct_network_1_1_wifi_packet.html">Network::WifiPacket</a>&amp; packet) {</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="keyword">auto</span> secure_data = <a class="code" href="namespace_service_1_1_n_w_m.html#aee52175e01a75b74f42fd3810953a0a3">ParseSecureDataHeader</a>(packet.<a class="code" href="struct_network_1_1_wifi_packet.html#a48b867db11d2bbd7315e2855c13ab1bf">data</a>);</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    std::unique_lock&lt;std::recursive_mutex&gt; hle_lock{<a class="code" href="namespace_h_l_e.html#acbdcc3b0ea2929dbf52e25ced9529d39">HLE::g_hle_lock</a>, std::defer_lock};</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    std::unique_lock&lt;std::mutex&gt; lock{<a class="code" href="namespace_service_1_1_n_w_m.html#a1607ea35acaa873bc8554c269c90e0b3">connection_status_mutex</a>, std::defer_lock};</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    std::lock(hle_lock, lock);</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="keywordflow">if</span> (secure_data.src_node_id == <a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a>.<a class="code" href="struct_service_1_1_n_w_m_1_1_connection_status.html#a0ece6d8ec29eea3c29718d747910f8d0">network_node_id</a>) {</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        <span class="comment">// Ignore packets that came from ourselves.</span></div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    }</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="keywordflow">if</span> (secure_data.dest_node_id != <a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a>.<a class="code" href="struct_service_1_1_n_w_m_1_1_connection_status.html#a0ece6d8ec29eea3c29718d747910f8d0">network_node_id</a> &amp;&amp;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        secure_data.dest_node_id != <a class="code" href="namespace_service_1_1_n_w_m.html#a0dde7396fe6df5c5f3f57972cf98203f">BroadcastNetworkNodeId</a>) {</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        <span class="comment">// The packet wasn&#39;t addressed to us, we can only act as a router if we&#39;re the host.</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        <span class="comment">// However, we might have received this packet due to a broadcast from the host, in that</span></div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        <span class="comment">// case just ignore it.</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        <a class="code" href="assert_8h.html#a4b432fb3d47e2ca732caf965691a54d7">ASSERT_MSG</a>(packet.<a class="code" href="struct_network_1_1_wifi_packet.html#a2e7fb70d17f8a7c96af404744cfc555d">destination_address</a> == <a class="code" href="namespace_network.html#a8591cf445700107127c0f2bf46365e88">Network::BroadcastMac</a> ||</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                       <a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a>.<a class="code" href="struct_service_1_1_n_w_m_1_1_connection_status.html#a06757367dc9053bdb0f13218ddfdc90c">status</a> == static_cast&lt;u32&gt;(<a class="code" href="namespace_service_1_1_n_w_m.html#a314d2573d77dfa9a69d021eb31ee2d64a1bacb914b9ecea50415b08ba2d438cc6">NetworkStatus::ConnectedAsHost</a>),</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                   <span class="stringliteral">&quot;Can&#39;t be a router if we&#39;re not a host&quot;</span>);</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a>.<a class="code" href="struct_service_1_1_n_w_m_1_1_connection_status.html#a06757367dc9053bdb0f13218ddfdc90c">status</a> == static_cast&lt;u32&gt;(<a class="code" href="namespace_service_1_1_n_w_m.html#a314d2573d77dfa9a69d021eb31ee2d64a1bacb914b9ecea50415b08ba2d438cc6">NetworkStatus::ConnectedAsHost</a>) &amp;&amp;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;            secure_data.dest_node_id != <a class="code" href="namespace_service_1_1_n_w_m.html#a0dde7396fe6df5c5f3f57972cf98203f">BroadcastNetworkNodeId</a>) {</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;            <span class="comment">// Broadcast the packet so the right receiver can get it.</span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;            <span class="comment">// TODO(B3N30): Is there a flag that makes this kind of routing be unicast instead of</span></div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;            <span class="comment">// multicast? Perhaps this is a way to allow spectators to see some of the packets.</span></div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;            <a class="code" href="struct_network_1_1_wifi_packet.html">Network::WifiPacket</a> out_packet{packet};</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;            out_packet.<a class="code" href="struct_network_1_1_wifi_packet.html#a2e7fb70d17f8a7c96af404744cfc555d">destination_address</a> = <a class="code" href="namespace_network.html#a8591cf445700107127c0f2bf46365e88">Network::BroadcastMac</a>;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;            <a class="code" href="namespace_service_1_1_n_w_m.html#aab843dbb97d49e6d10a14bcca9fc715c">SendPacket</a>(out_packet);</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        }</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    }</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="comment">// The packet is addressed to us (or to everyone using the broadcast node id), handle it.</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <span class="comment">// TODO(B3N30): We don&#39;t currently send nor handle management frames.</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <a class="code" href="assert_8h.html#a9f920d5e0c0e8780d4ce9bfb15bfd9e2">ASSERT</a>(!secure_data.is_management);</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="comment">// TODO(B3N30): Allow more than one bind node per channel.</span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="keyword">auto</span> channel_info{channel_data.find(secure_data.data_channel)};</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="comment">// Ignore packets from channels we&#39;re not interested in.</span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="keywordflow">if</span> (channel_info == channel_data.end())</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="keywordflow">if</span> (channel_info-&gt;second.network_node_id != <a class="code" href="namespace_service_1_1_n_w_m.html#a0dde7396fe6df5c5f3f57972cf98203f">BroadcastNetworkNodeId</a> &amp;&amp;</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        channel_info-&gt;second.network_node_id != secure_data.src_node_id)</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <span class="comment">// Add the received packet to the data queue.</span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    channel_info-&gt;second.received_packets.emplace_back(packet.<a class="code" href="struct_network_1_1_wifi_packet.html#a48b867db11d2bbd7315e2855c13ab1bf">data</a>);</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <span class="comment">// Signal the data event. We can do this directly because we locked g_hle_lock</span></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    channel_info-&gt;second.event-&gt;Signal();</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;}</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="comment"> * Start a connection sequence with an UDS server. The sequence starts by sending an 802.11</span></div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="comment"> * authentication frame with SEQ1.</span></div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00403"></a><span class="lineno"><a class="line" href="namespace_service_1_1_n_w_m.html#a26061cab82222e36674d12abb22246f9">  403</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespace_service_1_1_n_w_m.html#a26061cab82222e36674d12abb22246f9">StartConnectionSequence</a>(<span class="keyword">const</span> <a class="code" href="namespace_service_1_1_n_w_m.html#ab12fda5a2bfd7850870f7b03fcc21e72">MacAddress</a>&amp; server) {</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="keyword">using</span> <a class="code" href="struct_network_1_1_wifi_packet.html">Network::WifiPacket</a>;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    WifiPacket auth_request{};</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    {</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        std::lock_guard&lt;std::mutex&gt; lock{connection_status_mutex};</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        <a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a>.<a class="code" href="struct_service_1_1_n_w_m_1_1_connection_status.html#a06757367dc9053bdb0f13218ddfdc90c">status</a> = <span class="keyword">static_cast&lt;</span><a class="code" href="common__types_8h.html#a65cf28726f89e62ccf2f1354bc2716df">u32</a><span class="keyword">&gt;</span>(<a class="code" href="namespace_service_1_1_n_w_m.html#a314d2573d77dfa9a69d021eb31ee2d64ae321c53b354930ba96f0243e652df458">NetworkStatus::Connecting</a>);</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        <span class="comment">// TODO(Subv): Handle timeout.</span></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;        <span class="comment">// Send an authentication frame with SEQ1</span></div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;        auth_request.channel = <a class="code" href="namespace_service_1_1_n_w_m.html#a623a500ff8b4c3f1c93be76297039f1a">network_channel</a>;</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        auth_request.data = <a class="code" href="namespace_service_1_1_n_w_m.html#aaff74c7747aa4eeeda54466f8407ef02">GenerateAuthenticationFrame</a>(<a class="code" href="namespace_service_1_1_n_w_m.html#aae62a987ff6f4603fe91fc442bd11381af36c817f45dc37d3738a7ebe34aa4d26">AuthenticationSeq::SEQ1</a>);</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;        auth_request.destination_address = server;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        auth_request.type = WifiPacket::PacketType::Authentication;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    }</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <a class="code" href="namespace_service_1_1_n_w_m.html#aab843dbb97d49e6d10a14bcca9fc715c">SendPacket</a>(auth_request);</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;}</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;</div><div class="line"><a name="l00423"></a><span class="lineno"><a class="line" href="namespace_service_1_1_n_w_m.html#aa984a695334088d118dadc59061cd6c8">  423</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespace_service_1_1_n_w_m.html#aa984a695334088d118dadc59061cd6c8">SendAssociationResponseFrame</a>(<span class="keyword">const</span> <a class="code" href="namespace_service_1_1_n_w_m.html#ab12fda5a2bfd7850870f7b03fcc21e72">MacAddress</a>&amp; address) {</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="keyword">using</span> <a class="code" href="struct_network_1_1_wifi_packet.html">Network::WifiPacket</a>;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    WifiPacket assoc_response{};</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    {</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        std::lock_guard&lt;std::mutex&gt; lock{connection_status_mutex};</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a>.<a class="code" href="struct_service_1_1_n_w_m_1_1_connection_status.html#a06757367dc9053bdb0f13218ddfdc90c">status</a> != static_cast&lt;u32&gt;(<a class="code" href="namespace_service_1_1_n_w_m.html#a314d2573d77dfa9a69d021eb31ee2d64a1bacb914b9ecea50415b08ba2d438cc6">NetworkStatus::ConnectedAsHost</a>)) {</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;            <a class="code" href="log_8h.html#a2f872ec42bda0e5baf8783313a28494c">LOG_ERROR</a>(Service_NWM, <span class="stringliteral">&quot;Connection sequence aborted, because connection status is {}&quot;</span>,</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                      <a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a>.<a class="code" href="struct_service_1_1_n_w_m_1_1_connection_status.html#a06757367dc9053bdb0f13218ddfdc90c">status</a>);</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        }</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        assoc_response.channel = <a class="code" href="namespace_service_1_1_n_w_m.html#a623a500ff8b4c3f1c93be76297039f1a">network_channel</a>;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        <span class="comment">// TODO(Subv): This will cause multiple clients to end up with the same association id, but</span></div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        <span class="comment">// we&#39;re not using that for anything.</span></div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        <a class="code" href="common__types_8h.html#a917e58b0692c2df778a27350534cbfe7">u16</a> association_id{1};</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        assoc_response.data = <a class="code" href="namespace_service_1_1_n_w_m.html#a4141d30a643a47a800519c0087b18e08">GenerateAssocResponseFrame</a>(<a class="code" href="namespace_service_1_1_n_w_m.html#a685f6f9337a209488e57af85c6dd2d85a30ae8fff8898dc197acd49d9c0797d20">AssocStatus::Successful</a>, association_id,</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                                                         network_info.<a class="code" href="struct_service_1_1_n_w_m_1_1_network_info.html#a1c1a79becdfc2ef4954e2de85ca2c976">network_id</a>);</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        assoc_response.destination_address = address;</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        assoc_response.type = WifiPacket::PacketType::AssociationResponse;</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    }</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    <a class="code" href="namespace_service_1_1_n_w_m.html#aab843dbb97d49e6d10a14bcca9fc715c">SendPacket</a>(assoc_response);</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;}</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="comment"> * Handles the authentication request frame and sends the authentication response and association</span></div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="comment"> * response frames. Once an Authentication frame with SEQ1 is received by the server, it responds</span></div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="comment"> * with an Authentication frame containing SEQ2, and immediately sends an Association response frame</span></div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="comment"> * containing the details of the access point and the assigned association id for the new client.</span></div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00454"></a><span class="lineno"><a class="line" href="namespace_service_1_1_n_w_m.html#acc28a753b636cdb61712a86275046f62">  454</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespace_service_1_1_n_w_m.html#acc28a753b636cdb61712a86275046f62">HandleAuthenticationFrame</a>(<span class="keyword">const</span> <a class="code" href="struct_network_1_1_wifi_packet.html">Network::WifiPacket</a>&amp; packet) {</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <span class="comment">// Only the SEQ1 auth frame is handled here, the SEQ2 frame doesn&#39;t need any special behavior</span></div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespace_service_1_1_n_w_m.html#a5675ebfd64003c2a6e656d0be7a26c4d">GetAuthenticationSeqNumber</a>(packet.<a class="code" href="struct_network_1_1_wifi_packet.html#a48b867db11d2bbd7315e2855c13ab1bf">data</a>) == <a class="code" href="namespace_service_1_1_n_w_m.html#aae62a987ff6f4603fe91fc442bd11381af36c817f45dc37d3738a7ebe34aa4d26">AuthenticationSeq::SEQ1</a>) {</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        <span class="keyword">using</span> <a class="code" href="struct_network_1_1_wifi_packet.html">Network::WifiPacket</a>;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        WifiPacket auth_request{};</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        {</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;            std::lock_guard&lt;std::mutex&gt; lock{connection_status_mutex};</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a>.<a class="code" href="struct_service_1_1_n_w_m_1_1_connection_status.html#a06757367dc9053bdb0f13218ddfdc90c">status</a> != static_cast&lt;u32&gt;(<a class="code" href="namespace_service_1_1_n_w_m.html#a314d2573d77dfa9a69d021eb31ee2d64a1bacb914b9ecea50415b08ba2d438cc6">NetworkStatus::ConnectedAsHost</a>)) {</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                <a class="code" href="log_8h.html#a2f872ec42bda0e5baf8783313a28494c">LOG_ERROR</a>(Service_NWM,</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                          <span class="stringliteral">&quot;Connection sequence aborted, because connection status is {}&quot;</span>,</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                          <a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a>.<a class="code" href="struct_service_1_1_n_w_m_1_1_connection_status.html#a06757367dc9053bdb0f13218ddfdc90c">status</a>);</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                <span class="keywordflow">return</span>;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;            }</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;            <span class="comment">// Respond with an authentication response frame with SEQ2</span></div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;            auth_request.channel = <a class="code" href="namespace_service_1_1_n_w_m.html#a623a500ff8b4c3f1c93be76297039f1a">network_channel</a>;</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;            auth_request.data = <a class="code" href="namespace_service_1_1_n_w_m.html#aaff74c7747aa4eeeda54466f8407ef02">GenerateAuthenticationFrame</a>(<a class="code" href="namespace_service_1_1_n_w_m.html#aae62a987ff6f4603fe91fc442bd11381ac2e447397f0d5365b1d3fcc38133ea9a">AuthenticationSeq::SEQ2</a>);</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;            auth_request.destination_address = packet.<a class="code" href="struct_network_1_1_wifi_packet.html#af52e496f816ac80521b2328294c07ffa">transmitter_address</a>;</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;            auth_request.type = WifiPacket::PacketType::Authentication;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        }</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;        <a class="code" href="namespace_service_1_1_n_w_m.html#aab843dbb97d49e6d10a14bcca9fc715c">SendPacket</a>(auth_request);</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;        <a class="code" href="namespace_service_1_1_n_w_m.html#aa984a695334088d118dadc59061cd6c8">SendAssociationResponseFrame</a>(packet.<a class="code" href="struct_network_1_1_wifi_packet.html#af52e496f816ac80521b2328294c07ffa">transmitter_address</a>);</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    }</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;}</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;</div><div class="line"><a name="l00481"></a><span class="lineno"><a class="line" href="namespace_service_1_1_n_w_m.html#a697fb6a6cc6b75c33896def5690fde48">  481</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespace_service_1_1_n_w_m.html#a697fb6a6cc6b75c33896def5690fde48">HandleDeauthenticationFrame</a>(<span class="keyword">const</span> <a class="code" href="struct_network_1_1_wifi_packet.html">Network::WifiPacket</a>&amp; packet) {</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    std::unique_lock&lt;std::recursive_mutex&gt; hle_lock{<a class="code" href="namespace_h_l_e.html#acbdcc3b0ea2929dbf52e25ced9529d39">HLE::g_hle_lock</a>, std::defer_lock};</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    std::unique_lock&lt;std::mutex&gt; lock{<a class="code" href="namespace_service_1_1_n_w_m.html#a1607ea35acaa873bc8554c269c90e0b3">connection_status_mutex</a>, std::defer_lock};</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    std::lock(hle_lock, lock);</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a>.<a class="code" href="struct_service_1_1_n_w_m_1_1_connection_status.html#a06757367dc9053bdb0f13218ddfdc90c">status</a> != static_cast&lt;u32&gt;(<a class="code" href="namespace_service_1_1_n_w_m.html#a314d2573d77dfa9a69d021eb31ee2d64a1bacb914b9ecea50415b08ba2d438cc6">NetworkStatus::ConnectedAsHost</a>)) {</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        <a class="code" href="log_8h.html#a2f872ec42bda0e5baf8783313a28494c">LOG_ERROR</a>(Service_NWM, <span class="stringliteral">&quot;Got deauthentication frame but we are not the host&quot;</span>);</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    }</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <span class="keywordflow">if</span> (node_map.find(packet.<a class="code" href="struct_network_1_1_wifi_packet.html#af52e496f816ac80521b2328294c07ffa">transmitter_address</a>) == node_map.end()) {</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        <a class="code" href="log_8h.html#a2f872ec42bda0e5baf8783313a28494c">LOG_ERROR</a>(Service_NWM, <span class="stringliteral">&quot;Got deauthentication frame from unknown node&quot;</span>);</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    }</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <a class="code" href="common__types_8h.html#a917e58b0692c2df778a27350534cbfe7">u16</a> node_id = node_map[packet.<a class="code" href="struct_network_1_1_wifi_packet.html#af52e496f816ac80521b2328294c07ffa">transmitter_address</a>];</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <span class="keyword">auto</span> node = std::find_if(node_info.begin(), node_info.end(), [&amp;node_id](<span class="keyword">const</span> <a class="code" href="struct_service_1_1_n_w_m_1_1_node_info.html">NodeInfo</a>&amp; info) {</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        <span class="keywordflow">return</span> info.network_node_id == node_id;</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    });</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <a class="code" href="assert_8h.html#a9f920d5e0c0e8780d4ce9bfb15bfd9e2">ASSERT</a>(node != node_info.end());</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    <a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a>.<a class="code" href="struct_service_1_1_n_w_m_1_1_connection_status.html#a2db87e8db746a74c27e1785c58e40cb0">node_bitmask</a> &amp;= ~(1 &lt;&lt; (node_id - 1));</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a>.<a class="code" href="struct_service_1_1_n_w_m_1_1_connection_status.html#a9d333528ec44be3e2c30011490e9701d">changed_nodes</a> |= 1 &lt;&lt; (node_id - 1);</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    <a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a>.<a class="code" href="struct_service_1_1_n_w_m_1_1_connection_status.html#abb6fb689a303df1553ff4a76e0028888">total_nodes</a>--;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    network_info.<a class="code" href="struct_service_1_1_n_w_m_1_1_network_info.html#a8cf9b7de67292d2e626ecad3de82ffab">total_nodes</a>--;</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    connection_status_event-&gt;Signal();</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <a class="code" href="log_8h.html#add982f3fbcbb8bfd9e729ab9356efb34">LOG_DEBUG</a>(Service_NWM, <span class="stringliteral">&quot;called&quot;</span>);</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;}</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;</div><div class="line"><a name="l00510"></a><span class="lineno"><a class="line" href="namespace_service_1_1_n_w_m.html#aca480a7a2d96c7082b50ca01fbe0a00b">  510</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="namespace_service_1_1_n_w_m.html#aca480a7a2d96c7082b50ca01fbe0a00b">HandleDataFrame</a>(<span class="keyword">const</span> <a class="code" href="struct_network_1_1_wifi_packet.html">Network::WifiPacket</a>&amp; packet) {</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="namespace_service_1_1_n_w_m.html#afa54a85122325fb98c46c75ff1dc0df9">GetFrameEtherType</a>(packet.<a class="code" href="struct_network_1_1_wifi_packet.html#a48b867db11d2bbd7315e2855c13ab1bf">data</a>)) {</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespace_service_1_1_n_w_m.html#aaacd42de61b1338198e6097d11860547ab6189e2265d9602f92b4ed5c21c587b4">EtherType::EAPoL</a>:</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;        <a class="code" href="namespace_service_1_1_n_w_m.html#a67935288aed4bb0336843d027cfe7d97">HandleEAPoLPacket</a>(packet);</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespace_service_1_1_n_w_m.html#aaacd42de61b1338198e6097d11860547a9ba877d313bd415330d52f32ab2dc2c2">EtherType::SecureData</a>:</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        <a class="code" href="namespace_service_1_1_n_w_m.html#ac3768635cdf1d1f24881988e0f0ccbfa">HandleSecureDataPacket</a>(packet);</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    }</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;}</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;</div><div class="line"><a name="l00522"></a><span class="lineno"><a class="line" href="namespace_service_1_1_n_w_m.html#ad199ee024cf8380a02ba2e884f0892fc">  522</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespace_service_1_1_n_w_m.html#ad199ee024cf8380a02ba2e884f0892fc">OnWifiPacketReceived</a>(<span class="keyword">const</span> <a class="code" href="struct_network_1_1_wifi_packet.html">Network::WifiPacket</a>&amp; packet) {</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    <span class="keywordflow">switch</span> (packet.<a class="code" href="struct_network_1_1_wifi_packet.html#a2e1c47a15b934e3cbdfa404309353ede">type</a>) {</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="struct_network_1_1_wifi_packet.html#a9047c2d448a65b11b302c7e9d0870d39a3bd5571b2db43ea584bf8e7438434515">Network::WifiPacket::PacketType::Beacon</a>:</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;        <a class="code" href="namespace_service_1_1_n_w_m.html#a31d1ba9f2dedeb1ba5fb5588db9d1213">HandleBeaconFrame</a>(packet);</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="struct_network_1_1_wifi_packet.html#a9047c2d448a65b11b302c7e9d0870d39ac75f7811d70d17dbcd88e9d03752cbed">Network::WifiPacket::PacketType::Authentication</a>:</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;        <a class="code" href="namespace_service_1_1_n_w_m.html#acc28a753b636cdb61712a86275046f62">HandleAuthenticationFrame</a>(packet);</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="struct_network_1_1_wifi_packet.html#a9047c2d448a65b11b302c7e9d0870d39a8f968b9e03773487ba182105cd6f175d">Network::WifiPacket::PacketType::AssociationResponse</a>:</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;        <a class="code" href="namespace_service_1_1_n_w_m.html#a61b6e3afb7217166137c50bc88745baa">HandleAssociationResponseFrame</a>(packet);</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="struct_network_1_1_wifi_packet.html#a9047c2d448a65b11b302c7e9d0870d39af6068daa29dbb05a7ead1e3b5a48bbee">Network::WifiPacket::PacketType::Data</a>:</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;        <a class="code" href="namespace_service_1_1_n_w_m.html#aca480a7a2d96c7082b50ca01fbe0a00b">HandleDataFrame</a>(packet);</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="struct_network_1_1_wifi_packet.html#a9047c2d448a65b11b302c7e9d0870d39a825f958719f81a0837b34b763ec1eed4">Network::WifiPacket::PacketType::Deauthentication</a>:</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;        <a class="code" href="namespace_service_1_1_n_w_m.html#a697fb6a6cc6b75c33896def5690fde48">HandleDeauthenticationFrame</a>(packet);</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="struct_network_1_1_wifi_packet.html#a9047c2d448a65b11b302c7e9d0870d39a4cc567608b06d0cc686ac005ed880fab">Network::WifiPacket::PacketType::NodeMap</a>:</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        <a class="code" href="namespace_service_1_1_n_w_m.html#a15b266f19f1e4ea059e7466e583bc199">HandleNodeMapPacket</a>(packet);</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    }</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;}</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;</div><div class="line"><a name="l00545"></a><span class="lineno"><a class="line" href="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s.html#a885b4dd51b5ea87c65381ce72f9b84d5">  545</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s.html#a885b4dd51b5ea87c65381ce72f9b84d5">NWM_UDS::Shutdown</a>(<a class="code" href="class_kernel_1_1_h_l_e_request_context.html">Kernel::HLERequestContext</a>&amp; ctx) {</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    <a class="code" href="class_i_p_c_1_1_request_parser.html">IPC::RequestParser</a> rp{ctx, 0x03, 0, 0};</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> room_member{<a class="code" href="namespace_network.html#a5ee509b747f2af4c4110f7542a6efe8b">Network::GetRoomMember</a>().lock()})</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;        room_member-&gt;Unbind(wifi_packet_received);</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> bind_node : channel_data) {</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;        bind_node.second.event-&gt;Signal();</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    }</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    channel_data.clear();</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    node_map.clear();</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    recv_buffer_memory.reset();</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    <a class="code" href="class_i_p_c_1_1_response_builder.html">IPC::ResponseBuilder</a> rb{rp.MakeBuilder(1, 0)};</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    rb.<a class="code" href="class_i_p_c_1_1_response_builder.html#a12d9068ceac4de2e8c19e34ec42ce54e">Push</a>(<a class="code" href="result_8h.html#ac66ebacde94a19df5a65f34e8238cf79">RESULT_SUCCESS</a>);</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    <a class="code" href="log_8h.html#add982f3fbcbb8bfd9e729ab9356efb34">LOG_DEBUG</a>(Service_NWM, <span class="stringliteral">&quot;called&quot;</span>);</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;}</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;</div><div class="line"><a name="l00565"></a><span class="lineno"><a class="line" href="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s.html#a9f7afa7765a7161f808d14c36b9d1182">  565</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s.html#a9f7afa7765a7161f808d14c36b9d1182">NWM_UDS::RecvBeaconBroadcastData</a>(<a class="code" href="class_kernel_1_1_h_l_e_request_context.html">Kernel::HLERequestContext</a>&amp; ctx) {</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    <a class="code" href="class_i_p_c_1_1_request_parser.html">IPC::RequestParser</a> rp{ctx, 0x0F, 16, 4};</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    <a class="code" href="common__types_8h.html#a65cf28726f89e62ccf2f1354bc2716df">u32</a> out_buffer_size{rp.Pop&lt;<a class="code" href="common__types_8h.html#a65cf28726f89e62ccf2f1354bc2716df">u32</a>&gt;()};</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    <a class="code" href="common__types_8h.html#a65cf28726f89e62ccf2f1354bc2716df">u32</a> unk1{rp.Pop&lt;<a class="code" href="common__types_8h.html#a65cf28726f89e62ccf2f1354bc2716df">u32</a>&gt;()};</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    <a class="code" href="common__types_8h.html#a65cf28726f89e62ccf2f1354bc2716df">u32</a> unk2{rp.Pop&lt;<a class="code" href="common__types_8h.html#a65cf28726f89e62ccf2f1354bc2716df">u32</a>&gt;()};</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    <a class="code" href="namespace_service_1_1_n_w_m.html#ab12fda5a2bfd7850870f7b03fcc21e72">MacAddress</a> mac_address;</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    rp.PopRaw(mac_address);</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    rp.Skip(9, <span class="keyword">false</span>);</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    <a class="code" href="common__types_8h.html#a65cf28726f89e62ccf2f1354bc2716df">u32</a> wlan_comm_id{rp.Pop&lt;<a class="code" href="common__types_8h.html#a65cf28726f89e62ccf2f1354bc2716df">u32</a>&gt;()};</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    <a class="code" href="common__types_8h.html#a65cf28726f89e62ccf2f1354bc2716df">u32</a> <span class="keywordtype">id</span>{rp.Pop&lt;<a class="code" href="common__types_8h.html#a65cf28726f89e62ccf2f1354bc2716df">u32</a>&gt;()};</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    <span class="comment">// From 3dbrew:</span></div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    <span class="comment">// &#39;Official user processes create a new event handle which is then passed to this command.</span></div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    <span class="comment">// However, those user processes don&#39;t save that handle anywhere afterwards.&#39;</span></div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    <span class="comment">// So we don&#39;t save/use that event too.</span></div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    <a class="code" href="namespace_kernel.html#afc9bde79933dd23864df0768adeb6cfe">Kernel::SharedPtr&lt;Kernel::Event&gt;</a> input_event{rp.PopObject&lt;<a class="code" href="class_kernel_1_1_event.html">Kernel::Event</a>&gt;()};</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    <a class="code" href="class_kernel_1_1_mapped_buffer.html">Kernel::MappedBuffer</a> out_buffer{rp.PopMappedBuffer()};</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    <a class="code" href="assert_8h.html#a9f920d5e0c0e8780d4ce9bfb15bfd9e2">ASSERT</a>(out_buffer.GetSize() == out_buffer_size);</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    std::size_t cur_buffer_size = <span class="keyword">sizeof</span>(<a class="code" href="namespace_service_1_1_n_w_m.html#struct_service_1_1_n_w_m_1_1_beacon_data_reply_header">BeaconDataReplyHeader</a>);</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    <span class="comment">// Retrieve all beacon frames that were received from the desired mac address.</span></div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    <span class="keyword">auto</span> beacons = <a class="code" href="namespace_service_1_1_n_w_m.html#a09a8c3835b523982576400aaead788ee">GetReceivedBeacons</a>(mac_address);</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    <a class="code" href="namespace_service_1_1_n_w_m.html#struct_service_1_1_n_w_m_1_1_beacon_data_reply_header">BeaconDataReplyHeader</a> data_reply_header{};</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    data_reply_header.<a class="code" href="namespace_service_1_1_n_w_m.html#a40782c25f8e2245967fea19eb609f447">total_entries</a> = <span class="keyword">static_cast&lt;</span><a class="code" href="common__types_8h.html#a65cf28726f89e62ccf2f1354bc2716df">u32</a><span class="keyword">&gt;</span>(beacons.size());</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    data_reply_header.max_output_size = out_buffer_size;</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    <span class="comment">// Write each of the received beacons into the buffer</span></div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; beacon : beacons) {</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        <a class="code" href="struct_service_1_1_n_w_m_1_1_beacon_entry_header.html">BeaconEntryHeader</a> entry{};</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;        <span class="comment">// TODO(Subv): Figure out what this size is used for.</span></div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;        entry.<a class="code" href="struct_service_1_1_n_w_m_1_1_beacon_entry_header.html#a3a1670b74608c6a009900167b2710b39">unk_size</a> = <span class="keyword">static_cast&lt;</span><a class="code" href="common__types_8h.html#a65cf28726f89e62ccf2f1354bc2716df">u32</a><span class="keyword">&gt;</span>(<span class="keyword">sizeof</span>(<a class="code" href="struct_service_1_1_n_w_m_1_1_beacon_entry_header.html">BeaconEntryHeader</a>) + beacon.data.size());</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;        entry.total_size = <span class="keyword">static_cast&lt;</span><a class="code" href="common__types_8h.html#a65cf28726f89e62ccf2f1354bc2716df">u32</a><span class="keyword">&gt;</span>(<span class="keyword">sizeof</span>(<a class="code" href="struct_service_1_1_n_w_m_1_1_beacon_entry_header.html">BeaconEntryHeader</a>) + beacon.data.size());</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        entry.wifi_channel = beacon.channel;</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;        entry.header_size = <span class="keyword">sizeof</span>(<a class="code" href="struct_service_1_1_n_w_m_1_1_beacon_entry_header.html">BeaconEntryHeader</a>);</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;        entry.mac_address = beacon.transmitter_address;</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;        <a class="code" href="assert_8h.html#a9f920d5e0c0e8780d4ce9bfb15bfd9e2">ASSERT</a>(cur_buffer_size &lt; out_buffer_size);</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;        out_buffer.Write(&amp;entry, cur_buffer_size, <span class="keyword">sizeof</span>(<a class="code" href="struct_service_1_1_n_w_m_1_1_beacon_entry_header.html">BeaconEntryHeader</a>));</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;        cur_buffer_size += <span class="keyword">sizeof</span>(<a class="code" href="struct_service_1_1_n_w_m_1_1_beacon_entry_header.html">BeaconEntryHeader</a>);</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* beacon_data = beacon.data.data();</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;        out_buffer.Write(beacon_data, cur_buffer_size, beacon.data.size());</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;        cur_buffer_size += beacon.data.size();</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    }</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    <span class="comment">// Update the total size in the structure and write it to the buffer again.</span></div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    data_reply_header.total_size = <span class="keyword">static_cast&lt;</span><a class="code" href="common__types_8h.html#a65cf28726f89e62ccf2f1354bc2716df">u32</a><span class="keyword">&gt;</span>(cur_buffer_size);</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    out_buffer.Write(&amp;data_reply_header, 0, <span class="keyword">sizeof</span>(<a class="code" href="namespace_service_1_1_n_w_m.html#struct_service_1_1_n_w_m_1_1_beacon_data_reply_header">BeaconDataReplyHeader</a>));</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    <a class="code" href="class_i_p_c_1_1_response_builder.html">IPC::ResponseBuilder</a> rb{rp.MakeBuilder(1, 2)};</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    rb.<a class="code" href="class_i_p_c_1_1_response_builder.html#a12d9068ceac4de2e8c19e34ec42ce54e">Push</a>(<a class="code" href="result_8h.html#ac66ebacde94a19df5a65f34e8238cf79">RESULT_SUCCESS</a>);</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    rb.PushMappedBuffer(out_buffer);</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    <a class="code" href="log_8h.html#add982f3fbcbb8bfd9e729ab9356efb34">LOG_DEBUG</a>(Service_NWM,</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;              <span class="stringliteral">&quot;called, out_buffer_size=0x{:08X}, wlan_comm_id=0x{:08X}, id=0x{:08X},&quot;</span></div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;              <span class="stringliteral">&quot;unk1=0x{:08X}, unk2=0x{:08X}, offset={}&quot;</span>,</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;              out_buffer_size, wlan_comm_id, <span class="keywordtype">id</span>, unk1, unk2, cur_buffer_size);</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;}</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;</div><div class="line"><a name="l00630"></a><span class="lineno"><a class="line" href="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s.html#a4858cc14324340c8869896653f8278fc">  630</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s.html#a4858cc14324340c8869896653f8278fc">NWM_UDS::InitializeWithVersion</a>(<a class="code" href="class_kernel_1_1_h_l_e_request_context.html">Kernel::HLERequestContext</a>&amp; ctx) {</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    <a class="code" href="class_i_p_c_1_1_request_parser.html">IPC::RequestParser</a> rp{ctx, 0x1B, 12, 2};</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    <a class="code" href="common__types_8h.html#a65cf28726f89e62ccf2f1354bc2716df">u32</a> sharedmem_size{rp.Pop&lt;<a class="code" href="common__types_8h.html#a65cf28726f89e62ccf2f1354bc2716df">u32</a>&gt;()};</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    <span class="comment">// Update the node information with the data the game gave us.</span></div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    rp.PopRaw(current_node);</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    <a class="code" href="common__types_8h.html#a917e58b0692c2df778a27350534cbfe7">u16</a> version{rp.Pop&lt;<a class="code" href="common__types_8h.html#a917e58b0692c2df778a27350534cbfe7">u16</a>&gt;()};</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    recv_buffer_memory = rp.PopObject&lt;<a class="code" href="class_kernel_1_1_shared_memory.html">Kernel::SharedMemory</a>&gt;();</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    initialized = <span class="keyword">true</span>;</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    <a class="code" href="assert_8h.html#a4b432fb3d47e2ca732caf965691a54d7">ASSERT_MSG</a>(recv_buffer_memory-&gt;size == sharedmem_size, <span class="stringliteral">&quot;Invalid shared memory size.&quot;</span>);</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> room_member{<a class="code" href="namespace_network.html#a5ee509b747f2af4c4110f7542a6efe8b">Network::GetRoomMember</a>().lock()}) {</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;        wifi_packet_received = room_member-&gt;BindOnWifiPacketReceived(<a class="code" href="namespace_service_1_1_n_w_m.html#ad199ee024cf8380a02ba2e884f0892fc">OnWifiPacketReceived</a>);</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;        <a class="code" href="log_8h.html#a2f872ec42bda0e5baf8783313a28494c">LOG_ERROR</a>(Service_NWM, <span class="stringliteral">&quot;Network isn&#39;t initalized&quot;</span>);</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    }</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    {</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;        std::lock_guard&lt;std::mutex&gt; lock{connection_status_mutex};</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;        <span class="comment">// Reset the connection status, it contains all zeros after initialization,</span></div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;        <span class="comment">// except for the actual status value.</span></div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;        <a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a> = {};</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;        <a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a>.<a class="code" href="struct_service_1_1_n_w_m_1_1_connection_status.html#a06757367dc9053bdb0f13218ddfdc90c">status</a> = <span class="keyword">static_cast&lt;</span><a class="code" href="common__types_8h.html#a65cf28726f89e62ccf2f1354bc2716df">u32</a><span class="keyword">&gt;</span>(<a class="code" href="namespace_service_1_1_n_w_m.html#a314d2573d77dfa9a69d021eb31ee2d64a4075072d219e061ca0f3124f8fbef463">NetworkStatus::NotConnected</a>);</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;        node_info.clear();</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;        node_info.push_back(current_node);</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    }</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    <a class="code" href="class_i_p_c_1_1_response_builder.html">IPC::ResponseBuilder</a> rb{rp.MakeBuilder(1, 2)};</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    rb.<a class="code" href="class_i_p_c_1_1_response_builder.html#a12d9068ceac4de2e8c19e34ec42ce54e">Push</a>(<a class="code" href="result_8h.html#ac66ebacde94a19df5a65f34e8238cf79">RESULT_SUCCESS</a>);</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    rb.PushCopyObjects(connection_status_event);</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    <a class="code" href="log_8h.html#add982f3fbcbb8bfd9e729ab9356efb34">LOG_DEBUG</a>(Service_NWM, <span class="stringliteral">&quot;called sharedmem_size=0x{:08X}, version=0x{:08X}&quot;</span>, sharedmem_size,</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;              version);</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;}</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;</div><div class="line"><a name="l00671"></a><span class="lineno"><a class="line" href="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s.html#a2708bbf5784ff52cb255384150b06805">  671</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s.html#a2708bbf5784ff52cb255384150b06805">NWM_UDS::GetConnectionStatus</a>(<a class="code" href="class_kernel_1_1_h_l_e_request_context.html">Kernel::HLERequestContext</a>&amp; ctx) {</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    <a class="code" href="class_i_p_c_1_1_request_parser.html">IPC::RequestParser</a> rp{ctx, 0xB, 0, 0};</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    <a class="code" href="class_i_p_c_1_1_response_builder.html">IPC::ResponseBuilder</a> rb{rp.MakeBuilder(13, 0)};</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    rb.<a class="code" href="class_i_p_c_1_1_response_builder.html#a12d9068ceac4de2e8c19e34ec42ce54e">Push</a>(<a class="code" href="result_8h.html#ac66ebacde94a19df5a65f34e8238cf79">RESULT_SUCCESS</a>);</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    {</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;        std::lock_guard&lt;std::mutex&gt; lock{connection_status_mutex};</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;        rb.PushRaw(<a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a>);</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;        <span class="comment">// Reset the bitmask of changed nodes after each call to this</span></div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;        <span class="comment">// function to prevent falsely informing games of outstanding</span></div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;        <span class="comment">// changes in subsequent calls.</span></div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;        <span class="comment">// TODO(Subv): Find exactly where the NWM module resets this value.</span></div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;        <a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a>.<a class="code" href="struct_service_1_1_n_w_m_1_1_connection_status.html#a9d333528ec44be3e2c30011490e9701d">changed_nodes</a> = 0;</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    }</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    <a class="code" href="log_8h.html#add982f3fbcbb8bfd9e729ab9356efb34">LOG_DEBUG</a>(Service_NWM, <span class="stringliteral">&quot;called&quot;</span>);</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;}</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;</div><div class="line"><a name="l00690"></a><span class="lineno"><a class="line" href="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s.html#a15c222781eb74ac8117aaa7cca86db4b">  690</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s.html#a15c222781eb74ac8117aaa7cca86db4b">NWM_UDS::GetNodeInformation</a>(<a class="code" href="class_kernel_1_1_h_l_e_request_context.html">Kernel::HLERequestContext</a>&amp; ctx) {</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    <a class="code" href="class_i_p_c_1_1_request_parser.html">IPC::RequestParser</a> rp{ctx, 0xD, 1, 0};</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    <a class="code" href="common__types_8h.html#a917e58b0692c2df778a27350534cbfe7">u16</a> network_node_id{rp.Pop&lt;<a class="code" href="common__types_8h.html#a917e58b0692c2df778a27350534cbfe7">u16</a>&gt;()};</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    <span class="keywordflow">if</span> (!initialized) {</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;        <a class="code" href="class_i_p_c_1_1_response_builder.html">IPC::ResponseBuilder</a> rb{rp.MakeBuilder(1, 0)};</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;        rb.<a class="code" href="class_i_p_c_1_1_response_builder.html#a12d9068ceac4de2e8c19e34ec42ce54e">Push</a>(<a class="code" href="union_result_code.html">ResultCode</a>(<a class="code" href="result_8h.html#afe30fc4506a4cf2ee780b2319dbec74da9646ad3a1c3e708b4fa8b4b4270fbab6">ErrorDescription::NotInitialized</a>, <a class="code" href="result_8h.html#a67158ef38e1ab9113151768007433e3aadb568ddcb8d3308155f19bdbadf655ca">ErrorModule::UDS</a>,</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;                           <a class="code" href="result_8h.html#a1d3c3229b2c38b6fe717b434732c5b86a219a93c69d452d35797d93e2cbe39ba2">ErrorSummary::StatusChanged</a>, <a class="code" href="result_8h.html#aa3b9056eb03ec4e7c3561192eb830739aec53a8c4f07baed5d8825072c89799be">ErrorLevel::Status</a>));</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    }</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    {</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;        std::lock_guard&lt;std::mutex&gt; lock{connection_status_mutex};</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;        <span class="keyword">auto</span> itr = std::find_if(node_info.begin(), node_info.end(),</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;                                [network_node_id](<span class="keyword">const</span> <a class="code" href="struct_service_1_1_n_w_m_1_1_node_info.html">NodeInfo</a>&amp; node) {</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;                                    <span class="keywordflow">return</span> node.network_node_id == network_node_id;</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;                                });</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;        <span class="keywordflow">if</span> (itr == node_info.end()) {</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;            <a class="code" href="class_i_p_c_1_1_response_builder.html">IPC::ResponseBuilder</a> rb{rp.MakeBuilder(1, 0)};</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;            rb.<a class="code" href="class_i_p_c_1_1_response_builder.html#a12d9068ceac4de2e8c19e34ec42ce54e">Push</a>(<a class="code" href="union_result_code.html">ResultCode</a>(<a class="code" href="result_8h.html#afe30fc4506a4cf2ee780b2319dbec74da38c300f4fc9ce8a77aad4a30de05cad8">ErrorDescription::NotFound</a>, <a class="code" href="result_8h.html#a67158ef38e1ab9113151768007433e3aadb568ddcb8d3308155f19bdbadf655ca">ErrorModule::UDS</a>,</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;                               <a class="code" href="result_8h.html#a1d3c3229b2c38b6fe717b434732c5b86a5a738160747f39c20e9f65416931c974">ErrorSummary::WrongArgument</a>, <a class="code" href="result_8h.html#aa3b9056eb03ec4e7c3561192eb830739aec53a8c4f07baed5d8825072c89799be">ErrorLevel::Status</a>));</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;        }</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;        <a class="code" href="class_i_p_c_1_1_response_builder.html">IPC::ResponseBuilder</a> rb{rp.MakeBuilder(11, 0)};</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;        rb.<a class="code" href="class_i_p_c_1_1_response_builder.html#a12d9068ceac4de2e8c19e34ec42ce54e">Push</a>(<a class="code" href="result_8h.html#ac66ebacde94a19df5a65f34e8238cf79">RESULT_SUCCESS</a>);</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;        rb.PushRaw&lt;<a class="code" href="struct_service_1_1_n_w_m_1_1_node_info.html">NodeInfo</a>&gt;(*itr);</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    }</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    <a class="code" href="log_8h.html#add982f3fbcbb8bfd9e729ab9356efb34">LOG_DEBUG</a>(Service_NWM, <span class="stringliteral">&quot;called&quot;</span>);</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;}</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;</div><div class="line"><a name="l00722"></a><span class="lineno"><a class="line" href="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s.html#a81891c30c576a8bacfa2b30a135a3e50">  722</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s.html#a81891c30c576a8bacfa2b30a135a3e50">NWM_UDS::Bind</a>(<a class="code" href="class_kernel_1_1_h_l_e_request_context.html">Kernel::HLERequestContext</a>&amp; ctx) {</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;    <a class="code" href="class_i_p_c_1_1_request_parser.html">IPC::RequestParser</a> rp{ctx, 0x12, 4, 0};</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    <a class="code" href="common__types_8h.html#a65cf28726f89e62ccf2f1354bc2716df">u32</a> bind_node_id{rp.Pop&lt;<a class="code" href="common__types_8h.html#a65cf28726f89e62ccf2f1354bc2716df">u32</a>&gt;()};</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    <a class="code" href="common__types_8h.html#a65cf28726f89e62ccf2f1354bc2716df">u32</a> recv_buffer_size{rp.Pop&lt;<a class="code" href="common__types_8h.html#a65cf28726f89e62ccf2f1354bc2716df">u32</a>&gt;()};</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    <a class="code" href="common__types_8h.html#a254d32383658e016368673396e7afc1b">u8</a> data_channel{rp.Pop&lt;<a class="code" href="common__types_8h.html#a254d32383658e016368673396e7afc1b">u8</a>&gt;()};</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    <a class="code" href="common__types_8h.html#a917e58b0692c2df778a27350534cbfe7">u16</a> network_node_id{rp.Pop&lt;<a class="code" href="common__types_8h.html#a917e58b0692c2df778a27350534cbfe7">u16</a>&gt;()};</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    <span class="keywordflow">if</span> (data_channel == 0 || bind_node_id == 0) {</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;        <a class="code" href="class_i_p_c_1_1_response_builder.html">IPC::ResponseBuilder</a> rb{rp.MakeBuilder(1, 0)};</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;        rb.<a class="code" href="class_i_p_c_1_1_response_builder.html#a12d9068ceac4de2e8c19e34ec42ce54e">Push</a>(<a class="code" href="union_result_code.html">ResultCode</a>(<a class="code" href="result_8h.html#afe30fc4506a4cf2ee780b2319dbec74da418ec6476e1acd92e17681f4bd00e3a3">ErrorDescription::NotAuthorized</a>, <a class="code" href="result_8h.html#a67158ef38e1ab9113151768007433e3aadb568ddcb8d3308155f19bdbadf655ca">ErrorModule::UDS</a>,</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;                           <a class="code" href="result_8h.html#a1d3c3229b2c38b6fe717b434732c5b86a5a738160747f39c20e9f65416931c974">ErrorSummary::WrongArgument</a>, <a class="code" href="result_8h.html#aa3b9056eb03ec4e7c3561192eb830739ac64518704ce0c0d5501a45763f464276">ErrorLevel::Usage</a>));</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;        <a class="code" href="log_8h.html#a8b510d36fc8a109f98395ce9b6ada954">LOG_WARNING</a>(Service_NWM, <span class="stringliteral">&quot;data_channel = {}, bind_node_id = {}&quot;</span>, data_channel,</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;                    bind_node_id);</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    }</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    constexpr std::size_t MaxBindNodes = 16;</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    <span class="keywordflow">if</span> (channel_data.size() &gt;= MaxBindNodes) {</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;        <a class="code" href="class_i_p_c_1_1_response_builder.html">IPC::ResponseBuilder</a> rb{rp.MakeBuilder(1, 0)};</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;        rb.<a class="code" href="class_i_p_c_1_1_response_builder.html#a12d9068ceac4de2e8c19e34ec42ce54e">Push</a>(<a class="code" href="union_result_code.html">ResultCode</a>(<a class="code" href="result_8h.html#afe30fc4506a4cf2ee780b2319dbec74dab498327feeb51430af73e07deac268fd">ErrorDescription::OutOfMemory</a>, <a class="code" href="result_8h.html#a67158ef38e1ab9113151768007433e3aadb568ddcb8d3308155f19bdbadf655ca">ErrorModule::UDS</a>,</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;                           <a class="code" href="result_8h.html#a1d3c3229b2c38b6fe717b434732c5b86a35b3173cfe5dc3a49584a9b809982d1c">ErrorSummary::OutOfResource</a>, <a class="code" href="result_8h.html#aa3b9056eb03ec4e7c3561192eb830739aec53a8c4f07baed5d8825072c89799be">ErrorLevel::Status</a>));</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;        <a class="code" href="log_8h.html#a8b510d36fc8a109f98395ce9b6ada954">LOG_WARNING</a>(Service_NWM, <span class="stringliteral">&quot;max bind nodes&quot;</span>);</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    }</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    constexpr <a class="code" href="common__types_8h.html#a65cf28726f89e62ccf2f1354bc2716df">u32</a> MinRecvBufferSize = 0x5F4;</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    <span class="keywordflow">if</span> (recv_buffer_size &lt; MinRecvBufferSize) {</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;        <a class="code" href="class_i_p_c_1_1_response_builder.html">IPC::ResponseBuilder</a> rb{rp.MakeBuilder(1, 0)};</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;        rb.<a class="code" href="class_i_p_c_1_1_response_builder.html#a12d9068ceac4de2e8c19e34ec42ce54e">Push</a>(<a class="code" href="union_result_code.html">ResultCode</a>(<a class="code" href="result_8h.html#afe30fc4506a4cf2ee780b2319dbec74da853d33bc5e409941bed899b913647310">ErrorDescription::TooLarge</a>, <a class="code" href="result_8h.html#a67158ef38e1ab9113151768007433e3aadb568ddcb8d3308155f19bdbadf655ca">ErrorModule::UDS</a>,</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;                           <a class="code" href="result_8h.html#a1d3c3229b2c38b6fe717b434732c5b86a5a738160747f39c20e9f65416931c974">ErrorSummary::WrongArgument</a>, <a class="code" href="result_8h.html#aa3b9056eb03ec4e7c3561192eb830739ac64518704ce0c0d5501a45763f464276">ErrorLevel::Usage</a>));</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;        <a class="code" href="log_8h.html#a8b510d36fc8a109f98395ce9b6ada954">LOG_WARNING</a>(Service_NWM, <span class="stringliteral">&quot;MinRecvBufferSize&quot;</span>);</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    }</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    <span class="comment">// Create a new event for this bind node.</span></div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    <span class="keyword">auto</span> <span class="keyword">event</span> = <a class="code" href="class_kernel_1_1_event.html#a2a2e0b30f62fdd2fa9dd29ab64c7941f">Kernel::Event::Create</a>(<a class="code" href="namespace_kernel.html#aa2d109b9b88cb2530209ac79149e2811ac7fc2ee61fad0e2bba6754efdee31481">Kernel::ResetType::OneShot</a>,</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;                                       <span class="stringliteral">&quot;NWM::BindNodeEvent&quot;</span> + std::to_string(bind_node_id));</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    std::lock_guard&lt;std::mutex&gt; lock{connection_status_mutex};</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    <a class="code" href="assert_8h.html#a9f920d5e0c0e8780d4ce9bfb15bfd9e2">ASSERT</a>(channel_data.find(data_channel) == channel_data.end());</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    <span class="comment">// TODO(B3N30): Support more than one bind node per channel.</span></div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    channel_data[data_channel] = {bind_node_id, data_channel, network_node_id, <span class="keyword">event</span>};</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    <a class="code" href="class_i_p_c_1_1_response_builder.html">IPC::ResponseBuilder</a> rb{rp.MakeBuilder(1, 2)};</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    rb.<a class="code" href="class_i_p_c_1_1_response_builder.html#a12d9068ceac4de2e8c19e34ec42ce54e">Push</a>(<a class="code" href="result_8h.html#ac66ebacde94a19df5a65f34e8238cf79">RESULT_SUCCESS</a>);</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    rb.PushCopyObjects(event);</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;    <a class="code" href="log_8h.html#add982f3fbcbb8bfd9e729ab9356efb34">LOG_DEBUG</a>(Service_NWM, <span class="stringliteral">&quot;called&quot;</span>);</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;}</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;</div><div class="line"><a name="l00773"></a><span class="lineno"><a class="line" href="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s.html#ab191e3fec4ecec4fd93145df34ac9377">  773</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s.html#ab191e3fec4ecec4fd93145df34ac9377">NWM_UDS::Unbind</a>(<a class="code" href="class_kernel_1_1_h_l_e_request_context.html">Kernel::HLERequestContext</a>&amp; ctx) {</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    <a class="code" href="class_i_p_c_1_1_request_parser.html">IPC::RequestParser</a> rp{ctx, 0x12, 1, 0};</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    <a class="code" href="common__types_8h.html#a65cf28726f89e62ccf2f1354bc2716df">u32</a> bind_node_id{rp.Pop&lt;<a class="code" href="common__types_8h.html#a65cf28726f89e62ccf2f1354bc2716df">u32</a>&gt;()};</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    <span class="keywordflow">if</span> (bind_node_id == 0) {</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;        <a class="code" href="class_i_p_c_1_1_response_builder.html">IPC::ResponseBuilder</a> rb{rp.MakeBuilder(1, 0)};</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;        rb.<a class="code" href="class_i_p_c_1_1_response_builder.html#a12d9068ceac4de2e8c19e34ec42ce54e">Push</a>(<a class="code" href="union_result_code.html">ResultCode</a>(<a class="code" href="result_8h.html#afe30fc4506a4cf2ee780b2319dbec74da418ec6476e1acd92e17681f4bd00e3a3">ErrorDescription::NotAuthorized</a>, <a class="code" href="result_8h.html#a67158ef38e1ab9113151768007433e3aadb568ddcb8d3308155f19bdbadf655ca">ErrorModule::UDS</a>,</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;                           <a class="code" href="result_8h.html#a1d3c3229b2c38b6fe717b434732c5b86a5a738160747f39c20e9f65416931c974">ErrorSummary::WrongArgument</a>, <a class="code" href="result_8h.html#aa3b9056eb03ec4e7c3561192eb830739ac64518704ce0c0d5501a45763f464276">ErrorLevel::Usage</a>));</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    }</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    std::lock_guard&lt;std::mutex&gt; lock{connection_status_mutex};</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    <span class="keyword">auto</span> itr =</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;        std::find_if(channel_data.begin(), channel_data.end(), [bind_node_id](<span class="keyword">const</span> <span class="keyword">auto</span>&amp; data) {</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;            <span class="keywordflow">return</span> data.second.bind_node_id == bind_node_id;</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;        });</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    <span class="keywordflow">if</span> (itr != channel_data.end()) {</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;        channel_data.erase(itr);</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    }</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    <a class="code" href="class_i_p_c_1_1_response_builder.html">IPC::ResponseBuilder</a> rb{rp.MakeBuilder(5, 0)};</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    rb.<a class="code" href="class_i_p_c_1_1_response_builder.html#a12d9068ceac4de2e8c19e34ec42ce54e">Push</a>(<a class="code" href="result_8h.html#ac66ebacde94a19df5a65f34e8238cf79">RESULT_SUCCESS</a>);</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    rb.Push(bind_node_id);</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    <span class="comment">// TODO(B3N30): Find out what the other return values are</span></div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    rb.Push&lt;<a class="code" href="common__types_8h.html#a65cf28726f89e62ccf2f1354bc2716df">u32</a>&gt;(0);</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;    rb.Push&lt;<a class="code" href="common__types_8h.html#a65cf28726f89e62ccf2f1354bc2716df">u32</a>&gt;(0);</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    rb.Push&lt;<a class="code" href="common__types_8h.html#a65cf28726f89e62ccf2f1354bc2716df">u32</a>&gt;(0);</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;}</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;</div><div class="line"><a name="l00804"></a><span class="lineno"><a class="line" href="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s.html#a60d8b8de8acce4ab4588fd0dbabdfd40">  804</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s.html#a60d8b8de8acce4ab4588fd0dbabdfd40">NWM_UDS::BeginHostingNetwork</a>(<a class="code" href="class_kernel_1_1_h_l_e_request_context.html">Kernel::HLERequestContext</a>&amp; ctx) {</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    <a class="code" href="class_i_p_c_1_1_request_parser.html">IPC::RequestParser</a> rp{ctx, 0x1D, 1, 4};</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    <span class="keyword">const</span> <a class="code" href="common__types_8h.html#a65cf28726f89e62ccf2f1354bc2716df">u32</a> passphrase_size{rp.Pop&lt;<a class="code" href="common__types_8h.html#a65cf28726f89e62ccf2f1354bc2716df">u32</a>&gt;()};</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    <span class="keyword">const</span> std::vector&lt;u8&gt; network_info_buffer{rp.PopStaticBuffer()};</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    <a class="code" href="assert_8h.html#a9f920d5e0c0e8780d4ce9bfb15bfd9e2">ASSERT</a>(network_info_buffer.size() == <span class="keyword">sizeof</span>(<a class="code" href="struct_service_1_1_n_w_m_1_1_network_info.html">NetworkInfo</a>));</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    <span class="keyword">const</span> std::vector&lt;u8&gt; passphrase{rp.PopStaticBuffer()};</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    <a class="code" href="assert_8h.html#a9f920d5e0c0e8780d4ce9bfb15bfd9e2">ASSERT</a>(passphrase.size() == passphrase_size);</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    <span class="comment">// TODO(Subv): Store the passphrase and verify it when attempting a connection.</span></div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    {</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;        std::lock_guard&lt;std::mutex&gt; lock{connection_status_mutex};</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;        std::memcpy(&amp;network_info, network_info_buffer.data(), <span class="keyword">sizeof</span>(<a class="code" href="struct_service_1_1_n_w_m_1_1_network_info.html">NetworkInfo</a>));</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;        <span class="comment">// The real UDS module throws a fatal error if this assert fails.</span></div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;        <a class="code" href="assert_8h.html#a4b432fb3d47e2ca732caf965691a54d7">ASSERT_MSG</a>(network_info.<a class="code" href="struct_service_1_1_n_w_m_1_1_network_info.html#a769ed02f16d54595754344c23d4e21f2">max_nodes</a> &gt; 1, <span class="stringliteral">&quot;Trying to host a network of only one member.&quot;</span>);</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;        <a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a>.<a class="code" href="struct_service_1_1_n_w_m_1_1_connection_status.html#a06757367dc9053bdb0f13218ddfdc90c">status</a> = <span class="keyword">static_cast&lt;</span><a class="code" href="common__types_8h.html#a65cf28726f89e62ccf2f1354bc2716df">u32</a><span class="keyword">&gt;</span>(<a class="code" href="namespace_service_1_1_n_w_m.html#a314d2573d77dfa9a69d021eb31ee2d64a1bacb914b9ecea50415b08ba2d438cc6">NetworkStatus::ConnectedAsHost</a>);</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;        <span class="comment">// Set up basic information for this network.</span></div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;        network_info.<a class="code" href="struct_service_1_1_n_w_m_1_1_network_info.html#a4232ae11645f866665498febd9221d7c">oui_value</a> = <a class="code" href="namespace_service_1_1_n_w_m.html#ab3c2316d04955789ace86a6134f0744f">NintendoOUI</a>;</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;        network_info.<a class="code" href="struct_service_1_1_n_w_m_1_1_network_info.html#a730aef7216b01b09a5fd7dc5b7cb6299">oui_type</a> = <span class="keyword">static_cast&lt;</span><a class="code" href="common__types_8h.html#a254d32383658e016368673396e7afc1b">u8</a><span class="keyword">&gt;</span>(<a class="code" href="namespace_service_1_1_n_w_m.html#ae989e39572d21634928c5b6c9ac2cf14a0b4ba01efcb15b2ff201068d04643fd5">NintendoTagId::NetworkInfo</a>);</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;        <a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a>.<a class="code" href="struct_service_1_1_n_w_m_1_1_connection_status.html#a1316e3ca28f939ea4453649235c14a4e">max_nodes</a> = network_info.<a class="code" href="struct_service_1_1_n_w_m_1_1_network_info.html#a769ed02f16d54595754344c23d4e21f2">max_nodes</a>;</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;        <span class="comment">// Resize the nodes list to hold max_nodes.</span></div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;        node_info.clear();</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;        node_info.resize(network_info.<a class="code" href="struct_service_1_1_n_w_m_1_1_network_info.html#a769ed02f16d54595754344c23d4e21f2">max_nodes</a>);</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;        <span class="comment">// There&#39;s currently only one node in the network (the host).</span></div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;        <a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a>.<a class="code" href="struct_service_1_1_n_w_m_1_1_connection_status.html#abb6fb689a303df1553ff4a76e0028888">total_nodes</a> = 1;</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;        network_info.<a class="code" href="struct_service_1_1_n_w_m_1_1_network_info.html#a8cf9b7de67292d2e626ecad3de82ffab">total_nodes</a> = 1;</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;        <span class="comment">// The host is always the first node</span></div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;        <a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a>.<a class="code" href="struct_service_1_1_n_w_m_1_1_connection_status.html#a0ece6d8ec29eea3c29718d747910f8d0">network_node_id</a> = 1;</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;        current_node.<a class="code" href="struct_service_1_1_n_w_m_1_1_node_info.html#ac7f54bcf8a458b5f297d00715fdb99be">network_node_id</a> = 1;</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;        <a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a>.<a class="code" href="struct_service_1_1_n_w_m_1_1_connection_status.html#a350f538191a8b78051f3161d4e49440d">nodes</a>[0] = <a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a>.<a class="code" href="struct_service_1_1_n_w_m_1_1_connection_status.html#a0ece6d8ec29eea3c29718d747910f8d0">network_node_id</a>;</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;        <span class="comment">// Set the bit 0 in the nodes bitmask to indicate that node 1 is already taken.</span></div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;        <a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a>.<a class="code" href="struct_service_1_1_n_w_m_1_1_connection_status.html#a2db87e8db746a74c27e1785c58e40cb0">node_bitmask</a> |= 1;</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;        <span class="comment">// Notify the application that the first node was set.</span></div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;        <a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a>.<a class="code" href="struct_service_1_1_n_w_m_1_1_connection_status.html#a9d333528ec44be3e2c30011490e9701d">changed_nodes</a> |= 1;</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">auto</span> room_member{<a class="code" href="namespace_network.html#a5ee509b747f2af4c4110f7542a6efe8b">Network::GetRoomMember</a>().lock()}) {</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;            <span class="keywordflow">if</span> (room_member-&gt;IsConnected()) {</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;                network_info.<a class="code" href="struct_service_1_1_n_w_m_1_1_network_info.html#a2a29d90219373c16a753cc4ce7496d69">host_mac_address</a> = room_member-&gt;GetMacAddress();</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;                network_info.<a class="code" href="struct_service_1_1_n_w_m_1_1_network_info.html#a2a29d90219373c16a753cc4ce7496d69">host_mac_address</a> = {{0x0, 0x0, 0x0, 0x0, 0x0, 0x0}};</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;            }</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;        }</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;        node_info[0] = <a class="code" href="namespace_service_1_1_n_w_m.html#a4f4c0df5e69105de353121769e93ce69">current_node</a>;</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;        <span class="comment">// If the game has a preferred channel, use that instead.</span></div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;        <span class="keywordflow">if</span> (network_info.<a class="code" href="struct_service_1_1_n_w_m_1_1_network_info.html#a65308fed80930695564866bc1396361e">channel</a> != 0)</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;            <a class="code" href="namespace_service_1_1_n_w_m.html#a623a500ff8b4c3f1c93be76297039f1a">network_channel</a> = network_info.<a class="code" href="struct_service_1_1_n_w_m_1_1_network_info.html#a65308fed80930695564866bc1396361e">channel</a>;</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;            network_info.<a class="code" href="struct_service_1_1_n_w_m_1_1_network_info.html#a65308fed80930695564866bc1396361e">channel</a> = <a class="code" href="namespace_service_1_1_n_w_m.html#aa8893d16a17753698cd0c699d125d726">DefaultNetworkChannel</a>;</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    }</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    connection_status_event-&gt;Signal();</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    <span class="comment">// Start broadcasting the network, send a beacon frame every 102.4ms.</span></div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    <a class="code" href="namespace_core_timing.html#a9e1678c03397fd456975cc4060f6feab">CoreTiming::ScheduleEvent</a>(<a class="code" href="core__timing_8h.html#a624c4e2c1fbcf329eb4a48687ea63a40">msToCycles</a>(<a class="code" href="namespace_service_1_1_n_w_m.html#afca90cf98f6f7357d7c847ea65064ba2">DefaultBeaconInterval</a> * <a class="code" href="namespace_service_1_1_n_w_m.html#a60d846206c420364f50d25c937e939a8">MillisecondsPerTU</a>),</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;                              beacon_broadcast_event, 0);</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    <a class="code" href="class_i_p_c_1_1_response_builder.html">IPC::ResponseBuilder</a> rb{rp.MakeBuilder(1, 0)};</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    rb.<a class="code" href="class_i_p_c_1_1_response_builder.html#a12d9068ceac4de2e8c19e34ec42ce54e">Push</a>(<a class="code" href="result_8h.html#ac66ebacde94a19df5a65f34e8238cf79">RESULT_SUCCESS</a>);</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;    <a class="code" href="log_8h.html#add982f3fbcbb8bfd9e729ab9356efb34">LOG_DEBUG</a>(Service_NWM, <span class="stringliteral">&quot;An UDS network has been created.&quot;</span>);</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;}</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;</div><div class="line"><a name="l00876"></a><span class="lineno"><a class="line" href="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s.html#aefd528e364772e2b58a0496f13cacdea">  876</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s.html#aefd528e364772e2b58a0496f13cacdea">NWM_UDS::UpdateNetworkAttribute</a>(<a class="code" href="class_kernel_1_1_h_l_e_request_context.html">Kernel::HLERequestContext</a>&amp; ctx) {</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    <a class="code" href="class_i_p_c_1_1_request_parser.html">IPC::RequestParser</a> rp{ctx, 0x07, 2, 0};</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;    rp.Skip(2, <span class="keyword">false</span>);</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    <a class="code" href="class_i_p_c_1_1_response_builder.html">IPC::ResponseBuilder</a> rb{rp.MakeBuilder(1, 0)};</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    rb.<a class="code" href="class_i_p_c_1_1_response_builder.html#a12d9068ceac4de2e8c19e34ec42ce54e">Push</a>(<a class="code" href="result_8h.html#ac66ebacde94a19df5a65f34e8238cf79">RESULT_SUCCESS</a>);</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    <a class="code" href="log_8h.html#a8b510d36fc8a109f98395ce9b6ada954">LOG_WARNING</a>(Service_NWM, <span class="stringliteral">&quot;(STUBBED) called&quot;</span>);</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;}</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;</div><div class="line"><a name="l00885"></a><span class="lineno"><a class="line" href="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s.html#a1928d3ad8055f0b36954372268f86d55">  885</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s.html#a1928d3ad8055f0b36954372268f86d55">NWM_UDS::DestroyNetwork</a>(<a class="code" href="class_kernel_1_1_h_l_e_request_context.html">Kernel::HLERequestContext</a>&amp; ctx) {</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;    <a class="code" href="class_i_p_c_1_1_request_parser.html">IPC::RequestParser</a> rp{ctx, 0x08, 0, 0};</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;    <span class="comment">// Unschedule the beacon broadcast event.</span></div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    <a class="code" href="namespace_core_timing.html#a1d0fc13b562a6c699cdcbfd4ccdfbc10">CoreTiming::UnscheduleEvent</a>(beacon_broadcast_event, 0);</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    <span class="comment">// Only a host can destroy</span></div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;    std::lock_guard&lt;std::mutex&gt; lock{connection_status_mutex};</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a>.<a class="code" href="struct_service_1_1_n_w_m_1_1_connection_status.html#a06757367dc9053bdb0f13218ddfdc90c">status</a> != static_cast&lt;u8&gt;(<a class="code" href="namespace_service_1_1_n_w_m.html#a314d2573d77dfa9a69d021eb31ee2d64a1bacb914b9ecea50415b08ba2d438cc6">NetworkStatus::ConnectedAsHost</a>)) {</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;        <a class="code" href="class_i_p_c_1_1_response_builder.html">IPC::ResponseBuilder</a> rb{rp.MakeBuilder(1, 0)};</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;        rb.<a class="code" href="class_i_p_c_1_1_response_builder.html#a12d9068ceac4de2e8c19e34ec42ce54e">Push</a>(<a class="code" href="union_result_code.html">ResultCode</a>(<a class="code" href="namespace_service_1_1_n_w_m_1_1_err_codes.html#aeb854535fff279bb2aba92bfd22b7558a93a5e56ad80aba8e21f449e36f03c35b">ErrCodes::WrongStatus</a>, <a class="code" href="result_8h.html#a67158ef38e1ab9113151768007433e3aadb568ddcb8d3308155f19bdbadf655ca">ErrorModule::UDS</a>, <a class="code" href="result_8h.html#a1d3c3229b2c38b6fe717b434732c5b86aedf260198e4d75d1cb3c7588f7380120">ErrorSummary::InvalidState</a>,</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;                           <a class="code" href="result_8h.html#aa3b9056eb03ec4e7c3561192eb830739aec53a8c4f07baed5d8825072c89799be">ErrorLevel::Status</a>));</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;        <a class="code" href="log_8h.html#a8b510d36fc8a109f98395ce9b6ada954">LOG_WARNING</a>(Service_NWM, <span class="stringliteral">&quot;called with status {}&quot;</span>, <a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a>.<a class="code" href="struct_service_1_1_n_w_m_1_1_connection_status.html#a06757367dc9053bdb0f13218ddfdc90c">status</a>);</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;    }</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;    <span class="comment">// TODO(B3N30): Send 3 Deauth packets</span></div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;    <a class="code" href="swap_8h.html#a2e0978efc9ad053db49e5ab7c38d0e4b">u16_le</a> tmp_node_id = <a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a>.<a class="code" href="struct_service_1_1_n_w_m_1_1_connection_status.html#a0ece6d8ec29eea3c29718d747910f8d0">network_node_id</a>;</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    <a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a> = {};</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;    <a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a>.<a class="code" href="struct_service_1_1_n_w_m_1_1_connection_status.html#a06757367dc9053bdb0f13218ddfdc90c">status</a> = <span class="keyword">static_cast&lt;</span><a class="code" href="common__types_8h.html#a65cf28726f89e62ccf2f1354bc2716df">u32</a><span class="keyword">&gt;</span>(<a class="code" href="namespace_service_1_1_n_w_m.html#a314d2573d77dfa9a69d021eb31ee2d64a4075072d219e061ca0f3124f8fbef463">NetworkStatus::NotConnected</a>);</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;    <a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a>.<a class="code" href="struct_service_1_1_n_w_m_1_1_connection_status.html#a0ece6d8ec29eea3c29718d747910f8d0">network_node_id</a> = tmp_node_id;</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;    node_map.clear();</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;    connection_status_event-&gt;Signal();</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;    <a class="code" href="class_i_p_c_1_1_response_builder.html">IPC::ResponseBuilder</a> rb{rp.MakeBuilder(1, 0)};</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> bind_node : channel_data) {</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;        bind_node.second.event-&gt;Signal();</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;    }</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;    channel_data.clear();</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    rb.<a class="code" href="class_i_p_c_1_1_response_builder.html#a12d9068ceac4de2e8c19e34ec42ce54e">Push</a>(<a class="code" href="result_8h.html#ac66ebacde94a19df5a65f34e8238cf79">RESULT_SUCCESS</a>);</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    <a class="code" href="log_8h.html#add982f3fbcbb8bfd9e729ab9356efb34">LOG_DEBUG</a>(Service_NWM, <span class="stringliteral">&quot;called&quot;</span>);</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;}</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;</div><div class="line"><a name="l00922"></a><span class="lineno"><a class="line" href="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s.html#a95814c1aba23c9d36d3e786cc2d931ac">  922</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s.html#a95814c1aba23c9d36d3e786cc2d931ac">NWM_UDS::DisconnectNetwork</a>(<a class="code" href="class_kernel_1_1_h_l_e_request_context.html">Kernel::HLERequestContext</a>&amp; ctx) {</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;    <a class="code" href="class_i_p_c_1_1_request_parser.html">IPC::RequestParser</a> rp{ctx, 0xA, 0, 0};</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    <a class="code" href="class_i_p_c_1_1_response_builder.html">IPC::ResponseBuilder</a> rb{rp.MakeBuilder(1, 0)};</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;    <span class="keyword">using</span> <a class="code" href="struct_network_1_1_wifi_packet.html">Network::WifiPacket</a>;</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    WifiPacket deauth{};</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;    {</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;        std::lock_guard&lt;std::mutex&gt; lock{connection_status_mutex};</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a>.<a class="code" href="struct_service_1_1_n_w_m_1_1_connection_status.html#a06757367dc9053bdb0f13218ddfdc90c">status</a> == static_cast&lt;u32&gt;(<a class="code" href="namespace_service_1_1_n_w_m.html#a314d2573d77dfa9a69d021eb31ee2d64a1bacb914b9ecea50415b08ba2d438cc6">NetworkStatus::ConnectedAsHost</a>)) {</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;            <span class="comment">// A real 3ds makes strange things here. We do the same</span></div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;            <a class="code" href="swap_8h.html#a2e0978efc9ad053db49e5ab7c38d0e4b">u16_le</a> tmp_node_id{<a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a>.<a class="code" href="struct_service_1_1_n_w_m_1_1_connection_status.html#a0ece6d8ec29eea3c29718d747910f8d0">network_node_id</a>};</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;            <a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a> = {};</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;            <a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a>.<a class="code" href="struct_service_1_1_n_w_m_1_1_connection_status.html#a06757367dc9053bdb0f13218ddfdc90c">status</a> = <span class="keyword">static_cast&lt;</span><a class="code" href="common__types_8h.html#a65cf28726f89e62ccf2f1354bc2716df">u32</a><span class="keyword">&gt;</span>(<a class="code" href="namespace_service_1_1_n_w_m.html#a314d2573d77dfa9a69d021eb31ee2d64a1bacb914b9ecea50415b08ba2d438cc6">NetworkStatus::ConnectedAsHost</a>);</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;            <a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a>.<a class="code" href="struct_service_1_1_n_w_m_1_1_connection_status.html#a0ece6d8ec29eea3c29718d747910f8d0">network_node_id</a> = tmp_node_id;</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;            node_map.clear();</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;            <a class="code" href="log_8h.html#add982f3fbcbb8bfd9e729ab9356efb34">LOG_DEBUG</a>(Service_NWM, <span class="stringliteral">&quot;called as a host&quot;</span>);</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;            rb.Push(<a class="code" href="union_result_code.html">ResultCode</a>(<a class="code" href="namespace_service_1_1_n_w_m_1_1_err_codes.html#aeb854535fff279bb2aba92bfd22b7558a93a5e56ad80aba8e21f449e36f03c35b">ErrCodes::WrongStatus</a>, <a class="code" href="result_8h.html#a67158ef38e1ab9113151768007433e3aadb568ddcb8d3308155f19bdbadf655ca">ErrorModule::UDS</a>, <a class="code" href="result_8h.html#a1d3c3229b2c38b6fe717b434732c5b86aedf260198e4d75d1cb3c7588f7380120">ErrorSummary::InvalidState</a>,</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;                               <a class="code" href="result_8h.html#aa3b9056eb03ec4e7c3561192eb830739aec53a8c4f07baed5d8825072c89799be">ErrorLevel::Status</a>));</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;        }</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;        <a class="code" href="swap_8h.html#a2e0978efc9ad053db49e5ab7c38d0e4b">u16_le</a> tmp_node_id{<a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a>.<a class="code" href="struct_service_1_1_n_w_m_1_1_connection_status.html#a0ece6d8ec29eea3c29718d747910f8d0">network_node_id</a>};</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;        <a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a> = {};</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;        <a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a>.<a class="code" href="struct_service_1_1_n_w_m_1_1_connection_status.html#a06757367dc9053bdb0f13218ddfdc90c">status</a> = <span class="keyword">static_cast&lt;</span><a class="code" href="common__types_8h.html#a65cf28726f89e62ccf2f1354bc2716df">u32</a><span class="keyword">&gt;</span>(<a class="code" href="namespace_service_1_1_n_w_m.html#a314d2573d77dfa9a69d021eb31ee2d64a4075072d219e061ca0f3124f8fbef463">NetworkStatus::NotConnected</a>);</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;        <a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a>.<a class="code" href="struct_service_1_1_n_w_m_1_1_connection_status.html#a0ece6d8ec29eea3c29718d747910f8d0">network_node_id</a> = tmp_node_id;</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;        node_map.clear();</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;        connection_status_event-&gt;Signal();</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;        deauth.channel = <a class="code" href="namespace_service_1_1_n_w_m.html#a623a500ff8b4c3f1c93be76297039f1a">network_channel</a>;</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;        <span class="comment">// TODO(B3N30): Add disconnect reason</span></div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;        deauth.data = {};</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;        deauth.destination_address = network_info.<a class="code" href="struct_service_1_1_n_w_m_1_1_network_info.html#a2a29d90219373c16a753cc4ce7496d69">host_mac_address</a>;</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;        deauth.type = WifiPacket::PacketType::Deauthentication;</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    }</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;    <a class="code" href="namespace_service_1_1_n_w_m.html#aab843dbb97d49e6d10a14bcca9fc715c">SendPacket</a>(deauth);</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> bind_node : channel_data) {</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;        bind_node.second.event-&gt;Signal();</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    }</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    channel_data.clear();</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    rb.Push(<a class="code" href="result_8h.html#ac66ebacde94a19df5a65f34e8238cf79">RESULT_SUCCESS</a>);</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    <a class="code" href="log_8h.html#add982f3fbcbb8bfd9e729ab9356efb34">LOG_DEBUG</a>(Service_NWM, <span class="stringliteral">&quot;called&quot;</span>);</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;}</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;</div><div class="line"><a name="l00967"></a><span class="lineno"><a class="line" href="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s.html#ab6e56082794235a29f85aba495714672">  967</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s.html#ab6e56082794235a29f85aba495714672">NWM_UDS::SendTo</a>(<a class="code" href="class_kernel_1_1_h_l_e_request_context.html">Kernel::HLERequestContext</a>&amp; ctx) {</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;    <a class="code" href="class_i_p_c_1_1_request_parser.html">IPC::RequestParser</a> rp{ctx, 0x17, 6, 2};</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;    rp.Skip(1, <span class="keyword">false</span>);</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;    <a class="code" href="common__types_8h.html#a917e58b0692c2df778a27350534cbfe7">u16</a> dest_node_id{rp.Pop&lt;<a class="code" href="common__types_8h.html#a917e58b0692c2df778a27350534cbfe7">u16</a>&gt;()};</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;    <a class="code" href="common__types_8h.html#a254d32383658e016368673396e7afc1b">u8</a> data_channel{rp.Pop&lt;<a class="code" href="common__types_8h.html#a254d32383658e016368673396e7afc1b">u8</a>&gt;()};</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;    rp.Skip(1, <span class="keyword">false</span>);</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;    <a class="code" href="common__types_8h.html#a65cf28726f89e62ccf2f1354bc2716df">u32</a> data_size{rp.Pop&lt;<a class="code" href="common__types_8h.html#a65cf28726f89e62ccf2f1354bc2716df">u32</a>&gt;()};</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;    <a class="code" href="common__types_8h.html#a254d32383658e016368673396e7afc1b">u8</a> flags{rp.Pop&lt;<a class="code" href="common__types_8h.html#a254d32383658e016368673396e7afc1b">u8</a>&gt;()};</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;    <span class="comment">// There should never be a dest_node_id of 0</span></div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    <a class="code" href="assert_8h.html#a9f920d5e0c0e8780d4ce9bfb15bfd9e2">ASSERT</a>(dest_node_id != 0);</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;    std::vector&lt;u8&gt; input_buffer{rp.PopStaticBuffer()};</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;    <a class="code" href="assert_8h.html#a9f920d5e0c0e8780d4ce9bfb15bfd9e2">ASSERT</a>(input_buffer.size() &gt;= data_size);</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;    input_buffer.resize(data_size);</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;    <a class="code" href="class_i_p_c_1_1_response_builder.html">IPC::ResponseBuilder</a> rb{rp.MakeBuilder(1, 0)};</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    std::lock_guard&lt;std::mutex&gt; lock{connection_status_mutex};</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a>.<a class="code" href="struct_service_1_1_n_w_m_1_1_connection_status.html#a06757367dc9053bdb0f13218ddfdc90c">status</a> != static_cast&lt;u32&gt;(<a class="code" href="namespace_service_1_1_n_w_m.html#a314d2573d77dfa9a69d021eb31ee2d64ac10c2f98fd4e55ef8dc130ebe5347121">NetworkStatus::ConnectedAsClient</a>) &amp;&amp;</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;        <a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a>.<a class="code" href="struct_service_1_1_n_w_m_1_1_connection_status.html#a06757367dc9053bdb0f13218ddfdc90c">status</a> != static_cast&lt;u32&gt;(<a class="code" href="namespace_service_1_1_n_w_m.html#a314d2573d77dfa9a69d021eb31ee2d64a1bacb914b9ecea50415b08ba2d438cc6">NetworkStatus::ConnectedAsHost</a>)) {</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;        rb.<a class="code" href="class_i_p_c_1_1_response_builder.html#a12d9068ceac4de2e8c19e34ec42ce54e">Push</a>(<a class="code" href="union_result_code.html">ResultCode</a>(<a class="code" href="result_8h.html#afe30fc4506a4cf2ee780b2319dbec74da418ec6476e1acd92e17681f4bd00e3a3">ErrorDescription::NotAuthorized</a>, <a class="code" href="result_8h.html#a67158ef38e1ab9113151768007433e3aadb568ddcb8d3308155f19bdbadf655ca">ErrorModule::UDS</a>,</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;                           <a class="code" href="result_8h.html#a1d3c3229b2c38b6fe717b434732c5b86aedf260198e4d75d1cb3c7588f7380120">ErrorSummary::InvalidState</a>, <a class="code" href="result_8h.html#aa3b9056eb03ec4e7c3561192eb830739aec53a8c4f07baed5d8825072c89799be">ErrorLevel::Status</a>));</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;    }</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;    <span class="keywordflow">if</span> (dest_node_id == <a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a>.<a class="code" href="struct_service_1_1_n_w_m_1_1_connection_status.html#a0ece6d8ec29eea3c29718d747910f8d0">network_node_id</a>) {</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;        <a class="code" href="log_8h.html#a2f872ec42bda0e5baf8783313a28494c">LOG_ERROR</a>(Service_NWM, <span class="stringliteral">&quot;tried to send packet to itself&quot;</span>);</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;        rb.Push(<a class="code" href="union_result_code.html">ResultCode</a>(<a class="code" href="result_8h.html#afe30fc4506a4cf2ee780b2319dbec74da38c300f4fc9ce8a77aad4a30de05cad8">ErrorDescription::NotFound</a>, <a class="code" href="result_8h.html#a67158ef38e1ab9113151768007433e3aadb568ddcb8d3308155f19bdbadf655ca">ErrorModule::UDS</a>,</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;                           <a class="code" href="result_8h.html#a1d3c3229b2c38b6fe717b434732c5b86a5a738160747f39c20e9f65416931c974">ErrorSummary::WrongArgument</a>, <a class="code" href="result_8h.html#aa3b9056eb03ec4e7c3561192eb830739aec53a8c4f07baed5d8825072c89799be">ErrorLevel::Status</a>));</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    }</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;    <a class="code" href="namespace_network.html#ad53970187104c70b9d5bd6506427c48b">Network::MacAddress</a> dest_address{};</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;    <span class="keywordflow">if</span> (flags &gt;&gt; 2) {</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;        <a class="code" href="log_8h.html#a2f872ec42bda0e5baf8783313a28494c">LOG_ERROR</a>(Service_NWM, <span class="stringliteral">&quot;Unexpected flags 0x{:02X}&quot;</span>, flags);</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;    }</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;    <span class="keywordflow">if</span> ((flags &amp; (0x1 &lt;&lt; 1)) || dest_node_id == 0xFFFF) {</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;        <span class="comment">// Broadcast</span></div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;        dest_address = <a class="code" href="namespace_network.html#a8591cf445700107127c0f2bf46365e88">Network::BroadcastMac</a>;</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dest_node_id != 1) {</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;        <span class="comment">// Send to specific client</span></div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;        <span class="keyword">auto</span> destination{</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;            std::find_if(node_map.begin(), node_map.end(),</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;                         [dest_node_id](<span class="keyword">const</span> <span class="keyword">auto</span>&amp; node) { <span class="keywordflow">return</span> node.second == dest_node_id; })};</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;        <span class="keywordflow">if</span> (destination == node_map.end()) {</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;            <a class="code" href="log_8h.html#a2f872ec42bda0e5baf8783313a28494c">LOG_ERROR</a>(Service_NWM, <span class="stringliteral">&quot;tried to send packet to unknown dest id {}&quot;</span>, dest_node_id);</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;            rb.Push(<a class="code" href="union_result_code.html">ResultCode</a>(<a class="code" href="result_8h.html#afe30fc4506a4cf2ee780b2319dbec74da38c300f4fc9ce8a77aad4a30de05cad8">ErrorDescription::NotFound</a>, <a class="code" href="result_8h.html#a67158ef38e1ab9113151768007433e3aadb568ddcb8d3308155f19bdbadf655ca">ErrorModule::UDS</a>,</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;                               <a class="code" href="result_8h.html#a1d3c3229b2c38b6fe717b434732c5b86a5a738160747f39c20e9f65416931c974">ErrorSummary::WrongArgument</a>, <a class="code" href="result_8h.html#aa3b9056eb03ec4e7c3561192eb830739aec53a8c4f07baed5d8825072c89799be">ErrorLevel::Status</a>));</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;        }</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;        dest_address = destination-&gt;first;</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;        <span class="comment">// Send message to host</span></div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;        dest_address = network_info.<a class="code" href="struct_service_1_1_n_w_m_1_1_network_info.html#a2a29d90219373c16a753cc4ce7496d69">host_mac_address</a>;</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;    }</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;    constexpr std::size_t MaxSize{0x5C6};</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;    <span class="keywordflow">if</span> (data_size &gt; MaxSize) {</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;        rb.Push(<a class="code" href="union_result_code.html">ResultCode</a>(<a class="code" href="result_8h.html#afe30fc4506a4cf2ee780b2319dbec74da853d33bc5e409941bed899b913647310">ErrorDescription::TooLarge</a>, <a class="code" href="result_8h.html#a67158ef38e1ab9113151768007433e3aadb568ddcb8d3308155f19bdbadf655ca">ErrorModule::UDS</a>,</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;                           <a class="code" href="result_8h.html#a1d3c3229b2c38b6fe717b434732c5b86a5a738160747f39c20e9f65416931c974">ErrorSummary::WrongArgument</a>, <a class="code" href="result_8h.html#aa3b9056eb03ec4e7c3561192eb830739ac64518704ce0c0d5501a45763f464276">ErrorLevel::Usage</a>));</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;    }</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;    <span class="comment">// TODO(B3N30): Increment the sequence number after each sent packet.</span></div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;    <a class="code" href="common__types_8h.html#a917e58b0692c2df778a27350534cbfe7">u16</a> sequence_number{};</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;    std::vector&lt;u8&gt; data_payload =</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;        <a class="code" href="namespace_service_1_1_n_w_m.html#a4f2383c166106c0e6e6d96d6ad52c5c0">GenerateDataPayload</a>(input_buffer, data_channel, dest_node_id,</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;                            <a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a>.<a class="code" href="struct_service_1_1_n_w_m_1_1_connection_status.html#a0ece6d8ec29eea3c29718d747910f8d0">network_node_id</a>, sequence_number);</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;    <span class="comment">// TODO(B3N30): Retrieve the MAC address of the dest_node_id and our own to encrypt</span></div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;    <span class="comment">// and encapsulate the payload.</span></div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;    <a class="code" href="struct_network_1_1_wifi_packet.html">Network::WifiPacket</a> packet{};</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;    packet.<a class="code" href="struct_network_1_1_wifi_packet.html#a2e7fb70d17f8a7c96af404744cfc555d">destination_address</a> = dest_address;</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;    packet.channel = <a class="code" href="namespace_service_1_1_n_w_m.html#a623a500ff8b4c3f1c93be76297039f1a">network_channel</a>;</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;    packet.data = std::move(data_payload);</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;    packet.type = <a class="code" href="struct_network_1_1_wifi_packet.html#a9047c2d448a65b11b302c7e9d0870d39af6068daa29dbb05a7ead1e3b5a48bbee">Network::WifiPacket::PacketType::Data</a>;</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;    <a class="code" href="namespace_service_1_1_n_w_m.html#aab843dbb97d49e6d10a14bcca9fc715c">SendPacket</a>(packet);</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;    rb.Push(<a class="code" href="result_8h.html#ac66ebacde94a19df5a65f34e8238cf79">RESULT_SUCCESS</a>);</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;}</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;</div><div class="line"><a name="l01055"></a><span class="lineno"><a class="line" href="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s.html#aa3511028df5fc7d0464b336fc289134c"> 1055</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s.html#aa3511028df5fc7d0464b336fc289134c">NWM_UDS::PullPacket</a>(<a class="code" href="class_kernel_1_1_h_l_e_request_context.html">Kernel::HLERequestContext</a>&amp; ctx) {</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;    <a class="code" href="class_i_p_c_1_1_request_parser.html">IPC::RequestParser</a> rp{ctx, 0x14, 3, 0};</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;    <a class="code" href="common__types_8h.html#a65cf28726f89e62ccf2f1354bc2716df">u32</a> bind_node_id{rp.Pop&lt;<a class="code" href="common__types_8h.html#a65cf28726f89e62ccf2f1354bc2716df">u32</a>&gt;()};</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;    <a class="code" href="common__types_8h.html#a65cf28726f89e62ccf2f1354bc2716df">u32</a> max_out_buff_size_aligned{rp.Pop&lt;<a class="code" href="common__types_8h.html#a65cf28726f89e62ccf2f1354bc2716df">u32</a>&gt;()};</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;    <a class="code" href="common__types_8h.html#a65cf28726f89e62ccf2f1354bc2716df">u32</a> max_out_buff_size{rp.Pop&lt;<a class="code" href="common__types_8h.html#a65cf28726f89e62ccf2f1354bc2716df">u32</a>&gt;()};</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;    <span class="comment">// This size is hard coded into the uds module. We don&#39;t know the meaning yet.</span></div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;    <a class="code" href="common__types_8h.html#a65cf28726f89e62ccf2f1354bc2716df">u32</a> buff_size{std::min&lt;u32&gt;(max_out_buff_size_aligned, 0x172) &lt;&lt; 2};</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;    std::lock_guard&lt;std::mutex&gt; lock{connection_status_mutex};</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a>.<a class="code" href="struct_service_1_1_n_w_m_1_1_connection_status.html#a06757367dc9053bdb0f13218ddfdc90c">status</a> != static_cast&lt;u32&gt;(<a class="code" href="namespace_service_1_1_n_w_m.html#a314d2573d77dfa9a69d021eb31ee2d64a1bacb914b9ecea50415b08ba2d438cc6">NetworkStatus::ConnectedAsHost</a>) &amp;&amp;</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;        <a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a>.<a class="code" href="struct_service_1_1_n_w_m_1_1_connection_status.html#a06757367dc9053bdb0f13218ddfdc90c">status</a> != <span class="keyword">static_cast&lt;</span><a class="code" href="common__types_8h.html#a65cf28726f89e62ccf2f1354bc2716df">u32</a><span class="keyword">&gt;</span>(<a class="code" href="namespace_service_1_1_n_w_m.html#a314d2573d77dfa9a69d021eb31ee2d64ac10c2f98fd4e55ef8dc130ebe5347121">NetworkStatus::ConnectedAsClient</a>) &amp;&amp;</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;        <a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a>.<a class="code" href="struct_service_1_1_n_w_m_1_1_connection_status.html#a06757367dc9053bdb0f13218ddfdc90c">status</a> != static_cast&lt;u32&gt;(<a class="code" href="namespace_service_1_1_n_w_m.html#a314d2573d77dfa9a69d021eb31ee2d64a1da5da12c73a39a25f9fbc26df6b96f0">NetworkStatus::ConnectedAsSpectator</a>)) {</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;        <a class="code" href="class_i_p_c_1_1_response_builder.html">IPC::ResponseBuilder</a> rb{rp.MakeBuilder(1, 0)};</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;        rb.<a class="code" href="class_i_p_c_1_1_response_builder.html#a12d9068ceac4de2e8c19e34ec42ce54e">Push</a>(<a class="code" href="union_result_code.html">ResultCode</a>(<a class="code" href="result_8h.html#afe30fc4506a4cf2ee780b2319dbec74da418ec6476e1acd92e17681f4bd00e3a3">ErrorDescription::NotAuthorized</a>, <a class="code" href="result_8h.html#a67158ef38e1ab9113151768007433e3aadb568ddcb8d3308155f19bdbadf655ca">ErrorModule::UDS</a>,</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;                           <a class="code" href="result_8h.html#a1d3c3229b2c38b6fe717b434732c5b86aedf260198e4d75d1cb3c7588f7380120">ErrorSummary::InvalidState</a>, <a class="code" href="result_8h.html#aa3b9056eb03ec4e7c3561192eb830739aec53a8c4f07baed5d8825072c89799be">ErrorLevel::Status</a>));</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;    }</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;    <span class="keyword">auto</span> channel{</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;        std::find_if(channel_data.begin(), channel_data.end(), [bind_node_id](<span class="keyword">const</span> <span class="keyword">auto</span>&amp; data) {</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;            <span class="keywordflow">return</span> data.second.bind_node_id == bind_node_id;</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;        })};</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;    <span class="keywordflow">if</span> (channel == channel_data.end()) {</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;        <a class="code" href="class_i_p_c_1_1_response_builder.html">IPC::ResponseBuilder</a> rb{rp.MakeBuilder(1, 0)};</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;        rb.<a class="code" href="class_i_p_c_1_1_response_builder.html#a12d9068ceac4de2e8c19e34ec42ce54e">Push</a>(<a class="code" href="union_result_code.html">ResultCode</a>(<a class="code" href="result_8h.html#afe30fc4506a4cf2ee780b2319dbec74da418ec6476e1acd92e17681f4bd00e3a3">ErrorDescription::NotAuthorized</a>, <a class="code" href="result_8h.html#a67158ef38e1ab9113151768007433e3aadb568ddcb8d3308155f19bdbadf655ca">ErrorModule::UDS</a>,</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;                           <a class="code" href="result_8h.html#a1d3c3229b2c38b6fe717b434732c5b86a5a738160747f39c20e9f65416931c974">ErrorSummary::WrongArgument</a>, <a class="code" href="result_8h.html#aa3b9056eb03ec4e7c3561192eb830739ac64518704ce0c0d5501a45763f464276">ErrorLevel::Usage</a>));</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;    }</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;    <span class="keywordflow">if</span> (channel-&gt;second.received_packets.empty()) {</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;        std::vector&lt;u8&gt; output_buffer(buff_size, 0);</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;        <a class="code" href="class_i_p_c_1_1_response_builder.html">IPC::ResponseBuilder</a> rb{rp.MakeBuilder(3, 2)};</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;        rb.<a class="code" href="class_i_p_c_1_1_response_builder.html#a12d9068ceac4de2e8c19e34ec42ce54e">Push</a>(<a class="code" href="result_8h.html#ac66ebacde94a19df5a65f34e8238cf79">RESULT_SUCCESS</a>);</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;        rb.Push&lt;<a class="code" href="common__types_8h.html#a65cf28726f89e62ccf2f1354bc2716df">u32</a>&gt;(0);</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;        rb.Push&lt;<a class="code" href="common__types_8h.html#a917e58b0692c2df778a27350534cbfe7">u16</a>&gt;(0);</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;        rb.PushStaticBuffer(output_buffer, 0);</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;    }</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; next_packet{channel-&gt;second.received_packets.front()};</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;    <span class="keyword">auto</span> secure_data{<a class="code" href="namespace_service_1_1_n_w_m.html#aee52175e01a75b74f42fd3810953a0a3">ParseSecureDataHeader</a>(next_packet)};</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;    <span class="keyword">auto</span> data_size{secure_data.<a class="code" href="struct_service_1_1_n_w_m_1_1_secure_data_header.html#a9239edf5337dde8e3399ebfdbeb0d703">GetActualDataSize</a>()};</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;    <span class="keywordflow">if</span> (data_size &gt; max_out_buff_size) {</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;        <a class="code" href="class_i_p_c_1_1_response_builder.html">IPC::ResponseBuilder</a> rb{rp.MakeBuilder(1, 0)};</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;        rb.<a class="code" href="class_i_p_c_1_1_response_builder.html#a12d9068ceac4de2e8c19e34ec42ce54e">Push</a>(<a class="code" href="union_result_code.html">ResultCode</a>(<a class="code" href="result_8h.html#afe30fc4506a4cf2ee780b2319dbec74da853d33bc5e409941bed899b913647310">ErrorDescription::TooLarge</a>, <a class="code" href="result_8h.html#a67158ef38e1ab9113151768007433e3aadb568ddcb8d3308155f19bdbadf655ca">ErrorModule::UDS</a>,</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;                           <a class="code" href="result_8h.html#a1d3c3229b2c38b6fe717b434732c5b86a5a738160747f39c20e9f65416931c974">ErrorSummary::WrongArgument</a>, <a class="code" href="result_8h.html#aa3b9056eb03ec4e7c3561192eb830739ac64518704ce0c0d5501a45763f464276">ErrorLevel::Usage</a>));</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;    }</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;    <a class="code" href="class_i_p_c_1_1_response_builder.html">IPC::ResponseBuilder</a> rb{rp.MakeBuilder(3, 2)};</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;    std::vector&lt;u8&gt; output_buffer(buff_size, 0);</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;    <span class="comment">// Write the actual data.</span></div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;    std::memcpy(output_buffer.data(),</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;                next_packet.data() + <span class="keyword">sizeof</span>(<a class="code" href="namespace_service_1_1_n_w_m.html#struct_service_1_1_n_w_m_1_1_l_l_c_header">LLCHeader</a>) + <span class="keyword">sizeof</span>(<a class="code" href="struct_service_1_1_n_w_m_1_1_secure_data_header.html">SecureDataHeader</a>), data_size);</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;    rb.Push(<a class="code" href="result_8h.html#ac66ebacde94a19df5a65f34e8238cf79">RESULT_SUCCESS</a>);</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;    rb.Push&lt;<a class="code" href="common__types_8h.html#a65cf28726f89e62ccf2f1354bc2716df">u32</a>&gt;(data_size);</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;    rb.Push&lt;<a class="code" href="common__types_8h.html#a917e58b0692c2df778a27350534cbfe7">u16</a>&gt;(secure_data.src_node_id);</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    rb.PushStaticBuffer(output_buffer, 0);</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;    channel-&gt;second.received_packets.pop_front();</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;}</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;</div><div class="line"><a name="l01124"></a><span class="lineno"><a class="line" href="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s.html#a4f3442e55f1e303e82f84f6d4f85d86a"> 1124</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s.html#a4f3442e55f1e303e82f84f6d4f85d86a">NWM_UDS::GetChannel</a>(<a class="code" href="class_kernel_1_1_h_l_e_request_context.html">Kernel::HLERequestContext</a>&amp; ctx) {</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;    <a class="code" href="class_i_p_c_1_1_request_parser.html">IPC::RequestParser</a> rp{ctx, 0x1A, 0, 0};</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;    <a class="code" href="class_i_p_c_1_1_response_builder.html">IPC::ResponseBuilder</a> rb{rp.MakeBuilder(2, 0)};</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;    std::lock_guard&lt;std::mutex&gt; lock{connection_status_mutex};</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;    <span class="keywordtype">bool</span> is_connected{<a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a>.<a class="code" href="struct_service_1_1_n_w_m_1_1_connection_status.html#a06757367dc9053bdb0f13218ddfdc90c">status</a> != <span class="keyword">static_cast&lt;</span><a class="code" href="common__types_8h.html#a65cf28726f89e62ccf2f1354bc2716df">u32</a><span class="keyword">&gt;</span>(<a class="code" href="namespace_service_1_1_n_w_m.html#a314d2573d77dfa9a69d021eb31ee2d64a4075072d219e061ca0f3124f8fbef463">NetworkStatus::NotConnected</a>)};</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;    <a class="code" href="common__types_8h.html#a254d32383658e016368673396e7afc1b">u8</a> channel{<span class="keyword">static_cast&lt;</span><a class="code" href="common__types_8h.html#a254d32383658e016368673396e7afc1b">u8</a><span class="keyword">&gt;</span>(is_connected ? <a class="code" href="namespace_service_1_1_n_w_m.html#a623a500ff8b4c3f1c93be76297039f1a">network_channel</a> : 0)};</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;    rb.Push(<a class="code" href="result_8h.html#ac66ebacde94a19df5a65f34e8238cf79">RESULT_SUCCESS</a>);</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;    rb.Push(channel);</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;    <a class="code" href="log_8h.html#add982f3fbcbb8bfd9e729ab9356efb34">LOG_DEBUG</a>(Service_NWM, <span class="stringliteral">&quot;called&quot;</span>);</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;}</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;</div><div class="line"><a name="l01139"></a><span class="lineno"><a class="line" href="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s.html#a0181a1054a6e33c22b9dfca84068721f"> 1139</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s.html#a0181a1054a6e33c22b9dfca84068721f">NWM_UDS::ConnectToNetwork</a>(<a class="code" href="class_kernel_1_1_h_l_e_request_context.html">Kernel::HLERequestContext</a>&amp; ctx) {</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;    <a class="code" href="class_i_p_c_1_1_request_parser.html">IPC::RequestParser</a> rp{ctx, 0x1E, 2, 4};</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;    <a class="code" href="common__types_8h.html#a254d32383658e016368673396e7afc1b">u8</a> connection_type{rp.Pop&lt;<a class="code" href="common__types_8h.html#a254d32383658e016368673396e7afc1b">u8</a>&gt;()};</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;    <a class="code" href="common__types_8h.html#a65cf28726f89e62ccf2f1354bc2716df">u32</a> passphrase_size{rp.Pop&lt;<a class="code" href="common__types_8h.html#a65cf28726f89e62ccf2f1354bc2716df">u32</a>&gt;()};</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;    <span class="keyword">const</span> std::vector&lt;u8&gt; network_struct_buffer{rp.PopStaticBuffer()};</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;    <a class="code" href="assert_8h.html#a9f920d5e0c0e8780d4ce9bfb15bfd9e2">ASSERT</a>(network_struct_buffer.size() == <span class="keyword">sizeof</span>(<a class="code" href="struct_service_1_1_n_w_m_1_1_network_info.html">NetworkInfo</a>));</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;    <span class="keyword">const</span> std::vector&lt;u8&gt; passphrase{rp.PopStaticBuffer()};</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;    std::memcpy(&amp;network_info, network_struct_buffer.data(), <span class="keyword">sizeof</span>(<a class="code" href="namespace_service_1_1_n_w_m.html#acea04888afd12666e6eedae3911874cb">network_info</a>));</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;    <span class="comment">// Start the connection sequence</span></div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;    <a class="code" href="namespace_service_1_1_n_w_m.html#a26061cab82222e36674d12abb22246f9">StartConnectionSequence</a>(network_info.<a class="code" href="struct_service_1_1_n_w_m_1_1_network_info.html#a2a29d90219373c16a753cc4ce7496d69">host_mac_address</a>);</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;    <span class="comment">// 300 ms</span></div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;    <span class="comment">// Since this timing is handled by core_timing it could differ from the &#39;real world&#39; time</span></div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;    <span class="keyword">static</span> constexpr std::chrono::nanoseconds UDSConnectionTimeout{300000000};</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;    connection_event = ctx.<a class="code" href="class_kernel_1_1_h_l_e_request_context.html#ac140c041a57b50c94a05e1db1e31da8a">SleepClientThread</a>(</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;        <a class="code" href="namespace_kernel.html#a468effefd7385726635010b18e69a625">Kernel::GetCurrentThread</a>(), <span class="stringliteral">&quot;uds::ConnectToNetwork&quot;</span>, UDSConnectionTimeout,</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;        [](<a class="code" href="namespace_kernel.html#afc9bde79933dd23864df0768adeb6cfe">Kernel::SharedPtr&lt;Kernel::Thread&gt;</a> thread, <a class="code" href="class_kernel_1_1_h_l_e_request_context.html">Kernel::HLERequestContext</a>&amp; ctx,</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;           <a class="code" href="thread_8h.html#a36bd654753f9fb7e2b269831f4e6ad80">ThreadWakeupReason</a> reason) {</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;            <span class="comment">// TODO(B3N30): Add error handling for host full and timeout</span></div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;            <a class="code" href="class_i_p_c_1_1_response_builder.html">IPC::ResponseBuilder</a> rb(ctx, 0x1E, 1, 0);</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;            rb.<a class="code" href="class_i_p_c_1_1_response_builder.html#a12d9068ceac4de2e8c19e34ec42ce54e">Push</a>(<a class="code" href="result_8h.html#ac66ebacde94a19df5a65f34e8238cf79">RESULT_SUCCESS</a>);</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;            <a class="code" href="log_8h.html#add982f3fbcbb8bfd9e729ab9356efb34">LOG_DEBUG</a>(Service_NWM, <span class="stringliteral">&quot;connection sequence finished&quot;</span>);</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;        });</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;    <a class="code" href="log_8h.html#add982f3fbcbb8bfd9e729ab9356efb34">LOG_DEBUG</a>(Service_NWM, <span class="stringliteral">&quot;called&quot;</span>);</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;}</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;</div><div class="line"><a name="l01172"></a><span class="lineno"><a class="line" href="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s.html#a17b84a4b1ecd13ac90f0fe55214de52b"> 1172</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s.html#a17b84a4b1ecd13ac90f0fe55214de52b">NWM_UDS::SetApplicationData</a>(<a class="code" href="class_kernel_1_1_h_l_e_request_context.html">Kernel::HLERequestContext</a>&amp; ctx) {</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;    <a class="code" href="class_i_p_c_1_1_request_parser.html">IPC::RequestParser</a> rp{ctx, 0x10, 1, 2};</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;    <a class="code" href="common__types_8h.html#a65cf28726f89e62ccf2f1354bc2716df">u32</a> size{rp.Pop&lt;<a class="code" href="common__types_8h.html#a65cf28726f89e62ccf2f1354bc2716df">u32</a>&gt;()};</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;    <span class="keyword">const</span> std::vector&lt;u8&gt; application_data{rp.PopStaticBuffer()};</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;    <a class="code" href="assert_8h.html#a9f920d5e0c0e8780d4ce9bfb15bfd9e2">ASSERT</a>(application_data.size() == size);</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;    <a class="code" href="class_i_p_c_1_1_response_builder.html">IPC::ResponseBuilder</a> rb{rp.MakeBuilder(1, 0)};</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;    <span class="keywordflow">if</span> (size &gt; <a class="code" href="namespace_service_1_1_n_w_m.html#a578cfa9541e1dd420a8d70b70e1b4c3f">ApplicationDataSize</a>) {</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;        rb.<a class="code" href="class_i_p_c_1_1_response_builder.html#a12d9068ceac4de2e8c19e34ec42ce54e">Push</a>(<a class="code" href="union_result_code.html">ResultCode</a>(<a class="code" href="result_8h.html#afe30fc4506a4cf2ee780b2319dbec74da853d33bc5e409941bed899b913647310">ErrorDescription::TooLarge</a>, <a class="code" href="result_8h.html#a67158ef38e1ab9113151768007433e3aadb568ddcb8d3308155f19bdbadf655ca">ErrorModule::UDS</a>,</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;                           <a class="code" href="result_8h.html#a1d3c3229b2c38b6fe717b434732c5b86a5a738160747f39c20e9f65416931c974">ErrorSummary::WrongArgument</a>, <a class="code" href="result_8h.html#aa3b9056eb03ec4e7c3561192eb830739ac64518704ce0c0d5501a45763f464276">ErrorLevel::Usage</a>));</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    }</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;    network_info.<a class="code" href="struct_service_1_1_n_w_m_1_1_network_info.html#afcf99c662bda09de56360616ecf44bec">application_data_size</a> = <span class="keyword">static_cast&lt;</span><a class="code" href="common__types_8h.html#a254d32383658e016368673396e7afc1b">u8</a><span class="keyword">&gt;</span>(size);</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;    std::memcpy(network_info.<a class="code" href="struct_service_1_1_n_w_m_1_1_network_info.html#a6c01dc193bef30171f2f75808715d8fb">application_data</a>.data(), application_data.data(), size);</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;    rb.Push(<a class="code" href="result_8h.html#ac66ebacde94a19df5a65f34e8238cf79">RESULT_SUCCESS</a>);</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;    <a class="code" href="log_8h.html#add982f3fbcbb8bfd9e729ab9356efb34">LOG_DEBUG</a>(Service_NWM, <span class="stringliteral">&quot;called&quot;</span>);</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;}</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;</div><div class="line"><a name="l01196"></a><span class="lineno"><a class="line" href="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s.html#a4d4239e4755ed9184b2655609ab6bd50"> 1196</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s.html#a4d4239e4755ed9184b2655609ab6bd50">NWM_UDS::DecryptBeaconData</a>(<a class="code" href="class_kernel_1_1_h_l_e_request_context.html">Kernel::HLERequestContext</a>&amp; ctx) {</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;    <a class="code" href="class_i_p_c_1_1_request_parser.html">IPC::RequestParser</a> rp{ctx, 0x1F, 0, 6};</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;    <span class="keyword">const</span> std::vector&lt;u8&gt; network_struct_buffer{rp.PopStaticBuffer()};</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;    <a class="code" href="assert_8h.html#a9f920d5e0c0e8780d4ce9bfb15bfd9e2">ASSERT</a>(network_struct_buffer.size() == <span class="keyword">sizeof</span>(<a class="code" href="struct_service_1_1_n_w_m_1_1_network_info.html">NetworkInfo</a>));</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;    <span class="keyword">const</span> std::vector&lt;u8&gt; encrypted_data0_buffer{rp.PopStaticBuffer()};</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;    <span class="keyword">const</span> std::vector&lt;u8&gt; encrypted_data1_buffer{rp.PopStaticBuffer()};</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;    <a class="code" href="struct_service_1_1_n_w_m_1_1_network_info.html">NetworkInfo</a> net_info;</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;    std::memcpy(&amp;net_info, network_struct_buffer.data(), <span class="keyword">sizeof</span>(net_info));</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;</div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;    <span class="comment">// Read the encrypted data.</span></div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;    <span class="comment">// The first 4 bytes should be the OUI and the OUI Type of the tags.</span></div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;    std::array&lt;u8, 3&gt; oui;</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;    std::memcpy(oui.data(), encrypted_data0_buffer.data(), oui.size());</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;    <a class="code" href="assert_8h.html#a4b432fb3d47e2ca732caf965691a54d7">ASSERT_MSG</a>(oui == <a class="code" href="namespace_service_1_1_n_w_m.html#ab3c2316d04955789ace86a6134f0744f">NintendoOUI</a>, <span class="stringliteral">&quot;Unexpected OUI&quot;</span>);</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;    <a class="code" href="assert_8h.html#a4b432fb3d47e2ca732caf965691a54d7">ASSERT_MSG</a>(encrypted_data0_buffer[3] == static_cast&lt;u8&gt;(<a class="code" href="namespace_service_1_1_n_w_m.html#ae989e39572d21634928c5b6c9ac2cf14a0e80f787a0a1950233a1da8545088973">NintendoTagId::EncryptedData0</a>),</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;               <span class="stringliteral">&quot;Unexpected tag id&quot;</span>);</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;    std::vector&lt;u8&gt; beacon_data(encrypted_data0_buffer.size() - 4 + encrypted_data1_buffer.size() -</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;                                4);</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;    std::memcpy(beacon_data.data(), encrypted_data0_buffer.data() + 4,</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;                encrypted_data0_buffer.size() - 4);</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;    std::memcpy(beacon_data.data() + encrypted_data0_buffer.size() - 4,</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;                encrypted_data1_buffer.data() + 4, encrypted_data1_buffer.size() - 4);</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;    <span class="comment">// Decrypt the data</span></div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;    <a class="code" href="namespace_service_1_1_n_w_m.html#a75f357ce8b314d69414357620a3526e8">DecryptBeacon</a>(net_info, beacon_data);</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;    <span class="comment">// The beacon data header contains the MD5 hash of the data.</span></div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;    <a class="code" href="namespace_service_1_1_n_w_m.html#struct_service_1_1_n_w_m_1_1_beacon_data">BeaconData</a> beacon_header;</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;    std::memcpy(&amp;beacon_header, beacon_data.data(), <span class="keyword">sizeof</span>(beacon_header));</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;    <span class="comment">// TODO(Subv): Verify the MD5 hash of the data and return 0xE1211005 if invalid.</span></div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;    <a class="code" href="common__types_8h.html#a254d32383658e016368673396e7afc1b">u8</a> num_nodes = net_info.<a class="code" href="struct_service_1_1_n_w_m_1_1_network_info.html#a769ed02f16d54595754344c23d4e21f2">max_nodes</a>;</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;    std::vector&lt;NodeInfo&gt; nodes{};</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i{}; i &lt; num_nodes; ++i) {</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;        <a class="code" href="namespace_service_1_1_n_w_m.html#struct_service_1_1_n_w_m_1_1_beacon_node_info">BeaconNodeInfo</a> info;</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;        std::memcpy(&amp;info, beacon_data.data() + <span class="keyword">sizeof</span>(beacon_header) + i * <span class="keyword">sizeof</span>(info),</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;                    <span class="keyword">sizeof</span>(info));</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;        <span class="comment">// Deserialize the node information.</span></div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;        <a class="code" href="struct_service_1_1_n_w_m_1_1_node_info.html">NodeInfo</a> node{};</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;        node.<a class="code" href="struct_service_1_1_n_w_m_1_1_node_info.html#a5c756567e2edbd225e405a96c2d47804">friend_code_seed</a> = info.<a class="code" href="namespace_service_1_1_n_w_m.html#a0f9e6fec76e341b4f6e48082b719a4a0">friend_code_seed</a>;</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;        node.network_node_id = info.<a class="code" href="namespace_service_1_1_n_w_m.html#a4538f58f318f833017c7342c9d276909">network_node_id</a>;</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i{}; i &lt; info.<a class="code" href="namespace_service_1_1_n_w_m.html#a5808d36540a614705c80c502e1d8bc3a">username</a>.size(); ++i)</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;            node.username[i] = info.<a class="code" href="namespace_service_1_1_n_w_m.html#a5808d36540a614705c80c502e1d8bc3a">username</a>[i];</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;        nodes.push_back(node);</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;    }</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;    <a class="code" href="class_i_p_c_1_1_response_builder.html">IPC::ResponseBuilder</a> rb{rp.MakeBuilder(1, 2)};</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;    rb.<a class="code" href="class_i_p_c_1_1_response_builder.html#a12d9068ceac4de2e8c19e34ec42ce54e">Push</a>(<a class="code" href="result_8h.html#ac66ebacde94a19df5a65f34e8238cf79">RESULT_SUCCESS</a>);</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;</div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;    std::vector&lt;u8&gt; output_buffer(<span class="keyword">sizeof</span>(<a class="code" href="struct_service_1_1_n_w_m_1_1_node_info.html">NodeInfo</a>) * <a class="code" href="namespace_service_1_1_n_w_m.html#aaa6d7f52f0368d386dd80541527062af">UDSMaxNodes</a>, 0);</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;    std::memcpy(output_buffer.data(), nodes.data(), <span class="keyword">sizeof</span>(<a class="code" href="struct_service_1_1_n_w_m_1_1_node_info.html">NodeInfo</a>) * nodes.size());</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;    rb.PushStaticBuffer(output_buffer, 0);</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;    <a class="code" href="log_8h.html#add982f3fbcbb8bfd9e729ab9356efb34">LOG_DEBUG</a>(Service_NWM, <span class="stringliteral">&quot;called&quot;</span>);</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;}</div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;<span class="comment">// Sends a 802.11 beacon frame with information about the current network.</span></div><div class="line"><a name="l01263"></a><span class="lineno"><a class="line" href="namespace_service_1_1_n_w_m.html#a229f7b9414c16c66ab194fa11fad984b"> 1263</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="namespace_service_1_1_n_w_m.html#a229f7b9414c16c66ab194fa11fad984b">BeaconBroadcastCallback</a>(<a class="code" href="common__types_8h.html#a66e1d499241ccae9a18a20a1f4f0590d">u64</a> userdata, <a class="code" href="common__types_8h.html#a35714c97d4ec315cb8c6e79d7b2a1cbc">s64</a> cycles_late) {</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;    <span class="comment">// Don&#39;t do anything if we&#39;re not actually hosting a network</span></div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a>.<a class="code" href="struct_service_1_1_n_w_m_1_1_connection_status.html#a06757367dc9053bdb0f13218ddfdc90c">status</a> != static_cast&lt;u32&gt;(<a class="code" href="namespace_service_1_1_n_w_m.html#a314d2573d77dfa9a69d021eb31ee2d64a1bacb914b9ecea50415b08ba2d438cc6">NetworkStatus::ConnectedAsHost</a>))</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;    std::vector&lt;u8&gt; frame{<a class="code" href="namespace_service_1_1_n_w_m.html#ad01424498f61b365371c41e7f3419829">GenerateBeaconFrame</a>(network_info, node_info)};</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;    <span class="keyword">using</span> <a class="code" href="struct_network_1_1_wifi_packet.html">Network::WifiPacket</a>;</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;    WifiPacket packet{};</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;    packet.<a class="code" href="struct_network_1_1_wifi_packet.html#a2e1c47a15b934e3cbdfa404309353ede">type</a> = WifiPacket::PacketType::Beacon;</div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;    packet.data = std::move(frame);</div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;    packet.destination_address = <a class="code" href="namespace_network.html#a8591cf445700107127c0f2bf46365e88">Network::BroadcastMac</a>;</div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;    packet.channel = <a class="code" href="namespace_service_1_1_n_w_m.html#a623a500ff8b4c3f1c93be76297039f1a">network_channel</a>;</div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;    <a class="code" href="namespace_service_1_1_n_w_m.html#aab843dbb97d49e6d10a14bcca9fc715c">SendPacket</a>(packet);</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;</div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;    <span class="comment">// Start broadcasting the network, send a beacon frame every 102.4ms.</span></div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;    <a class="code" href="namespace_core_timing.html#a9e1678c03397fd456975cc4060f6feab">CoreTiming::ScheduleEvent</a>(<a class="code" href="core__timing_8h.html#a624c4e2c1fbcf329eb4a48687ea63a40">msToCycles</a>(<a class="code" href="namespace_service_1_1_n_w_m.html#afca90cf98f6f7357d7c847ea65064ba2">DefaultBeaconInterval</a> * <a class="code" href="namespace_service_1_1_n_w_m.html#a60d846206c420364f50d25c937e939a8">MillisecondsPerTU</a>) - cycles_late,</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;                              beacon_broadcast_event, 0);</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;}</div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;</div><div class="line"><a name="l01284"></a><span class="lineno"><a class="line" href="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s.html#aff79c1d3afdfeaede4154a1f4a9d662a"> 1284</a></span>&#160;<a class="code" href="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s.html#aff79c1d3afdfeaede4154a1f4a9d662a">NWM_UDS::NWM_UDS</a>() : <a class="code" href="class_service_1_1_service_framework.html">ServiceFramework</a>(<span class="stringliteral">&quot;nwm::UDS&quot;</span>) {</div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;    <span class="keyword">static</span> <span class="keyword">const</span> FunctionInfo functions[] = {</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;        {0x000102C2, <span class="keyword">nullptr</span>, <span class="stringliteral">&quot;Initialize (deprecated)&quot;</span>},</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;        {0x00020000, <span class="keyword">nullptr</span>, <span class="stringliteral">&quot;Scrap&quot;</span>},</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;        {0x00030000, &amp;<a class="code" href="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s.html#a885b4dd51b5ea87c65381ce72f9b84d5">NWM_UDS::Shutdown</a>, <span class="stringliteral">&quot;Shutdown&quot;</span>},</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;        {0x00040402, <span class="keyword">nullptr</span>, <span class="stringliteral">&quot;CreateNetwork (deprecated)&quot;</span>},</div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;        {0x00050040, <span class="keyword">nullptr</span>, <span class="stringliteral">&quot;EjectClient&quot;</span>},</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;        {0x00060000, <span class="keyword">nullptr</span>, <span class="stringliteral">&quot;EjectSpectator&quot;</span>},</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;        {0x00070080, &amp;<a class="code" href="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s.html#aefd528e364772e2b58a0496f13cacdea">NWM_UDS::UpdateNetworkAttribute</a>, <span class="stringliteral">&quot;UpdateNetworkAttribute&quot;</span>},</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;        {0x00080000, &amp;<a class="code" href="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s.html#a1928d3ad8055f0b36954372268f86d55">NWM_UDS::DestroyNetwork</a>, <span class="stringliteral">&quot;DestroyNetwork&quot;</span>},</div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;        {0x00090442, <span class="keyword">nullptr</span>, <span class="stringliteral">&quot;ConnectNetwork (deprecated)&quot;</span>},</div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;        {0x000A0000, &amp;<a class="code" href="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s.html#a95814c1aba23c9d36d3e786cc2d931ac">NWM_UDS::DisconnectNetwork</a>, <span class="stringliteral">&quot;DisconnectNetwork&quot;</span>},</div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;        {0x000B0000, &amp;<a class="code" href="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s.html#a2708bbf5784ff52cb255384150b06805">NWM_UDS::GetConnectionStatus</a>, <span class="stringliteral">&quot;GetConnectionStatus&quot;</span>},</div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;        {0x000D0040, &amp;<a class="code" href="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s.html#a15c222781eb74ac8117aaa7cca86db4b">NWM_UDS::GetNodeInformation</a>, <span class="stringliteral">&quot;GetNodeInformation&quot;</span>},</div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;        {0x000E0006, <span class="keyword">nullptr</span>, <span class="stringliteral">&quot;DecryptBeaconData (deprecated)&quot;</span>},</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;        {0x000F0404, &amp;<a class="code" href="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s.html#a9f7afa7765a7161f808d14c36b9d1182">NWM_UDS::RecvBeaconBroadcastData</a>, <span class="stringliteral">&quot;RecvBeaconBroadcastData&quot;</span>},</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;        {0x00100042, &amp;<a class="code" href="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s.html#a17b84a4b1ecd13ac90f0fe55214de52b">NWM_UDS::SetApplicationData</a>, <span class="stringliteral">&quot;SetApplicationData&quot;</span>},</div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;        {0x00110040, <span class="keyword">nullptr</span>, <span class="stringliteral">&quot;GetApplicationData&quot;</span>},</div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;        {0x00120100, &amp;<a class="code" href="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s.html#a81891c30c576a8bacfa2b30a135a3e50">NWM_UDS::Bind</a>, <span class="stringliteral">&quot;Bind&quot;</span>},</div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;        {0x00130040, &amp;<a class="code" href="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s.html#ab191e3fec4ecec4fd93145df34ac9377">NWM_UDS::Unbind</a>, <span class="stringliteral">&quot;Unbind&quot;</span>},</div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;        {0x001400C0, &amp;<a class="code" href="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s.html#aa3511028df5fc7d0464b336fc289134c">NWM_UDS::PullPacket</a>, <span class="stringliteral">&quot;PullPacket&quot;</span>},</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;        {0x00150080, <span class="keyword">nullptr</span>, <span class="stringliteral">&quot;SetMaxSendDelay&quot;</span>},</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;        {0x00170182, &amp;<a class="code" href="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s.html#ab6e56082794235a29f85aba495714672">NWM_UDS::SendTo</a>, <span class="stringliteral">&quot;SendTo&quot;</span>},</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;        {0x001A0000, &amp;<a class="code" href="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s.html#a4f3442e55f1e303e82f84f6d4f85d86a">NWM_UDS::GetChannel</a>, <span class="stringliteral">&quot;GetChannel&quot;</span>},</div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;        {0x001B0302, &amp;<a class="code" href="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s.html#a4858cc14324340c8869896653f8278fc">NWM_UDS::InitializeWithVersion</a>, <span class="stringliteral">&quot;InitializeWithVersion&quot;</span>},</div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;        {0x001D0044, &amp;<a class="code" href="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s.html#a60d8b8de8acce4ab4588fd0dbabdfd40">NWM_UDS::BeginHostingNetwork</a>, <span class="stringliteral">&quot;BeginHostingNetwork&quot;</span>},</div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;        {0x001E0084, &amp;<a class="code" href="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s.html#a0181a1054a6e33c22b9dfca84068721f">NWM_UDS::ConnectToNetwork</a>, <span class="stringliteral">&quot;ConnectToNetwork&quot;</span>},</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;        {0x001F0006, &amp;<a class="code" href="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s.html#a4d4239e4755ed9184b2655609ab6bd50">NWM_UDS::DecryptBeaconData</a>, <span class="stringliteral">&quot;DecryptBeaconData&quot;</span>},</div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;        {0x00200040, <span class="keyword">nullptr</span>, <span class="stringliteral">&quot;Flush&quot;</span>},</div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;        {0x00210080, <span class="keyword">nullptr</span>, <span class="stringliteral">&quot;SetProbeResponseParam&quot;</span>},</div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;        {0x00220402, <span class="keyword">nullptr</span>, <span class="stringliteral">&quot;ScanOnConnection&quot;</span>},</div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;    };</div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;    connection_status_event =</div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;        <a class="code" href="class_kernel_1_1_event.html#a2a2e0b30f62fdd2fa9dd29ab64c7941f">Kernel::Event::Create</a>(<a class="code" href="namespace_kernel.html#aa2d109b9b88cb2530209ac79149e2811ac7fc2ee61fad0e2bba6754efdee31481">Kernel::ResetType::OneShot</a>, <span class="stringliteral">&quot;NWM::connection_status_event&quot;</span>);</div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;</div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;    <a class="code" href="class_service_1_1_service_framework.html#a54307718519bef2198366da0a7e69e0e">RegisterHandlers</a>(functions);</div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;</div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;    beacon_broadcast_event =</div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;        <a class="code" href="namespace_core_timing.html#ab4899206b9bc7858155c3a47cb9bce6e">CoreTiming::RegisterEvent</a>(<span class="stringliteral">&quot;UDS::BeaconBroadcastCallback&quot;</span>, <a class="code" href="namespace_service_1_1_n_w_m.html#a229f7b9414c16c66ab194fa11fad984b">BeaconBroadcastCallback</a>);</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;    CryptoPP::AutoSeededRandomPool rng{};</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;    <span class="keyword">auto</span> mac{<a class="code" href="namespace_shared_page.html#a82b8bd4b87adb7ddb47310c92f44fee6">SharedPage::DefaultMac</a>};</div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;    <span class="comment">// Keep the Nintendo 3DS MAC header and randomly generate the last 3 bytes</span></div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;    rng.GenerateBlock(static_cast&lt;CryptoPP::byte*&gt;(mac.data() + 3), 3);</div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> room_member{<a class="code" href="namespace_network.html#a5ee509b747f2af4c4110f7542a6efe8b">Network::GetRoomMember</a>().lock()}) {</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;        <span class="keywordflow">if</span> (room_member-&gt;IsConnected()) {</div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;            mac = room_member-&gt;GetMacAddress();</div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;        }</div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;    }</div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;    <a class="code" href="class_core_1_1_system.html#ab2f9ff357787ec877567d8c4ffe2a2d4">Core::System::GetInstance</a>().<a class="code" href="class_core_1_1_system.html#a4d8e4f4ed6fb89fa04908c4031d55140">GetSharedPageHandler</a>()-&gt;SetMacAddress(mac);</div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;}</div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;</div><div class="line"><a name="l01336"></a><span class="lineno"><a class="line" href="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s.html#a013a241a09271c2127fff6a4b54cf6c5"> 1336</a></span>&#160;<a class="code" href="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s.html#a013a241a09271c2127fff6a4b54cf6c5">NWM_UDS::~NWM_UDS</a>() {</div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;    network_info = {};</div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;    channel_data.clear();</div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;    connection_status_event = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;    recv_buffer_memory = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;    initialized = <span class="keyword">false</span>;</div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;</div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;    {</div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;        std::lock_guard&lt;std::mutex&gt; lock{connection_status_mutex};</div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;        <a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a> = {};</div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;        <a class="code" href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">connection_status</a>.<a class="code" href="struct_service_1_1_n_w_m_1_1_connection_status.html#a06757367dc9053bdb0f13218ddfdc90c">status</a> = <span class="keyword">static_cast&lt;</span><a class="code" href="common__types_8h.html#a65cf28726f89e62ccf2f1354bc2716df">u32</a><span class="keyword">&gt;</span>(<a class="code" href="namespace_service_1_1_n_w_m.html#a314d2573d77dfa9a69d021eb31ee2d64a4075072d219e061ca0f3124f8fbef463">NetworkStatus::NotConnected</a>);</div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;    }</div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;</div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> room_member{<a class="code" href="namespace_network.html#a5ee509b747f2af4c4110f7542a6efe8b">Network::GetRoomMember</a>().lock()})</div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;        room_member-&gt;Unbind(wifi_packet_received);</div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;</div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;    <a class="code" href="namespace_core_timing.html#a1d0fc13b562a6c699cdcbfd4ccdfbc10">CoreTiming::UnscheduleEvent</a>(beacon_broadcast_event, 0);</div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;}</div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;</div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;} <span class="comment">// namespace Service::NWM</span></div><div class="ttc" id="namespace_service_1_1_n_w_m_html_afca90cf98f6f7357d7c847ea65064ba2"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#afca90cf98f6f7357d7c847ea65064ba2">Service::NWM::DefaultBeaconInterval</a></div><div class="ttdeci">const u16 DefaultBeaconInterval</div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8h_source.html#l00024">nwm_uds.h:24</a></div></div>
<div class="ttc" id="result_8h_html_ac66ebacde94a19df5a65f34e8238cf79"><div class="ttname"><a href="result_8h.html#ac66ebacde94a19df5a65f34e8238cf79">RESULT_SUCCESS</a></div><div class="ttdeci">constexpr ResultCode RESULT_SUCCESS(0)</div><div class="ttdoc">The default success ResultCode. </div></div>
<div class="ttc" id="struct_service_1_1_n_w_m_1_1_connection_status_html_a350f538191a8b78051f3161d4e49440d"><div class="ttname"><a href="struct_service_1_1_n_w_m_1_1_connection_status.html#a350f538191a8b78051f3161d4e49440d">Service::NWM::ConnectionStatus::nodes</a></div><div class="ttdeci">u16_le nodes[UDSMaxNodes]</div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8h_source.html#l00054">nwm_uds.h:54</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_aa713fe363101df94d41248db0873dea0"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#aa713fe363101df94d41248db0873dea0">Service::NWM::GenerateEAPoLStartFrame</a></div><div class="ttdeci">std::vector&lt; u8 &gt; GenerateEAPoLStartFrame(u16 association_id, const NodeInfo &amp;node_info)</div><div class="ttdef"><b>Definition:</b> <a href="uds__data_8cpp_source.html#l00291">uds_data.cpp:291</a></div></div>
<div class="ttc" id="namespace_network_html_a8591cf445700107127c0f2bf46365e88"><div class="ttname"><a href="namespace_network.html#a8591cf445700107127c0f2bf46365e88">Network::BroadcastMac</a></div><div class="ttdeci">constexpr MacAddress BroadcastMac</div><div class="ttdef"><b>Definition:</b> <a href="room_8h_source.html#l00025">room.h:25</a></div></div>
<div class="ttc" id="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s_html_a95814c1aba23c9d36d3e786cc2d931ac"><div class="ttname"><a href="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s.html#a95814c1aba23c9d36d3e786cc2d931ac">Service::NWM::NWM_UDS::DisconnectNetwork</a></div><div class="ttdeci">void DisconnectNetwork(Kernel::HLERequestContext &amp;ctx)</div><div class="ttdoc">NWM_UDS::DisconnectNetwork service function. </div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8cpp_source.html#l00922">nwm_uds.cpp:922</a></div></div>
<div class="ttc" id="struct_network_1_1_wifi_packet_html_a9047c2d448a65b11b302c7e9d0870d39af6068daa29dbb05a7ead1e3b5a48bbee"><div class="ttname"><a href="struct_network_1_1_wifi_packet.html#a9047c2d448a65b11b302c7e9d0870d39af6068daa29dbb05a7ead1e3b5a48bbee">Network::WifiPacket::PacketType::Data</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_ac3f4477f0ba58e580d2bd4df3af43e25"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#ac3f4477f0ba58e580d2bd4df3af43e25">Service::NWM::node_map</a></div><div class="ttdeci">static std::map&lt; MacAddress, u16 &gt; node_map</div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8cpp_source.html#l00082">nwm_uds.cpp:82</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_acc28a753b636cdb61712a86275046f62"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#acc28a753b636cdb61712a86275046f62">Service::NWM::HandleAuthenticationFrame</a></div><div class="ttdeci">void HandleAuthenticationFrame(const Network::WifiPacket &amp;packet)</div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8cpp_source.html#l00454">nwm_uds.cpp:454</a></div></div>
<div class="ttc" id="lock_8h_html"><div class="ttname"><a href="lock_8h.html">lock.h</a></div></div>
<div class="ttc" id="class_i_p_c_1_1_response_builder_html_a12d9068ceac4de2e8c19e34ec42ce54e"><div class="ttname"><a href="class_i_p_c_1_1_response_builder.html#a12d9068ceac4de2e8c19e34ec42ce54e">IPC::ResponseBuilder::Push</a></div><div class="ttdeci">void Push(T value)</div></div>
<div class="ttc" id="memory_8h_html"><div class="ttname"><a href="memory_8h.html">memory.h</a></div></div>
<div class="ttc" id="result_8h_html_afe30fc4506a4cf2ee780b2319dbec74da853d33bc5e409941bed899b913647310"><div class="ttname"><a href="result_8h.html#afe30fc4506a4cf2ee780b2319dbec74da853d33bc5e409941bed899b913647310">ErrorDescription::TooLarge</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_afa54a85122325fb98c46c75ff1dc0df9"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#afa54a85122325fb98c46c75ff1dc0df9">Service::NWM::GetFrameEtherType</a></div><div class="ttdeci">EtherType GetFrameEtherType(const std::vector&lt; u8 &gt; &amp;frame)</div><div class="ttdef"><b>Definition:</b> <a href="uds__data_8cpp_source.html#l00312">uds_data.cpp:312</a></div></div>
<div class="ttc" id="struct_service_1_1_n_w_m_1_1_network_info_html_a8cf9b7de67292d2e626ecad3de82ffab"><div class="ttname"><a href="struct_service_1_1_n_w_m_1_1_network_info.html#a8cf9b7de67292d2e626ecad3de82ffab">Service::NWM::NetworkInfo::total_nodes</a></div><div class="ttdeci">u8 total_nodes</div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8h_source.html#l00076">nwm_uds.h:76</a></div></div>
<div class="ttc" id="class_i_p_c_1_1_request_parser_html"><div class="ttname"><a href="class_i_p_c_1_1_request_parser.html">IPC::RequestParser</a></div><div class="ttdef"><b>Definition:</b> <a href="ipc__helpers_8h_source.html#l00197">ipc_helpers.h:197</a></div></div>
<div class="ttc" id="log_8h_html_add982f3fbcbb8bfd9e729ab9356efb34"><div class="ttname"><a href="log_8h.html#add982f3fbcbb8bfd9e729ab9356efb34">LOG_DEBUG</a></div><div class="ttdeci">#define LOG_DEBUG(log_class,...)</div><div class="ttdef"><b>Definition:</b> <a href="log_8h_source.html#l00127">log.h:127</a></div></div>
<div class="ttc" id="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s_html_a4f3442e55f1e303e82f84f6d4f85d86a"><div class="ttname"><a href="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s.html#a4f3442e55f1e303e82f84f6d4f85d86a">Service::NWM::NWM_UDS::GetChannel</a></div><div class="ttdeci">void GetChannel(Kernel::HLERequestContext &amp;ctx)</div><div class="ttdoc">NWM_UDS::GetChannel service function. </div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8cpp_source.html#l01124">nwm_uds.cpp:1124</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_a4f2383c166106c0e6e6d96d6ad52c5c0"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#a4f2383c166106c0e6e6d96d6ad52c5c0">Service::NWM::GenerateDataPayload</a></div><div class="ttdeci">std::vector&lt; u8 &gt; GenerateDataPayload(const std::vector&lt; u8 &gt; &amp;data, u8 channel, u16 dest_node, u16 src_node, u16 sequence_number)</div><div class="ttdoc">Generates an unencrypted 802.11 data payload. </div><div class="ttdef"><b>Definition:</b> <a href="uds__data_8cpp_source.html#l00271">uds_data.cpp:271</a></div></div>
<div class="ttc" id="struct_service_1_1_n_w_m_1_1_network_info_html_a2a29d90219373c16a753cc4ce7496d69"><div class="ttname"><a href="struct_service_1_1_n_w_m_1_1_network_info.html#a2a29d90219373c16a753cc4ce7496d69">Service::NWM::NetworkInfo::host_mac_address</a></div><div class="ttdeci">std::array&lt; u8, 6 &gt; host_mac_address</div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8h_source.html#l00063">nwm_uds.h:63</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_a1607ea35acaa873bc8554c269c90e0b3"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#a1607ea35acaa873bc8554c269c90e0b3">Service::NWM::connection_status_mutex</a></div><div class="ttdeci">static std::mutex connection_status_mutex</div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8cpp_source.html#l00092">nwm_uds.cpp:92</a></div></div>
<div class="ttc" id="core_2hle_2kernel_2event_8h_html"><div class="ttname"><a href="core_2hle_2kernel_2event_8h.html">event.h</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_a178bbf8dd6a12282d613d95aee419040"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#a178bbf8dd6a12282d613d95aee419040">Service::NWM::GetNextAvailableNodeId</a></div><div class="ttdeci">static u16 GetNextAvailableNodeId()</div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8cpp_source.html#l00145">nwm_uds.cpp:145</a></div></div>
<div class="ttc" id="struct_network_1_1_wifi_packet_html_a9047c2d448a65b11b302c7e9d0870d39a4cc567608b06d0cc686ac005ed880fab"><div class="ttname"><a href="struct_network_1_1_wifi_packet.html#a9047c2d448a65b11b302c7e9d0870d39a4cc567608b06d0cc686ac005ed880fab">Network::WifiPacket::PacketType::NodeMap</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_a67935288aed4bb0336843d027cfe7d97"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#a67935288aed4bb0336843d027cfe7d97">Service::NWM::HandleEAPoLPacket</a></div><div class="ttdeci">static void HandleEAPoLPacket(const Network::WifiPacket &amp;packet)</div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8cpp_source.html#l00236">nwm_uds.cpp:236</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_aae62a987ff6f4603fe91fc442bd11381ac2e447397f0d5365b1d3fcc38133ea9a"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#aae62a987ff6f4603fe91fc442bd11381ac2e447397f0d5365b1d3fcc38133ea9a">Service::NWM::AuthenticationSeq::SEQ2</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_ab3c2316d04955789ace86a6134f0744f"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#ab3c2316d04955789ace86a6134f0744f">Service::NWM::NintendoOUI</a></div><div class="ttdeci">constexpr std::array&lt; u8, 3 &gt; NintendoOUI</div><div class="ttdef"><b>Definition:</b> <a href="uds__beacon_8h_source.html#l00017">uds_beacon.h:17</a></div></div>
<div class="ttc" id="class_kernel_1_1_event_html_a2a2e0b30f62fdd2fa9dd29ab64c7941f"><div class="ttname"><a href="class_kernel_1_1_event.html#a2a2e0b30f62fdd2fa9dd29ab64c7941f">Kernel::Event::Create</a></div><div class="ttdeci">static SharedPtr&lt; Event &gt; Create(ResetType reset_type, std::string name=&quot;Unknown&quot;)</div><div class="ttdoc">Creates an event. </div><div class="ttdef"><b>Definition:</b> <a href="event_8cpp_source.html#l00018">event.cpp:18</a></div></div>
<div class="ttc" id="nwm__uds_8h_html"><div class="ttname"><a href="nwm__uds_8h.html">nwm_uds.h</a></div></div>
<div class="ttc" id="struct_service_1_1_n_w_m_1_1_network_info_html_afcf99c662bda09de56360616ecf44bec"><div class="ttname"><a href="struct_service_1_1_n_w_m_1_1_network_info.html#afcf99c662bda09de56360616ecf44bec">Service::NWM::NetworkInfo::application_data_size</a></div><div class="ttdeci">u8 application_data_size</div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8h_source.html#l00080">nwm_uds.h:80</a></div></div>
<div class="ttc" id="common__types_8h_html_a254d32383658e016368673396e7afc1b"><div class="ttname"><a href="common__types_8h.html#a254d32383658e016368673396e7afc1b">u8</a></div><div class="ttdeci">std::uint8_t u8</div><div class="ttdoc">8-bit unsigned byte </div><div class="ttdef"><b>Definition:</b> <a href="common__types_8h_source.html#l00035">common_types.h:35</a></div></div>
<div class="ttc" id="namespace_kernel_html_afc9bde79933dd23864df0768adeb6cfe"><div class="ttname"><a href="namespace_kernel.html#afc9bde79933dd23864df0768adeb6cfe">Kernel::SharedPtr</a></div><div class="ttdeci">boost::intrusive_ptr&lt; T &gt; SharedPtr</div><div class="ttdef"><b>Definition:</b> <a href="object_8h_source.html#l00093">object.h:93</a></div></div>
<div class="ttc" id="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s_html_aff79c1d3afdfeaede4154a1f4a9d662a"><div class="ttname"><a href="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s.html#aff79c1d3afdfeaede4154a1f4a9d662a">Service::NWM::NWM_UDS::NWM_UDS</a></div><div class="ttdeci">NWM_UDS()</div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8cpp_source.html#l01284">nwm_uds.cpp:1284</a></div></div>
<div class="ttc" id="class_kernel_1_1_event_html"><div class="ttname"><a href="class_kernel_1_1_event.html">Kernel::Event</a></div><div class="ttdef"><b>Definition:</b> <a href="core_2hle_2kernel_2event_8h_source.html#l00013">event.h:13</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_ad199ee024cf8380a02ba2e884f0892fc"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#ad199ee024cf8380a02ba2e884f0892fc">Service::NWM::OnWifiPacketReceived</a></div><div class="ttdeci">void OnWifiPacketReceived(const Network::WifiPacket &amp;packet)</div><div class="ttdoc">Callback to parse and handle a received wifi packet. </div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8cpp_source.html#l00522">nwm_uds.cpp:522</a></div></div>
<div class="ttc" id="log_8h_html_a2f872ec42bda0e5baf8783313a28494c"><div class="ttname"><a href="log_8h.html#a2f872ec42bda0e5baf8783313a28494c">LOG_ERROR</a></div><div class="ttdeci">#define LOG_ERROR(log_class,...)</div><div class="ttdef"><b>Definition:</b> <a href="log_8h_source.html#l00136">log.h:136</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_a3b77ebaf6597a65dfcaadbcad27f0e31"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#a3b77ebaf6597a65dfcaadbcad27f0e31">Service::NWM::BindNodeData::bind_node_id</a></div><div class="ttdeci">u32 bind_node_id</div><div class="ttdoc">Id of the bind node associated with this data. </div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8cpp_source.html#l00063">nwm_uds.cpp:63</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_aee52175e01a75b74f42fd3810953a0a3"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#aee52175e01a75b74f42fd3810953a0a3">Service::NWM::ParseSecureDataHeader</a></div><div class="ttdeci">SecureDataHeader ParseSecureDataHeader(const std::vector&lt; u8 &gt; &amp;data)</div><div class="ttdef"><b>Definition:</b> <a href="uds__data_8cpp_source.html#l00282">uds_data.cpp:282</a></div></div>
<div class="ttc" id="uds__connection_8h_html"><div class="ttname"><a href="uds__connection_8h.html">uds_connection.h</a></div></div>
<div class="ttc" id="struct_service_1_1_n_w_m_1_1_network_info_html_a65308fed80930695564866bc1396361e"><div class="ttname"><a href="struct_service_1_1_n_w_m_1_1_network_info.html#a65308fed80930695564866bc1396361e">Service::NWM::NetworkInfo::channel</a></div><div class="ttdeci">u8 channel</div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8h_source.html#l00064">nwm_uds.h:64</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_a103b54629406e058fb318ab165116320"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#a103b54629406e058fb318ab165116320">Service::NWM::DeserializeNodeInfo</a></div><div class="ttdeci">NodeInfo DeserializeNodeInfo(const EAPoLNodeInfo &amp;node)</div><div class="ttdef"><b>Definition:</b> <a href="uds__data_8cpp_source.html#l00342">uds_data.cpp:342</a></div></div>
<div class="ttc" id="class_kernel_1_1_shared_memory_html"><div class="ttname"><a href="class_kernel_1_1_shared_memory.html">Kernel::SharedMemory</a></div><div class="ttdef"><b>Definition:</b> <a href="core_2hle_2kernel_2shared__memory_8h_source.html#l00028">shared_memory.h:28</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_a94a14466865b6846cf049524147b52b0"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#a94a14466865b6846cf049524147b52b0">Service::NWM::DeserializeNodeInfoFromFrame</a></div><div class="ttdeci">NodeInfo DeserializeNodeInfoFromFrame(const std::vector&lt; u8 &gt; &amp;frame)</div><div class="ttdef"><b>Definition:</b> <a href="uds__data_8cpp_source.html#l00327">uds_data.cpp:327</a></div></div>
<div class="ttc" id="namespace_core_timing_html_a9e1678c03397fd456975cc4060f6feab"><div class="ttname"><a href="namespace_core_timing.html#a9e1678c03397fd456975cc4060f6feab">CoreTiming::ScheduleEvent</a></div><div class="ttdeci">void ScheduleEvent(s64 cycles_into_future, const EventType *event_type, u64 userdata)</div><div class="ttdoc">After the first Advance, the slice lengths and the downcount will be reduced whenever an event is sch...</div><div class="ttdef"><b>Definition:</b> <a href="core__timing_8cpp_source.html#l00135">core_timing.cpp:135</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_aa8893d16a17753698cd0c699d125d726"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#aa8893d16a17753698cd0c699d125d726">Service::NWM::DefaultNetworkChannel</a></div><div class="ttdeci">const u8 DefaultNetworkChannel</div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8h_source.html#l00019">nwm_uds.h:19</a></div></div>
<div class="ttc" id="core_8h_html"><div class="ttname"><a href="core_8h.html">core.h</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_aae62a987ff6f4603fe91fc442bd11381af36c817f45dc37d3738a7ebe34aa4d26"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#aae62a987ff6f4603fe91fc442bd11381af36c817f45dc37d3738a7ebe34aa4d26">Service::NWM::AuthenticationSeq::SEQ1</a></div></div>
<div class="ttc" id="namespace_core_timing_html_ab4899206b9bc7858155c3a47cb9bce6e"><div class="ttname"><a href="namespace_core_timing.html#ab4899206b9bc7858155c3a47cb9bce6e">CoreTiming::RegisterEvent</a></div><div class="ttdeci">EventType * RegisterEvent(const std::string &amp;name, TimedCallback callback)</div><div class="ttdoc">Returns the event_type identifier. </div><div class="ttdef"><b>Definition:</b> <a href="core__timing_8cpp_source.html#l00072">core_timing.cpp:72</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_a229f7b9414c16c66ab194fa11fad984b"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#a229f7b9414c16c66ab194fa11fad984b">Service::NWM::BeaconBroadcastCallback</a></div><div class="ttdeci">static void BeaconBroadcastCallback(u64 userdata, s64 cycles_late)</div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8cpp_source.html#l01263">nwm_uds.cpp:1263</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_struct_service_1_1_n_w_m_1_1_beacon_node_info"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#struct_service_1_1_n_w_m_1_1_beacon_node_info">Service::NWM::BeaconNodeInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="uds__beacon_8h_source.html#l00110">uds_beacon.h:110</a></div></div>
<div class="ttc" id="class_network_1_1_room_member_html_a4fb1681ff11cc6027849e85aa917b5aca7d50c09f1ad7d098e0a847bcdcab7efb"><div class="ttname"><a href="class_network_1_1_room_member.html#a4fb1681ff11cc6027849e85aa917b5aca7d50c09f1ad7d098e0a847bcdcab7efb">Network::RoomMember::State::Joined</a></div><div class="ttdoc">The client is connected to the room and is ready to send/receive packets. </div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_a2fc2dee0d5c58ef8768b4c450f650c65"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#a2fc2dee0d5c58ef8768b4c450f650c65">Service::NWM::EAPoLStartMagic</a></div><div class="ttdeci">constexpr u16 EAPoLStartMagic</div><div class="ttdef"><b>Definition:</b> <a href="uds__data_8h_source.html#l00084">uds_data.h:84</a></div></div>
<div class="ttc" id="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s_html_a0181a1054a6e33c22b9dfca84068721f"><div class="ttname"><a href="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s.html#a0181a1054a6e33c22b9dfca84068721f">Service::NWM::NWM_UDS::ConnectToNetwork</a></div><div class="ttdeci">void ConnectToNetwork(Kernel::HLERequestContext &amp;ctx)</div><div class="ttdoc">NWM_UDS::ConnectToNetwork service function. </div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8cpp_source.html#l01139">nwm_uds.cpp:1139</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_a2a915093b75121e760a3c2578eceb44a"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#a2a915093b75121e760a3c2578eceb44a">Service::NWM::wifi_packet_received</a></div><div class="ttdeci">static Network::RoomMember::CallbackHandle&lt; Network::WifiPacket &gt; wifi_packet_received</div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8cpp_source.html#l00088">nwm_uds.cpp:88</a></div></div>
<div class="ttc" id="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s_html_aa3511028df5fc7d0464b336fc289134c"><div class="ttname"><a href="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s.html#aa3511028df5fc7d0464b336fc289134c">Service::NWM::NWM_UDS::PullPacket</a></div><div class="ttdeci">void PullPacket(Kernel::HLERequestContext &amp;ctx)</div><div class="ttdoc">NWM_UDS::PullPacket service function. </div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8cpp_source.html#l01055">nwm_uds.cpp:1055</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_a58ef6a8158f680004df214759843213b"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#a58ef6a8158f680004df214759843213b">Service::NWM::BindNodeData::received_packets</a></div><div class="ttdeci">std::deque&lt; std::vector&lt; u8 &gt; &gt; received_packets</div><div class="ttdoc">List of packets received on this channel. </div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8cpp_source.html#l00068">nwm_uds.cpp:68</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_a31d1ba9f2dedeb1ba5fb5588db9d1213"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#a31d1ba9f2dedeb1ba5fb5588db9d1213">Service::NWM::HandleBeaconFrame</a></div><div class="ttdeci">void HandleBeaconFrame(const Network::WifiPacket &amp;packet)</div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8cpp_source.html#l00195">nwm_uds.cpp:195</a></div></div>
<div class="ttc" id="class_kernel_1_1_mapped_buffer_html"><div class="ttname"><a href="class_kernel_1_1_mapped_buffer.html">Kernel::MappedBuffer</a></div><div class="ttdef"><b>Definition:</b> <a href="hle__ipc_8h_source.html#l00096">hle_ipc.h:96</a></div></div>
<div class="ttc" id="result_8h_html_a1d3c3229b2c38b6fe717b434732c5b86a219a93c69d452d35797d93e2cbe39ba2"><div class="ttname"><a href="result_8h.html#a1d3c3229b2c38b6fe717b434732c5b86a219a93c69d452d35797d93e2cbe39ba2">ErrorSummary::StatusChanged</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_acea04888afd12666e6eedae3911874cb"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#acea04888afd12666e6eedae3911874cb">Service::NWM::network_info</a></div><div class="ttdeci">static NetworkInfo network_info</div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8cpp_source.html#l00079">nwm_uds.cpp:79</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_aa5afda8b42249b5e3ca4e878132b5f35"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#aa5afda8b42249b5e3ca4e878132b5f35">Service::NWM::GenerateEAPoLLogoffFrame</a></div><div class="ttdeci">std::vector&lt; u8 &gt; GenerateEAPoLLogoffFrame(const MacAddress &amp;mac_address, u16 network_node_id, const NodeList &amp;nodes, u8 max_nodes, u8 total_nodes)</div><div class="ttdef"><b>Definition:</b> <a href="uds__data_8cpp_source.html#l00352">uds_data.cpp:352</a></div></div>
<div class="ttc" id="struct_network_1_1_wifi_packet_html"><div class="ttname"><a href="struct_network_1_1_wifi_packet.html">Network::WifiPacket</a></div><div class="ttdoc">Information about the received WiFi packets. Acts as our own 802.11 header. </div><div class="ttdef"><b>Definition:</b> <a href="room__member_8h_source.html#l00018">room_member.h:18</a></div></div>
<div class="ttc" id="namespace_core_timing_html_struct_core_timing_1_1_event_type"><div class="ttname"><a href="namespace_core_timing.html#struct_core_timing_1_1_event_type">CoreTiming::EventType</a></div><div class="ttdef"><b>Definition:</b> <a href="core__timing_8cpp_source.html#l00024">core_timing.cpp:24</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_a40782c25f8e2245967fea19eb609f447"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#a40782c25f8e2245967fea19eb609f447">Service::NWM::BeaconDataReplyHeader::total_entries</a></div><div class="ttdeci">u32_le total_entries</div><div class="ttdef"><b>Definition:</b> <a href="uds__beacon_8h_source.html#l00046">uds_beacon.h:46</a></div></div>
<div class="ttc" id="struct_network_1_1_wifi_packet_html_a9047c2d448a65b11b302c7e9d0870d39a825f958719f81a0837b34b763ec1eed4"><div class="ttname"><a href="struct_network_1_1_wifi_packet.html#a9047c2d448a65b11b302c7e9d0870d39a825f958719f81a0837b34b763ec1eed4">Network::WifiPacket::PacketType::Deauthentication</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_struct_service_1_1_n_w_m_1_1_beacon_data"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#struct_service_1_1_n_w_m_1_1_beacon_data">Service::NWM::BeaconData</a></div><div class="ttdef"><b>Definition:</b> <a href="uds__beacon_8h_source.html#l00118">uds_beacon.h:118</a></div></div>
<div class="ttc" id="result_8h_html_afe30fc4506a4cf2ee780b2319dbec74dab498327feeb51430af73e07deac268fd"><div class="ttname"><a href="result_8h.html#afe30fc4506a4cf2ee780b2319dbec74dab498327feeb51430af73e07deac268fd">ErrorDescription::OutOfMemory</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_a317f4717f4324bfa17f07f9965f78952"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#a317f4717f4324bfa17f07f9965f78952">Service::NWM::channel_data</a></div><div class="ttdeci">static std::unordered_map&lt; u32, BindNodeData &gt; channel_data</div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8cpp_source.html#l00072">nwm_uds.cpp:72</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_aba7a5e5ca1e111160bac8dc5180ebffe"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#aba7a5e5ca1e111160bac8dc5180ebffe">Service::NWM::connection_event</a></div><div class="ttdeci">static Kernel::SharedPtr&lt; Kernel::Event &gt; connection_event</div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8cpp_source.html#l00094">nwm_uds.cpp:94</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_a623a500ff8b4c3f1c93be76297039f1a"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#a623a500ff8b4c3f1c93be76297039f1a">Service::NWM::network_channel</a></div><div class="ttdeci">static u8 network_channel</div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8cpp_source.html#l00076">nwm_uds.cpp:76</a></div></div>
<div class="ttc" id="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s_html_a4d4239e4755ed9184b2655609ab6bd50"><div class="ttname"><a href="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s.html#a4d4239e4755ed9184b2655609ab6bd50">Service::NWM::NWM_UDS::DecryptBeaconData</a></div><div class="ttdeci">void DecryptBeaconData(Kernel::HLERequestContext &amp;ctx)</div><div class="ttdoc">NWM_UDS::DecryptBeaconData service function. </div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8cpp_source.html#l01196">nwm_uds.cpp:1196</a></div></div>
<div class="ttc" id="log_8h_html_a8b510d36fc8a109f98395ce9b6ada954"><div class="ttname"><a href="log_8h.html#a8b510d36fc8a109f98395ce9b6ada954">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING(log_class,...)</div><div class="ttdef"><b>Definition:</b> <a href="log_8h_source.html#l00133">log.h:133</a></div></div>
<div class="ttc" id="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s_html_a60d8b8de8acce4ab4588fd0dbabdfd40"><div class="ttname"><a href="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s.html#a60d8b8de8acce4ab4588fd0dbabdfd40">Service::NWM::NWM_UDS::BeginHostingNetwork</a></div><div class="ttdeci">void BeginHostingNetwork(Kernel::HLERequestContext &amp;ctx)</div><div class="ttdoc">NWM_UDS::BeginHostingNetwork service function. </div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8cpp_source.html#l00804">nwm_uds.cpp:804</a></div></div>
<div class="ttc" id="class_service_1_1_service_framework_html"><div class="ttname"><a href="class_service_1_1_service_framework.html">Service::ServiceFramework</a></div><div class="ttdoc">Framework for implementing HLE services. </div><div class="ttdef"><b>Definition:</b> <a href="service_8h_source.html#l00118">service.h:118</a></div></div>
<div class="ttc" id="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s_html_ab6e56082794235a29f85aba495714672"><div class="ttname"><a href="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s.html#ab6e56082794235a29f85aba495714672">Service::NWM::NWM_UDS::SendTo</a></div><div class="ttdeci">void SendTo(Kernel::HLERequestContext &amp;ctx)</div><div class="ttdoc">NWM_UDS::SendTo service function. </div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8cpp_source.html#l00967">nwm_uds.cpp:967</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_aaacd42de61b1338198e6097d11860547ab6189e2265d9602f92b4ed5c21c587b4"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#aaacd42de61b1338198e6097d11860547ab6189e2265d9602f92b4ed5c21c587b4">Service::NWM::EtherType::EAPoL</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_a9963cc544896afb34b26fbee1ba671c5"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#a9963cc544896afb34b26fbee1ba671c5">Service::NWM::connection_status_event</a></div><div class="ttdeci">static Kernel::SharedPtr&lt; Kernel::Event &gt; connection_status_event</div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8cpp_source.html#l00041">nwm_uds.cpp:41</a></div></div>
<div class="ttc" id="common__types_8h_html_a35714c97d4ec315cb8c6e79d7b2a1cbc"><div class="ttname"><a href="common__types_8h.html#a35714c97d4ec315cb8c6e79d7b2a1cbc">s64</a></div><div class="ttdeci">std::int64_t s64</div><div class="ttdoc">64-bit signed int </div><div class="ttdef"><b>Definition:</b> <a href="common__types_8h_source.html#l00043">common_types.h:43</a></div></div>
<div class="ttc" id="class_kernel_1_1_h_l_e_request_context_html_ac140c041a57b50c94a05e1db1e31da8a"><div class="ttname"><a href="class_kernel_1_1_h_l_e_request_context.html#ac140c041a57b50c94a05e1db1e31da8a">Kernel::HLERequestContext::SleepClientThread</a></div><div class="ttdeci">SharedPtr&lt; Event &gt; SleepClientThread(SharedPtr&lt; Thread &gt; thread, const std::string &amp;reason, std::chrono::nanoseconds timeout, WakeupCallback &amp;&amp;callback)</div><div class="ttdoc">Puts the specified guest thread to sleep until the returned event is signaled or until the specified ...</div><div class="ttdef"><b>Definition:</b> <a href="hle__ipc_8cpp_source.html#l00034">hle_ipc.cpp:34</a></div></div>
<div class="ttc" id="class_network_1_1_room_member_html_aa5637d98c13810dcee05de0bc41f25df"><div class="ttname"><a href="class_network_1_1_room_member.html#aa5637d98c13810dcee05de0bc41f25df">Network::RoomMember::CallbackHandle</a></div><div class="ttdeci">std::shared_ptr&lt; std::function&lt; void(const T &amp;)&gt; &gt; CallbackHandle</div><div class="ttdef"><b>Definition:</b> <a href="room__member_8h_source.html#l00057">room_member.h:57</a></div></div>
<div class="ttc" id="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s_html_a2708bbf5784ff52cb255384150b06805"><div class="ttname"><a href="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s.html#a2708bbf5784ff52cb255384150b06805">Service::NWM::NWM_UDS::GetConnectionStatus</a></div><div class="ttdeci">void GetConnectionStatus(Kernel::HLERequestContext &amp;ctx)</div><div class="ttdoc">NWM_UDS::GetConnectionStatus service function. </div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8cpp_source.html#l00671">nwm_uds.cpp:671</a></div></div>
<div class="ttc" id="common__types_8h_html"><div class="ttname"><a href="common__types_8h.html">common_types.h</a></div><div class="ttdoc">Copyright (C) 2005-2012 Gekko Emulator. </div></div>
<div class="ttc" id="result_8h_html_a1d3c3229b2c38b6fe717b434732c5b86aedf260198e4d75d1cb3c7588f7380120"><div class="ttname"><a href="result_8h.html#a1d3c3229b2c38b6fe717b434732c5b86aedf260198e4d75d1cb3c7588f7380120">ErrorSummary::InvalidState</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_struct_service_1_1_n_w_m_1_1_l_l_c_header"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#struct_service_1_1_n_w_m_1_1_l_l_c_header">Service::NWM::LLCHeader</a></div><div class="ttdef"><b>Definition:</b> <a href="uds__data_8h_source.html#l00027">uds_data.h:27</a></div></div>
<div class="ttc" id="assert_8h_html_a4b432fb3d47e2ca732caf965691a54d7"><div class="ttname"><a href="assert_8h.html#a4b432fb3d47e2ca732caf965691a54d7">ASSERT_MSG</a></div><div class="ttdeci">#define ASSERT_MSG(_a_,...)</div><div class="ttdef"><b>Definition:</b> <a href="assert_8h_source.html#l00037">assert.h:37</a></div></div>
<div class="ttc" id="result_8h_html"><div class="ttname"><a href="result_8h.html">result.h</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_a314d2573d77dfa9a69d021eb31ee2d64a1da5da12c73a39a25f9fbc26df6b96f0"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#a314d2573d77dfa9a69d021eb31ee2d64a1da5da12c73a39a25f9fbc26df6b96f0">Service::NWM::NetworkStatus::ConnectedAsSpectator</a></div></div>
<div class="ttc" id="struct_service_1_1_n_w_m_1_1_network_info_html_a769ed02f16d54595754344c23d4e21f2"><div class="ttname"><a href="struct_service_1_1_n_w_m_1_1_network_info.html#a769ed02f16d54595754344c23d4e21f2">Service::NWM::NetworkInfo::max_nodes</a></div><div class="ttdeci">u8 max_nodes</div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8h_source.html#l00077">nwm_uds.h:77</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_a0dde7396fe6df5c5f3f57972cf98203f"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#a0dde7396fe6df5c5f3f57972cf98203f">Service::NWM::BroadcastNetworkNodeId</a></div><div class="ttdeci">constexpr u16 BroadcastNetworkNodeId</div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8cpp_source.html#l00108">nwm_uds.cpp:108</a></div></div>
<div class="ttc" id="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s_html_aefd528e364772e2b58a0496f13cacdea"><div class="ttname"><a href="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s.html#aefd528e364772e2b58a0496f13cacdea">Service::NWM::NWM_UDS::UpdateNetworkAttribute</a></div><div class="ttdeci">void UpdateNetworkAttribute(Kernel::HLERequestContext &amp;ctx)</div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8cpp_source.html#l00876">nwm_uds.cpp:876</a></div></div>
<div class="ttc" id="struct_network_1_1_wifi_packet_html_a9047c2d448a65b11b302c7e9d0870d39ac75f7811d70d17dbcd88e9d03752cbed"><div class="ttname"><a href="struct_network_1_1_wifi_packet.html#a9047c2d448a65b11b302c7e9d0870d39ac75f7811d70d17dbcd88e9d03752cbed">Network::WifiPacket::PacketType::Authentication</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_a4538f58f318f833017c7342c9d276909"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#a4538f58f318f833017c7342c9d276909">Service::NWM::BeaconNodeInfo::network_node_id</a></div><div class="ttdeci">u16_be network_node_id</div><div class="ttdef"><b>Definition:</b> <a href="uds__beacon_8h_source.html#l00113">uds_beacon.h:113</a></div></div>
<div class="ttc" id="struct_network_1_1_wifi_packet_html_a2e1c47a15b934e3cbdfa404309353ede"><div class="ttname"><a href="struct_network_1_1_wifi_packet.html#a2e1c47a15b934e3cbdfa404309353ede">Network::WifiPacket::type</a></div><div class="ttdeci">PacketType type</div><div class="ttdoc">The type of 802.11 frame. </div><div class="ttdef"><b>Definition:</b> <a href="room__member_8h_source.html#l00027">room_member.h:27</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_ab12fda5a2bfd7850870f7b03fcc21e72"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#ab12fda5a2bfd7850870f7b03fcc21e72">Service::NWM::MacAddress</a></div><div class="ttdeci">std::array&lt; u8, 6 &gt; MacAddress</div><div class="ttdef"><b>Definition:</b> <a href="uds__beacon_8h_source.html#l00016">uds_beacon.h:16</a></div></div>
<div class="ttc" id="struct_service_1_1_n_w_m_1_1_network_info_html_a730aef7216b01b09a5fd7dc5b7cb6299"><div class="ttname"><a href="struct_service_1_1_n_w_m_1_1_network_info.html#a730aef7216b01b09a5fd7dc5b7cb6299">Service::NWM::NetworkInfo::oui_type</a></div><div class="ttdeci">u8 oui_type</div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8h_source.html#l00069">nwm_uds.h:69</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_a3f692bdb7cf94e669038a2f5fa9914d8"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#a3f692bdb7cf94e669038a2f5fa9914d8">Service::NWM::GetAssociationResult</a></div><div class="ttdeci">std::tuple&lt; AssocStatus, u16 &gt; GetAssociationResult(const std::vector&lt; u8 &gt; &amp;body)</div><div class="ttdoc">Returns a tuple of (association status, association id) from the body of an AssociationResponse frame...</div><div class="ttdef"><b>Definition:</b> <a href="uds__connection_8cpp_source.html#l00077">uds_connection.cpp:77</a></div></div>
<div class="ttc" id="struct_service_1_1_n_w_m_1_1_secure_data_header_html"><div class="ttname"><a href="struct_service_1_1_n_w_m_1_1_secure_data_header.html">Service::NWM::SecureDataHeader</a></div><div class="ttdef"><b>Definition:</b> <a href="uds__data_8h_source.html#l00042">uds_data.h:42</a></div></div>
<div class="ttc" id="namespace_network_html_a5ee509b747f2af4c4110f7542a6efe8b"><div class="ttname"><a href="namespace_network.html#a5ee509b747f2af4c4110f7542a6efe8b">Network::GetRoomMember</a></div><div class="ttdeci">std::weak_ptr&lt; RoomMember &gt; GetRoomMember()</div><div class="ttdoc">Returns a pointer to the room member handle. </div><div class="ttdef"><b>Definition:</b> <a href="network_8cpp_source.html#l00031">network.cpp:31</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_a61b6e3afb7217166137c50bc88745baa"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#a61b6e3afb7217166137c50bc88745baa">Service::NWM::HandleAssociationResponseFrame</a></div><div class="ttdeci">void HandleAssociationResponseFrame(const Network::WifiPacket &amp;packet)</div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8cpp_source.html#l00214">nwm_uds.cpp:214</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_afed15b5a5a4b5ad2cb3af5a3b0a08ffe"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#afed15b5a5a4b5ad2cb3af5a3b0a08ffe">Service::NWM::connection_status</a></div><div class="ttdeci">static ConnectionStatus connection_status</div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8cpp_source.html#l00048">nwm_uds.cpp:48</a></div></div>
<div class="ttc" id="ipc__helpers_8h_html"><div class="ttname"><a href="ipc__helpers_8h.html">ipc_helpers.h</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_ac3768635cdf1d1f24881988e0f0ccbfa"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#ac3768635cdf1d1f24881988e0f0ccbfa">Service::NWM::HandleSecureDataPacket</a></div><div class="ttdeci">static void HandleSecureDataPacket(const Network::WifiPacket &amp;packet)</div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8cpp_source.html#l00346">nwm_uds.cpp:346</a></div></div>
<div class="ttc" id="core_2hle_2kernel_2shared__memory_8h_html"><div class="ttname"><a href="core_2hle_2kernel_2shared__memory_8h.html">shared_memory.h</a></div></div>
<div class="ttc" id="struct_network_1_1_wifi_packet_html_a9047c2d448a65b11b302c7e9d0870d39a3bd5571b2db43ea584bf8e7438434515"><div class="ttname"><a href="struct_network_1_1_wifi_packet.html#a9047c2d448a65b11b302c7e9d0870d39a3bd5571b2db43ea584bf8e7438434515">Network::WifiPacket::PacketType::Beacon</a></div></div>
<div class="ttc" id="struct_service_1_1_n_w_m_1_1_beacon_entry_header_html_a3a1670b74608c6a009900167b2710b39"><div class="ttname"><a href="struct_service_1_1_n_w_m_1_1_beacon_entry_header.html#a3a1670b74608c6a009900167b2710b39">Service::NWM::BeaconEntryHeader::unk_size</a></div><div class="ttdeci">u32_le unk_size</div><div class="ttdef"><b>Definition:</b> <a href="uds__beacon_8h_source.html#l00037">uds_beacon.h:37</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_a5675ebfd64003c2a6e656d0be7a26c4d"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#a5675ebfd64003c2a6e656d0be7a26c4d">Service::NWM::GetAuthenticationSeqNumber</a></div><div class="ttdeci">AuthenticationSeq GetAuthenticationSeqNumber(const std::vector&lt; u8 &gt; &amp;body)</div><div class="ttdoc">Returns the sequence number from the body of an Authentication frame. </div><div class="ttdef"><b>Definition:</b> <a href="uds__connection_8cpp_source.html#l00025">uds_connection.cpp:25</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_a697fb6a6cc6b75c33896def5690fde48"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#a697fb6a6cc6b75c33896def5690fde48">Service::NWM::HandleDeauthenticationFrame</a></div><div class="ttdeci">void HandleDeauthenticationFrame(const Network::WifiPacket &amp;packet)</div><div class="ttdoc">Handles the deauthentication frames sent from clients to hosts, when they leave a session...</div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8cpp_source.html#l00481">nwm_uds.cpp:481</a></div></div>
<div class="ttc" id="common__types_8h_html_a66e1d499241ccae9a18a20a1f4f0590d"><div class="ttname"><a href="common__types_8h.html#a66e1d499241ccae9a18a20a1f4f0590d">u64</a></div><div class="ttdeci">std::uint64_t u64</div><div class="ttdoc">64-bit unsigned int </div><div class="ttdef"><b>Definition:</b> <a href="common__types_8h_source.html#l00038">common_types.h:38</a></div></div>
<div class="ttc" id="result_8h_html_a1d3c3229b2c38b6fe717b434732c5b86a35b3173cfe5dc3a49584a9b809982d1c"><div class="ttname"><a href="result_8h.html#a1d3c3229b2c38b6fe717b434732c5b86a35b3173cfe5dc3a49584a9b809982d1c">ErrorSummary::OutOfResource</a></div><div class="ttdoc">There are no more kernel resources (memory, table slots) to execute the operation. </div></div>
<div class="ttc" id="struct_service_1_1_n_w_m_1_1_connection_status_html_a0ece6d8ec29eea3c29718d747910f8d0"><div class="ttname"><a href="struct_service_1_1_n_w_m_1_1_connection_status.html#a0ece6d8ec29eea3c29718d747910f8d0">Service::NWM::ConnectionStatus::network_node_id</a></div><div class="ttdeci">u16_le network_node_id</div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8h_source.html#l00052">nwm_uds.h:52</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_a5808d36540a614705c80c502e1d8bc3a"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#a5808d36540a614705c80c502e1d8bc3a">Service::NWM::BeaconNodeInfo::username</a></div><div class="ttdeci">std::array&lt; u16_be, 10 &gt; username</div><div class="ttdef"><b>Definition:</b> <a href="uds__beacon_8h_source.html#l00112">uds_beacon.h:112</a></div></div>
<div class="ttc" id="swap_8h_html_a2e0978efc9ad053db49e5ab7c38d0e4b"><div class="ttname"><a href="swap_8h.html#a2e0978efc9ad053db49e5ab7c38d0e4b">u16_le</a></div><div class="ttdeci">u16 u16_le</div><div class="ttdef"><b>Definition:</b> <a href="swap_8h_source.html#l00609">swap.h:609</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_a09a8c3835b523982576400aaead788ee"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#a09a8c3835b523982576400aaead788ee">Service::NWM::GetReceivedBeacons</a></div><div class="ttdeci">std::list&lt; Network::WifiPacket &gt; GetReceivedBeacons(const MacAddress &amp;sender)</div><div class="ttdoc">Returns a list of received 802.11 beacon frames from the specified sender since the last call...</div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8cpp_source.html#l00113">nwm_uds.cpp:113</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_abbc964ff9ab40fe882a6dee0839cbb3c"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#abbc964ff9ab40fe882a6dee0839cbb3c">Service::NWM::BindNodeData::channel</a></div><div class="ttdeci">u8 channel</div><div class="ttdoc">Channel that this bind node was bound to. </div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8cpp_source.html#l00064">nwm_uds.cpp:64</a></div></div>
<div class="ttc" id="struct_service_1_1_n_w_m_1_1_network_info_html"><div class="ttname"><a href="struct_service_1_1_n_w_m_1_1_network_info.html">Service::NWM::NetworkInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8h_source.html#l00062">nwm_uds.h:62</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_a8da2b90dc6abdf8de054b4e8f3cb5b02"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#a8da2b90dc6abdf8de054b4e8f3cb5b02">Service::NWM::received_beacons</a></div><div class="ttdeci">static std::list&lt; Network::WifiPacket &gt; received_beacons</div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8cpp_source.html#l00105">nwm_uds.cpp:105</a></div></div>
<div class="ttc" id="class_kernel_1_1_h_l_e_request_context_html"><div class="ttname"><a href="class_kernel_1_1_h_l_e_request_context.html">Kernel::HLERequestContext</a></div><div class="ttdoc">Class containing information about an in-flight IPC request being handled by an HLE service implement...</div><div class="ttdef"><b>Definition:</b> <a href="hle__ipc_8h_source.html#l00155">hle_ipc.h:155</a></div></div>
<div class="ttc" id="struct_network_1_1_wifi_packet_html_ae6f9dbe04ee6b8039f6b43601c6cd05c"><div class="ttname"><a href="struct_network_1_1_wifi_packet.html#ae6f9dbe04ee6b8039f6b43601c6cd05c">Network::WifiPacket::channel</a></div><div class="ttdeci">u8 channel</div><div class="ttdoc">WiFi channel where this frame was transmitted. </div><div class="ttdef"><b>Definition:</b> <a href="room__member_8h_source.html#l00032">room_member.h:32</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_struct_service_1_1_n_w_m_1_1_beacon_data_reply_header"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#struct_service_1_1_n_w_m_1_1_beacon_data_reply_header">Service::NWM::BeaconDataReplyHeader</a></div><div class="ttdef"><b>Definition:</b> <a href="uds__beacon_8h_source.html#l00043">uds_beacon.h:43</a></div></div>
<div class="ttc" id="thread_8h_html_a36bd654753f9fb7e2b269831f4e6ad80"><div class="ttname"><a href="thread_8h.html#a36bd654753f9fb7e2b269831f4e6ad80">ThreadWakeupReason</a></div><div class="ttdeci">ThreadWakeupReason</div><div class="ttdef"><b>Definition:</b> <a href="thread_8h_source.html#l00047">thread.h:47</a></div></div>
<div class="ttc" id="namespace_shared_page_html_a82b8bd4b87adb7ddb47310c92f44fee6"><div class="ttname"><a href="namespace_shared_page.html#a82b8bd4b87adb7ddb47310c92f44fee6">SharedPage::DefaultMac</a></div><div class="ttdeci">constexpr MacAddress DefaultMac</div><div class="ttdef"><b>Definition:</b> <a href="shared__page_8h_source.html#l00050">shared_page.h:50</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_a77909b4bf6f29806ad6f214da381052f"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#a77909b4bf6f29806ad6f214da381052f">Service::NWM::beacon_mutex</a></div><div class="ttdeci">static std::mutex beacon_mutex</div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8cpp_source.html#l00098">nwm_uds.cpp:98</a></div></div>
<div class="ttc" id="namespace_core_timing_html_a1d0fc13b562a6c699cdcbfd4ccdfbc10"><div class="ttname"><a href="namespace_core_timing.html#a1d0fc13b562a6c699cdcbfd4ccdfbc10">CoreTiming::UnscheduleEvent</a></div><div class="ttdeci">void UnscheduleEvent(const EventType *event_type, u64 userdata)</div><div class="ttdef"><b>Definition:</b> <a href="core__timing_8cpp_source.html#l00151">core_timing.cpp:151</a></div></div>
<div class="ttc" id="struct_service_1_1_n_w_m_1_1_connection_status_html_a1316e3ca28f939ea4453649235c14a4e"><div class="ttname"><a href="struct_service_1_1_n_w_m_1_1_connection_status.html#a1316e3ca28f939ea4453649235c14a4e">Service::NWM::ConnectionStatus::max_nodes</a></div><div class="ttdeci">u8 max_nodes</div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8h_source.html#l00056">nwm_uds.h:56</a></div></div>
<div class="ttc" id="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s_html_a885b4dd51b5ea87c65381ce72f9b84d5"><div class="ttname"><a href="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s.html#a885b4dd51b5ea87c65381ce72f9b84d5">Service::NWM::NWM_UDS::Shutdown</a></div><div class="ttdeci">void Shutdown(Kernel::HLERequestContext &amp;ctx)</div><div class="ttdoc">NWM_UDS::Shutdown service function Inputs: 1 : None Outputs: 1 : Result of function, 0 on success, otherwise error code. </div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8cpp_source.html#l00545">nwm_uds.cpp:545</a></div></div>
<div class="ttc" id="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s_html_a15c222781eb74ac8117aaa7cca86db4b"><div class="ttname"><a href="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s.html#a15c222781eb74ac8117aaa7cca86db4b">Service::NWM::NWM_UDS::GetNodeInformation</a></div><div class="ttdeci">void GetNodeInformation(Kernel::HLERequestContext &amp;ctx)</div><div class="ttdoc">NWM_UDS::GetNodeInformation service function. </div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8cpp_source.html#l00690">nwm_uds.cpp:690</a></div></div>
<div class="ttc" id="network_8h_html"><div class="ttname"><a href="network_8h.html">network.h</a></div></div>
<div class="ttc" id="struct_service_1_1_n_w_m_1_1_connection_status_html_a9d333528ec44be3e2c30011490e9701d"><div class="ttname"><a href="struct_service_1_1_n_w_m_1_1_connection_status.html#a9d333528ec44be3e2c30011490e9701d">Service::NWM::ConnectionStatus::changed_nodes</a></div><div class="ttdeci">u16_le changed_nodes</div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8h_source.html#l00053">nwm_uds.h:53</a></div></div>
<div class="ttc" id="uds__beacon_8h_html"><div class="ttname"><a href="uds__beacon_8h.html">uds_beacon.h</a></div></div>
<div class="ttc" id="struct_service_1_1_n_w_m_1_1_network_info_html_a4232ae11645f866665498febd9221d7c"><div class="ttname"><a href="struct_service_1_1_n_w_m_1_1_network_info.html#a4232ae11645f866665498febd9221d7c">Service::NWM::NetworkInfo::oui_value</a></div><div class="ttdeci">std::array&lt; u8, 3 &gt; oui_value</div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8h_source.html#l00068">nwm_uds.h:68</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_1_1_err_codes_html_aeb854535fff279bb2aba92bfd22b7558a93a5e56ad80aba8e21f449e36f03c35b"><div class="ttname"><a href="namespace_service_1_1_n_w_m_1_1_err_codes.html#aeb854535fff279bb2aba92bfd22b7558a93a5e56ad80aba8e21f449e36f03c35b">Service::NWM::ErrCodes::WrongStatus</a></div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8cpp_source.html#l00036">nwm_uds.cpp:36</a></div></div>
<div class="ttc" id="result_8h_html_afe30fc4506a4cf2ee780b2319dbec74da418ec6476e1acd92e17681f4bd00e3a3"><div class="ttname"><a href="result_8h.html#afe30fc4506a4cf2ee780b2319dbec74da418ec6476e1acd92e17681f4bd00e3a3">ErrorDescription::NotAuthorized</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_a314d2573d77dfa9a69d021eb31ee2d64ae321c53b354930ba96f0243e652df458"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#a314d2573d77dfa9a69d021eb31ee2d64ae321c53b354930ba96f0243e652df458">Service::NWM::NetworkStatus::Connecting</a></div></div>
<div class="ttc" id="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s_html_ab191e3fec4ecec4fd93145df34ac9377"><div class="ttname"><a href="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s.html#ab191e3fec4ecec4fd93145df34ac9377">Service::NWM::NWM_UDS::Unbind</a></div><div class="ttdeci">void Unbind(Kernel::HLERequestContext &amp;ctx)</div><div class="ttdoc">NWM_UDS::Unbind service function. </div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8cpp_source.html#l00773">nwm_uds.cpp:773</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_ab532ab50d4ee263def66a4c4c6be5a80"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#ab532ab50d4ee263def66a4c4c6be5a80">Service::NWM::node_info</a></div><div class="ttdeci">static NodeList node_info</div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8cpp_source.html#l00057">nwm_uds.cpp:57</a></div></div>
<div class="ttc" id="struct_network_1_1_wifi_packet_html_af52e496f816ac80521b2328294c07ffa"><div class="ttname"><a href="struct_network_1_1_wifi_packet.html#af52e496f816ac80521b2328294c07ffa">Network::WifiPacket::transmitter_address</a></div><div class="ttdeci">MacAddress transmitter_address</div><div class="ttdoc">Mac address of the transmitter. </div><div class="ttdef"><b>Definition:</b> <a href="room__member_8h_source.html#l00030">room_member.h:30</a></div></div>
<div class="ttc" id="struct_network_1_1_wifi_packet_html_a9047c2d448a65b11b302c7e9d0870d39a8f968b9e03773487ba182105cd6f175d"><div class="ttname"><a href="struct_network_1_1_wifi_packet.html#a9047c2d448a65b11b302c7e9d0870d39a8f968b9e03773487ba182105cd6f175d">Network::WifiPacket::PacketType::AssociationResponse</a></div></div>
<div class="ttc" id="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s_html_a81891c30c576a8bacfa2b30a135a3e50"><div class="ttname"><a href="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s.html#a81891c30c576a8bacfa2b30a135a3e50">Service::NWM::NWM_UDS::Bind</a></div><div class="ttdeci">void Bind(Kernel::HLERequestContext &amp;ctx)</div><div class="ttdoc">NWM_UDS::Bind service function. </div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8cpp_source.html#l00722">nwm_uds.cpp:722</a></div></div>
<div class="ttc" id="struct_service_1_1_n_w_m_1_1_connection_status_html"><div class="ttname"><a href="struct_service_1_1_n_w_m_1_1_connection_status.html">Service::NWM::ConnectionStatus</a></div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8h_source.html#l00049">nwm_uds.h:49</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_a578cfa9541e1dd420a8d70b70e1b4c3f"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#a578cfa9541e1dd420a8d70b70e1b4c3f">Service::NWM::ApplicationDataSize</a></div><div class="ttdeci">const std::size_t ApplicationDataSize</div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8h_source.html#l00018">nwm_uds.h:18</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_aab843dbb97d49e6d10a14bcca9fc715c"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#aab843dbb97d49e6d10a14bcca9fc715c">Service::NWM::SendPacket</a></div><div class="ttdeci">void SendPacket(Network::WifiPacket &amp;packet)</div><div class="ttdoc">Sends a WifiPacket to the room we&amp;#39;re currently connected to. </div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8cpp_source.html#l00132">nwm_uds.cpp:132</a></div></div>
<div class="ttc" id="class_core_1_1_system_html_a4d8e4f4ed6fb89fa04908c4031d55140"><div class="ttname"><a href="class_core_1_1_system.html#a4d8e4f4ed6fb89fa04908c4031d55140">Core::System::GetSharedPageHandler</a></div><div class="ttdeci">std::shared_ptr&lt; SharedPage::Handler &gt; GetSharedPageHandler() const</div><div class="ttdef"><b>Definition:</b> <a href="core_8h_source.html#l00182">core.h:182</a></div></div>
<div class="ttc" id="core__timing_8h_html_a624c4e2c1fbcf329eb4a48687ea63a40"><div class="ttname"><a href="core__timing_8h.html#a624c4e2c1fbcf329eb4a48687ea63a40">msToCycles</a></div><div class="ttdeci">s64 msToCycles(int ms)</div><div class="ttdef"><b>Definition:</b> <a href="core__timing_8h_source.html#l00033">core_timing.h:33</a></div></div>
<div class="ttc" id="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s_html_a013a241a09271c2127fff6a4b54cf6c5"><div class="ttname"><a href="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s.html#a013a241a09271c2127fff6a4b54cf6c5">Service::NWM::NWM_UDS::~NWM_UDS</a></div><div class="ttdeci">~NWM_UDS()</div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8cpp_source.html#l01336">nwm_uds.cpp:1336</a></div></div>
<div class="ttc" id="class_service_1_1_service_framework_html_a54307718519bef2198366da0a7e69e0e"><div class="ttname"><a href="class_service_1_1_service_framework.html#a54307718519bef2198366da0a7e69e0e">Service::ServiceFramework&lt; NWM_UDS &gt;::RegisterHandlers</a></div><div class="ttdeci">void RegisterHandlers(const FunctionInfo(&amp;functions)[N])</div><div class="ttdoc">Registers handlers in the service. </div><div class="ttdef"><b>Definition:</b> <a href="service_8h_source.html#l00151">service.h:151</a></div></div>
<div class="ttc" id="namespace_kernel_html_aa2d109b9b88cb2530209ac79149e2811ac7fc2ee61fad0e2bba6754efdee31481"><div class="ttname"><a href="namespace_kernel.html#aa2d109b9b88cb2530209ac79149e2811ac7fc2ee61fad0e2bba6754efdee31481">Kernel::ResetType::OneShot</a></div></div>
<div class="ttc" id="core__timing_8h_html"><div class="ttname"><a href="core__timing_8h.html">core_timing.h</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_a314d2573d77dfa9a69d021eb31ee2d64a4075072d219e061ca0f3124f8fbef463"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#a314d2573d77dfa9a69d021eb31ee2d64a4075072d219e061ca0f3124f8fbef463">Service::NWM::NetworkStatus::NotConnected</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_aca480a7a2d96c7082b50ca01fbe0a00b"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#aca480a7a2d96c7082b50ca01fbe0a00b">Service::NWM::HandleDataFrame</a></div><div class="ttdeci">static void HandleDataFrame(const Network::WifiPacket &amp;packet)</div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8cpp_source.html#l00510">nwm_uds.cpp:510</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_struct_service_1_1_n_w_m_1_1_bind_node_data"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#struct_service_1_1_n_w_m_1_1_bind_node_data">Service::NWM::BindNodeData</a></div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8cpp_source.html#l00062">nwm_uds.cpp:62</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_1_1_err_codes_html_aeb854535fff279bb2aba92bfd22b7558aa93f73db48d3440a8257d905cc9fa62e"><div class="ttname"><a href="namespace_service_1_1_n_w_m_1_1_err_codes.html#aeb854535fff279bb2aba92bfd22b7558aa93f73db48d3440a8257d905cc9fa62e">Service::NWM::ErrCodes::NotInitialized</a></div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8cpp_source.html#l00035">nwm_uds.cpp:35</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_a15b266f19f1e4ea059e7466e583bc199"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#a15b266f19f1e4ea059e7466e583bc199">Service::NWM::HandleNodeMapPacket</a></div><div class="ttdeci">static void HandleNodeMapPacket(const Network::WifiPacket &amp;packet)</div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8cpp_source.html#l00177">nwm_uds.cpp:177</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_aa984a695334088d118dadc59061cd6c8"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#aa984a695334088d118dadc59061cd6c8">Service::NWM::SendAssociationResponseFrame</a></div><div class="ttdeci">void SendAssociationResponseFrame(const MacAddress &amp;address)</div><div class="ttdoc">Sends an Association Response frame to the specified mac address. </div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8cpp_source.html#l00423">nwm_uds.cpp:423</a></div></div>
<div class="ttc" id="common__types_8h_html_a65cf28726f89e62ccf2f1354bc2716df"><div class="ttname"><a href="common__types_8h.html#a65cf28726f89e62ccf2f1354bc2716df">u32</a></div><div class="ttdeci">std::uint32_t u32</div><div class="ttdoc">32-bit unsigned word </div><div class="ttdef"><b>Definition:</b> <a href="common__types_8h_source.html#l00037">common_types.h:37</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_aaa6d7f52f0368d386dd80541527062af"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#aaa6d7f52f0368d386dd80541527062af">Service::NWM::UDSMaxNodes</a></div><div class="ttdeci">constexpr u32 UDSMaxNodes</div><div class="ttdoc">The maximum number of nodes that can exist in an UDS session. </div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8h_source.html#l00027">nwm_uds.h:27</a></div></div>
<div class="ttc" id="result_8h_html_a67158ef38e1ab9113151768007433e3aadb568ddcb8d3308155f19bdbadf655ca"><div class="ttname"><a href="result_8h.html#a67158ef38e1ab9113151768007433e3aadb568ddcb8d3308155f19bdbadf655ca">ErrorModule::UDS</a></div></div>
<div class="ttc" id="result_8h_html_aa3b9056eb03ec4e7c3561192eb830739ac64518704ce0c0d5501a45763f464276"><div class="ttname"><a href="result_8h.html#aa3b9056eb03ec4e7c3561192eb830739ac64518704ce0c0d5501a45763f464276">ErrorLevel::Usage</a></div></div>
<div class="ttc" id="struct_service_1_1_n_w_m_1_1_secure_data_header_html_a9239edf5337dde8e3399ebfdbeb0d703"><div class="ttname"><a href="struct_service_1_1_n_w_m_1_1_secure_data_header.html#a9239edf5337dde8e3399ebfdbeb0d703">Service::NWM::SecureDataHeader::GetActualDataSize</a></div><div class="ttdeci">u32 GetActualDataSize() const</div><div class="ttdef"><b>Definition:</b> <a href="uds__data_8h_source.html#l00054">uds_data.h:54</a></div></div>
<div class="ttc" id="common__types_8h_html_a917e58b0692c2df778a27350534cbfe7"><div class="ttname"><a href="common__types_8h.html#a917e58b0692c2df778a27350534cbfe7">u16</a></div><div class="ttdeci">std::uint16_t u16</div><div class="ttdoc">16-bit unsigned short </div><div class="ttdef"><b>Definition:</b> <a href="common__types_8h_source.html#l00036">common_types.h:36</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_a314d2573d77dfa9a69d021eb31ee2d64ac10c2f98fd4e55ef8dc130ebe5347121"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#a314d2573d77dfa9a69d021eb31ee2d64ac10c2f98fd4e55ef8dc130ebe5347121">Service::NWM::NetworkStatus::ConnectedAsClient</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_a774871a74b2577582842ad16e4abec64"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#a774871a74b2577582842ad16e4abec64">Service::NWM::initialized</a></div><div class="ttdeci">static std::atomic&lt; bool &gt; initialized(false)</div></div>
<div class="ttc" id="struct_service_1_1_n_w_m_1_1_connection_status_html_a06757367dc9053bdb0f13218ddfdc90c"><div class="ttname"><a href="struct_service_1_1_n_w_m_1_1_connection_status.html#a06757367dc9053bdb0f13218ddfdc90c">Service::NWM::ConnectionStatus::status</a></div><div class="ttdeci">u32_le status</div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8h_source.html#l00050">nwm_uds.h:50</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_a3437e6ebfdbfacfa5adbb65883e3f1f5"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#a3437e6ebfdbfacfa5adbb65883e3f1f5">Service::NWM::BindNodeData::network_node_id</a></div><div class="ttdeci">u16 network_node_id</div><div class="ttdoc">Node id this bind node is associated with, only packets from this network node will be received...</div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8cpp_source.html#l00065">nwm_uds.cpp:65</a></div></div>
<div class="ttc" id="uds__data_8h_html"><div class="ttname"><a href="uds__data_8h.html">uds_data.h</a></div></div>
<div class="ttc" id="struct_service_1_1_n_w_m_1_1_beacon_entry_header_html"><div class="ttname"><a href="struct_service_1_1_n_w_m_1_1_beacon_entry_header.html">Service::NWM::BeaconEntryHeader</a></div><div class="ttdef"><b>Definition:</b> <a href="uds__beacon_8h_source.html#l00030">uds_beacon.h:30</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_a01b19f16dd3935f6f5046784fba16480"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#a01b19f16dd3935f6f5046784fba16480">Service::NWM::beacon_broadcast_event</a></div><div class="ttdeci">static CoreTiming::EventType * beacon_broadcast_event</div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8cpp_source.html#l00085">nwm_uds.cpp:85</a></div></div>
<div class="ttc" id="struct_network_1_1_wifi_packet_html_a2e7fb70d17f8a7c96af404744cfc555d"><div class="ttname"><a href="struct_network_1_1_wifi_packet.html#a2e7fb70d17f8a7c96af404744cfc555d">Network::WifiPacket::destination_address</a></div><div class="ttdeci">MacAddress destination_address</div><div class="ttdoc">Mac address of the receiver. </div><div class="ttdef"><b>Definition:</b> <a href="room__member_8h_source.html#l00031">room_member.h:31</a></div></div>
<div class="ttc" id="result_8h_html_afe30fc4506a4cf2ee780b2319dbec74da9646ad3a1c3e708b4fa8b4b4270fbab6"><div class="ttname"><a href="result_8h.html#afe30fc4506a4cf2ee780b2319dbec74da9646ad3a1c3e708b4fa8b4b4270fbab6">ErrorDescription::NotInitialized</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_ad9a1f7b95f409b171cbc15e066bbaf2c"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#ad9a1f7b95f409b171cbc15e066bbaf2c">Service::NWM::GetEAPoLFrameType</a></div><div class="ttdeci">u16 GetEAPoLFrameType(const std::vector&lt; u8 &gt; &amp;frame)</div><div class="ttdef"><b>Definition:</b> <a href="uds__data_8cpp_source.html#l00320">uds_data.cpp:320</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_a26061cab82222e36674d12abb22246f9"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#a26061cab82222e36674d12abb22246f9">Service::NWM::StartConnectionSequence</a></div><div class="ttdeci">void StartConnectionSequence(const MacAddress &amp;server)</div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8cpp_source.html#l00403">nwm_uds.cpp:403</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_a0f9e6fec76e341b4f6e48082b719a4a0"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#a0f9e6fec76e341b4f6e48082b719a4a0">Service::NWM::BeaconNodeInfo::friend_code_seed</a></div><div class="ttdeci">u64_be friend_code_seed</div><div class="ttdef"><b>Definition:</b> <a href="uds__beacon_8h_source.html#l00111">uds_beacon.h:111</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_a314d2573d77dfa9a69d021eb31ee2d64a1bacb914b9ecea50415b08ba2d438cc6"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#a314d2573d77dfa9a69d021eb31ee2d64a1bacb914b9ecea50415b08ba2d438cc6">Service::NWM::NetworkStatus::ConnectedAsHost</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_ad01424498f61b365371c41e7f3419829"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#ad01424498f61b365371c41e7f3419829">Service::NWM::GenerateBeaconFrame</a></div><div class="ttdeci">std::vector&lt; u8 &gt; GenerateBeaconFrame(const NetworkInfo &amp;network_info, const NodeList &amp;nodes)</div><div class="ttdoc">Generates an 802.11 beacon frame starting at the management frame header. </div><div class="ttdef"><b>Definition:</b> <a href="uds__beacon_8cpp_source.html#l00312">uds_beacon.cpp:312</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_aaacd42de61b1338198e6097d11860547a9ba877d313bd415330d52f32ab2dc2c2"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#aaacd42de61b1338198e6097d11860547a9ba877d313bd415330d52f32ab2dc2c2">Service::NWM::EtherType::SecureData</a></div></div>
<div class="ttc" id="namespace_kernel_html_a468effefd7385726635010b18e69a625"><div class="ttname"><a href="namespace_kernel.html#a468effefd7385726635010b18e69a625">Kernel::GetCurrentThread</a></div><div class="ttdeci">Thread * GetCurrentThread()</div><div class="ttdoc">Gets the current thread. </div><div class="ttdef"><b>Definition:</b> <a href="thread_8cpp_source.html#l00066">thread.cpp:66</a></div></div>
<div class="ttc" id="result_8h_html_aa3b9056eb03ec4e7c3561192eb830739aec53a8c4f07baed5d8825072c89799be"><div class="ttname"><a href="result_8h.html#aa3b9056eb03ec4e7c3561192eb830739aec53a8c4f07baed5d8825072c89799be">ErrorLevel::Status</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_a2e7ef1e7be59821c8fcabb4b60606d2b"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#a2e7ef1e7be59821c8fcabb4b60606d2b">Service::NWM::recv_buffer_memory</a></div><div class="ttdeci">static Kernel::SharedPtr&lt; Kernel::SharedMemory &gt; recv_buffer_memory</div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8cpp_source.html#l00045">nwm_uds.cpp:45</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html">Service::NWM</a></div><div class="ttdef"><b>Definition:</b> <a href="nwm_2nwm_8cpp_source.html#l00014">nwm.cpp:14</a></div></div>
<div class="ttc" id="struct_service_1_1_n_w_m_1_1_connection_status_html_abb6fb689a303df1553ff4a76e0028888"><div class="ttname"><a href="struct_service_1_1_n_w_m_1_1_connection_status.html#abb6fb689a303df1553ff4a76e0028888">Service::NWM::ConnectionStatus::total_nodes</a></div><div class="ttdeci">u8 total_nodes</div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8h_source.html#l00055">nwm_uds.h:55</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_a91fbeaa6b7edaf5eff2a57306b86571e"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#a91fbeaa6b7edaf5eff2a57306b86571e">Service::NWM::BroadcastNodeMap</a></div><div class="ttdeci">static void BroadcastNodeMap()</div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8cpp_source.html#l00155">nwm_uds.cpp:155</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_a4141d30a643a47a800519c0087b18e08"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#a4141d30a643a47a800519c0087b18e08">Service::NWM::GenerateAssocResponseFrame</a></div><div class="ttdeci">std::vector&lt; u8 &gt; GenerateAssocResponseFrame(AssocStatus status, u16 association_id, u32 network_id)</div><div class="ttdoc">Generates an 802.11 association response frame with the specified status, association id and network ...</div><div class="ttdef"><b>Definition:</b> <a href="uds__connection_8cpp_source.html#l00057">uds_connection.cpp:57</a></div></div>
<div class="ttc" id="struct_service_1_1_n_w_m_1_1_connection_status_html_a2db87e8db746a74c27e1785c58e40cb0"><div class="ttname"><a href="struct_service_1_1_n_w_m_1_1_connection_status.html#a2db87e8db746a74c27e1785c58e40cb0">Service::NWM::ConnectionStatus::node_bitmask</a></div><div class="ttdeci">u16_le node_bitmask</div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8h_source.html#l00057">nwm_uds.h:57</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_a4f4c0df5e69105de353121769e93ce69"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#a4f4c0df5e69105de353121769e93ce69">Service::NWM::current_node</a></div><div class="ttdeci">static NodeInfo current_node</div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8cpp_source.html#l00060">nwm_uds.cpp:60</a></div></div>
<div class="ttc" id="struct_service_1_1_n_w_m_1_1_node_info_html_ac7f54bcf8a458b5f297d00715fdb99be"><div class="ttname"><a href="struct_service_1_1_n_w_m_1_1_node_info.html#ac7f54bcf8a458b5f297d00715fdb99be">Service::NWM::NodeInfo::network_node_id</a></div><div class="ttdeci">u16_le network_node_id</div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8h_source.html#l00033">nwm_uds.h:33</a></div></div>
<div class="ttc" id="union_result_code_html"><div class="ttname"><a href="union_result_code.html">ResultCode</a></div><div class="ttdoc">Encapsulates a CTR-OS error code, allowing it to be separated into its constituent fields...</div><div class="ttdef"><b>Definition:</b> <a href="result_8h_source.html#l00195">result.h:195</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_aaff74c7747aa4eeeda54466f8407ef02"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#aaff74c7747aa4eeeda54466f8407ef02">Service::NWM::GenerateAuthenticationFrame</a></div><div class="ttdeci">std::vector&lt; u8 &gt; GenerateAuthenticationFrame(AuthenticationSeq seq)</div><div class="ttdoc">Generates an 802.11 authentication frame, starting at the frame body. </div><div class="ttdef"><b>Definition:</b> <a href="uds__connection_8cpp_source.html#l00015">uds_connection.cpp:15</a></div></div>
<div class="ttc" id="struct_service_1_1_n_w_m_1_1_network_info_html_a1c1a79becdfc2ef4954e2de85ca2c976"><div class="ttname"><a href="struct_service_1_1_n_w_m_1_1_network_info.html#a1c1a79becdfc2ef4954e2de85ca2c976">Service::NWM::NetworkInfo::network_id</a></div><div class="ttdeci">u32_be network_id</div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8h_source.html#l00075">nwm_uds.h:75</a></div></div>
<div class="ttc" id="class_i_p_c_1_1_response_builder_html"><div class="ttname"><a href="class_i_p_c_1_1_response_builder.html">IPC::ResponseBuilder</a></div><div class="ttdef"><b>Definition:</b> <a href="ipc__helpers_8h_source.html#l00046">ipc_helpers.h:46</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_a6eb4e95da394c037a2110a2c8f4a755e"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#a6eb4e95da394c037a2110a2c8f4a755e">Service::NWM::NodeList</a></div><div class="ttdeci">std::vector&lt; NodeInfo &gt; NodeList</div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8h_source.html#l00039">nwm_uds.h:39</a></div></div>
<div class="ttc" id="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s_html_a1928d3ad8055f0b36954372268f86d55"><div class="ttname"><a href="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s.html#a1928d3ad8055f0b36954372268f86d55">Service::NWM::NWM_UDS::DestroyNetwork</a></div><div class="ttdeci">void DestroyNetwork(Kernel::HLERequestContext &amp;ctx)</div><div class="ttdoc">NWM_UDS::DestroyNetwork service function. </div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8cpp_source.html#l00885">nwm_uds.cpp:885</a></div></div>
<div class="ttc" id="class_core_1_1_system_html_ab2f9ff357787ec877567d8c4ffe2a2d4"><div class="ttname"><a href="class_core_1_1_system.html#ab2f9ff357787ec877567d8c4ffe2a2d4">Core::System::GetInstance</a></div><div class="ttdeci">static System &amp; GetInstance()</div><div class="ttdoc">Gets the instance of the System singleton class. </div><div class="ttdef"><b>Definition:</b> <a href="core_8h_source.html#l00049">core.h:49</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_a75f357ce8b314d69414357620a3526e8"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#a75f357ce8b314d69414357620a3526e8">Service::NWM::DecryptBeacon</a></div><div class="ttdeci">void DecryptBeacon(const NetworkInfo &amp;network_info, std::vector&lt; u8 &gt; &amp;buffer)</div><div class="ttdoc">Decrypts the beacon data buffer for the network described by network_info. </div><div class="ttdef"><b>Definition:</b> <a href="uds__beacon_8cpp_source.html#l00223">uds_beacon.cpp:223</a></div></div>
<div class="ttc" id="assert_8h_html_a9f920d5e0c0e8780d4ce9bfb15bfd9e2"><div class="ttname"><a href="assert_8h.html#a9f920d5e0c0e8780d4ce9bfb15bfd9e2">ASSERT</a></div><div class="ttdeci">#define ASSERT(_a_)</div><div class="ttdef"><b>Definition:</b> <a href="assert_8h_source.html#l00030">assert.h:30</a></div></div>
<div class="ttc" id="result_8h_html_a1d3c3229b2c38b6fe717b434732c5b86a5a738160747f39c20e9f65416931c974"><div class="ttname"><a href="result_8h.html#a1d3c3229b2c38b6fe717b434732c5b86a5a738160747f39c20e9f65416931c974">ErrorSummary::WrongArgument</a></div><div class="ttdoc">Returned when a passed argument is in an incorrect format for use with the function. (E.g. Invalid enum value) </div></div>
<div class="ttc" id="log_8h_html"><div class="ttname"><a href="log_8h.html">log.h</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_a60d846206c420364f50d25c937e939a8"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#a60d846206c420364f50d25c937e939a8">Service::NWM::MillisecondsPerTU</a></div><div class="ttdeci">const double MillisecondsPerTU</div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8h_source.html#l00022">nwm_uds.h:22</a></div></div>
<div class="ttc" id="namespace_h_l_e_html_acbdcc3b0ea2929dbf52e25ced9529d39"><div class="ttname"><a href="namespace_h_l_e.html#acbdcc3b0ea2929dbf52e25ced9529d39">HLE::g_hle_lock</a></div><div class="ttdeci">std::recursive_mutex g_hle_lock</div><div class="ttdef"><b>Definition:</b> <a href="lock_8cpp_source.html#l00008">lock.cpp:8</a></div></div>
<div class="ttc" id="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s_html_a9f7afa7765a7161f808d14c36b9d1182"><div class="ttname"><a href="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s.html#a9f7afa7765a7161f808d14c36b9d1182">Service::NWM::NWM_UDS::RecvBeaconBroadcastData</a></div><div class="ttdeci">void RecvBeaconBroadcastData(Kernel::HLERequestContext &amp;ctx)</div><div class="ttdoc">NWM_UDS::RecvBeaconBroadcastData service function Returns the raw beacon data for nearby networks tha...</div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8cpp_source.html#l00565">nwm_uds.cpp:565</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_ae989e39572d21634928c5b6c9ac2cf14a0e80f787a0a1950233a1da8545088973"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#ae989e39572d21634928c5b6c9ac2cf14a0e80f787a0a1950233a1da8545088973">Service::NWM::NintendoTagId::EncryptedData0</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_a57047a561e887cde9847b73b142a4dc6"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#a57047a561e887cde9847b73b142a4dc6">Service::NWM::MaxBeaconFrames</a></div><div class="ttdeci">constexpr std::size_t MaxBeaconFrames</div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8cpp_source.html#l00102">nwm_uds.cpp:102</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_a85aa62edb6a5318814d964da561bf776"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#a85aa62edb6a5318814d964da561bf776">Service::NWM::ParseEAPoLLogoffFrame</a></div><div class="ttdeci">EAPoLLogoffPacket ParseEAPoLLogoffFrame(const std::vector&lt; u8 &gt; &amp;frame)</div><div class="ttdef"><b>Definition:</b> <a href="uds__data_8cpp_source.html#l00377">uds_data.cpp:377</a></div></div>
<div class="ttc" id="struct_service_1_1_n_w_m_1_1_network_info_html_a6c01dc193bef30171f2f75808715d8fb"><div class="ttname"><a href="struct_service_1_1_n_w_m_1_1_network_info.html#a6c01dc193bef30171f2f75808715d8fb">Service::NWM::NetworkInfo::application_data</a></div><div class="ttdeci">std::array&lt; u8, ApplicationDataSize &gt; application_data</div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8h_source.html#l00081">nwm_uds.h:81</a></div></div>
<div class="ttc" id="namespace_network_html_ad53970187104c70b9d5bd6506427c48b"><div class="ttname"><a href="namespace_network.html#ad53970187104c70b9d5bd6506427c48b">Network::MacAddress</a></div><div class="ttdeci">std::array&lt; u8, 6 &gt; MacAddress</div><div class="ttdef"><b>Definition:</b> <a href="room_8h_source.html#l00019">room.h:19</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_ae989e39572d21634928c5b6c9ac2cf14a0b4ba01efcb15b2ff201068d04643fd5"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#ae989e39572d21634928c5b6c9ac2cf14a0b4ba01efcb15b2ff201068d04643fd5">Service::NWM::NintendoTagId::NetworkInfo</a></div></div>
<div class="ttc" id="result_8h_html_afe30fc4506a4cf2ee780b2319dbec74da38c300f4fc9ce8a77aad4a30de05cad8"><div class="ttname"><a href="result_8h.html#afe30fc4506a4cf2ee780b2319dbec74da38c300f4fc9ce8a77aad4a30de05cad8">ErrorDescription::NotFound</a></div></div>
<div class="ttc" id="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s_html_a17b84a4b1ecd13ac90f0fe55214de52b"><div class="ttname"><a href="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s.html#a17b84a4b1ecd13ac90f0fe55214de52b">Service::NWM::NWM_UDS::SetApplicationData</a></div><div class="ttdeci">void SetApplicationData(Kernel::HLERequestContext &amp;ctx)</div><div class="ttdoc">NWM_UDS::SetApplicationData service function. </div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8cpp_source.html#l01172">nwm_uds.cpp:1172</a></div></div>
<div class="ttc" id="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s_html_a4858cc14324340c8869896653f8278fc"><div class="ttname"><a href="class_service_1_1_n_w_m_1_1_n_w_m___u_d_s.html#a4858cc14324340c8869896653f8278fc">Service::NWM::NWM_UDS::InitializeWithVersion</a></div><div class="ttdeci">void InitializeWithVersion(Kernel::HLERequestContext &amp;ctx)</div><div class="ttdoc">NWM_UDS::Initialize service function Inputs: 1 : Shared memory size 2-11 : Input NodeInfo Structure 1...</div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8cpp_source.html#l00630">nwm_uds.cpp:630</a></div></div>
<div class="ttc" id="struct_network_1_1_wifi_packet_html_a48b867db11d2bbd7315e2855c13ab1bf"><div class="ttname"><a href="struct_network_1_1_wifi_packet.html#a48b867db11d2bbd7315e2855c13ab1bf">Network::WifiPacket::data</a></div><div class="ttdeci">std::vector&lt; u8 &gt; data</div><div class="ttdoc">Raw 802.11 frame data, starting at the management frame header for management frames. </div><div class="ttdef"><b>Definition:</b> <a href="room__member_8h_source.html#l00028">room_member.h:28</a></div></div>
<div class="ttc" id="struct_service_1_1_n_w_m_1_1_node_info_html_a5c756567e2edbd225e405a96c2d47804"><div class="ttname"><a href="struct_service_1_1_n_w_m_1_1_node_info.html#a5c756567e2edbd225e405a96c2d47804">Service::NWM::NodeInfo::friend_code_seed</a></div><div class="ttdeci">u64_le friend_code_seed</div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8h_source.html#l00030">nwm_uds.h:30</a></div></div>
<div class="ttc" id="namespace_service_1_1_n_w_m_html_a685f6f9337a209488e57af85c6dd2d85a30ae8fff8898dc197acd49d9c0797d20"><div class="ttname"><a href="namespace_service_1_1_n_w_m.html#a685f6f9337a209488e57af85c6dd2d85a30ae8fff8898dc197acd49d9c0797d20">Service::NWM::AuthStatus::Successful</a></div></div>
<div class="ttc" id="struct_service_1_1_n_w_m_1_1_node_info_html"><div class="ttname"><a href="struct_service_1_1_n_w_m_1_1_node_info.html">Service::NWM::NodeInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="nwm__uds_8h_source.html#l00029">nwm_uds.h:29</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_aebb8dcc11953d78e620bbef0b9e2183.html">core</a></li><li class="navelem"><a class="el" href="dir_ad0974a1dfe0794d9a8a3cb5a67eca54.html">hle</a></li><li class="navelem"><a class="el" href="dir_d6865e650edf42fac86a46d438d89922.html">service</a></li><li class="navelem"><a class="el" href="dir_f7d2d093b7e02e85801408a0147670b4.html">nwm</a></li><li class="navelem"><a class="el" href="nwm__uds_8cpp.html">nwm_uds.cpp</a></li>
    <li class="footer">Generated on Thu Sep 13 2018 12:49:44 for Citra by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
